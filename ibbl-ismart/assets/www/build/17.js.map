{"version":3,"sources":["../../src/pages/user-login03/user-login03.module.ts","../../src/pages/user-login03/user-login03.ts"],"names":[],"mappings":"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","file":"17.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { UserLogin03Page } from './user-login03';\n\n@NgModule({\n  declarations: [\n    UserLogin03Page,\n  ],\n  imports: [\n    IonicPageModule.forChild(UserLogin03Page),\n  ],\n\n  entryComponents: [\n    UserLogin03Page]\n})\nexport class UserLogin03PageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/user-login03/user-login03.module.ts","import {Component} from '@angular/core';\nimport {AlertController, IonicPage, NavController, NavParams} from 'ionic-angular';\nimport {CryptoParamUtilProvider} from \"../../providers/crypto-param-util/crypto-param-util\";\nimport {LocalStorageProvider} from \"../../providers/local-storage/local-storage\";\nimport {MaskTokenProvider} from \"../../providers/mask-token/mask-token\";\nimport {AuthServiceProvider} from \"../../providers/auth-service/auth-service\";\nimport {TokenServiceProvider} from \"../../providers/token-service/token-service\";\nimport {MenuServiceProvider} from \"../../providers/menu-service/menu-service\";\nimport {ErrorMessageProvider} from \"../../providers/error-message/error-message\";\nimport {ConfigProvider} from \"../../providers/config/config\";\n\n\n\n@IonicPage()\n@Component({\n  selector: 'page-user-login03',\n  templateUrl: 'user-login03.html',\n})\nexport class UserLogin03Page {\n\n  loginError03;\n  deviceAutoGenID;\n  userID;\n  param;\n  activationCode;\n  account: { actCode: string } = {actCode: ''};\n  version;\n\n  constructor(public navCtrl: NavController,\n              public navParams: NavParams,\n              public storage: LocalStorageProvider,\n              public maskTokenUtil: MaskTokenProvider,\n              public authService: AuthServiceProvider,\n              public tokenService: TokenServiceProvider,\n              public menuService: MenuServiceProvider,\n              public messageProvider: ErrorMessageProvider,\n              public alertCtrl: AlertController,\n              public config: ConfigProvider,\n              public cryptoUtil: CryptoParamUtilProvider) {\n\n\n    this.param = navParams.get('param');\n    this.version=this.config.iSmartVersion;\n    this.userID = this.param.userId;\n    this.account.actCode = \"\";\n    let deviceID = this.param.appId;\n    deviceID = this.cryptoUtil.getDecryptVal(deviceID);\n    let len = deviceID.length;\n    this.deviceAutoGenID = deviceID.substring(0, 5) + \" ******* \" + deviceID.substring(len - 5, len);\n  }\n\n  goToMainMenuAction = function () {\n\n    this.activationCode = this.account.actCode;\n    //CALL REFRESH TOKEN SERVICE HERE\n\n    let appData = this.storage.retrieveFromStorage(\"appData\");\n    let unMaskRefToken = this.maskTokenUtil.getUnMaskVal(appData.refreshToken);\n    this.tokenService.getNewToken(unMaskRefToken)\n      .then(data => {\n        this.onNewTokenGenComplete(data);\n      });\n\n  };\n\n  onNewTokenGenComplete = function (data) {\n\n    if (data.status == 0) {\n      this.navCtrl.setRoot('ExpirePage');\n    }\n\n    else {\n      let appData = this.storage.retrieveFromStorage(\"appData\");\n      let encActCode = this.cryptoUtil.getEncryptVal(this.activationCode);\n      let unMaskToken = this.maskTokenUtil.getUnMaskVal(appData.token);\n      this.authService.validateActivation(appData.userId, appData.appId, unMaskToken, encActCode)\n        .then(data => {\n          this.onActValidateComplete(data);\n        });\n    }\n  };\n\n  onActValidateComplete = function (data) {\n\n    //IF OTP VALIDATION IS SUCCESSFUL\n\n    if (data.enrollStatus == 1) {\n      let dbVal = this.storage.retrieveFromStorage(\"appData\");\n      dbVal.status = 800;\n\n      let appVersion = this.config.iSmartVersion;\n      this.storage.insertIntoStorage('appData', dbVal);\n      let unMaskingToken = this.maskTokenUtil.getUnMaskVal(dbVal.token);\n      let encAppVersion = this.cryptoUtil.getEncryptVal(appVersion);\n\n      this.menuService.generateMenu(dbVal.userId, dbVal.appId, unMaskingToken, encAppVersion)\n        .then(data => {\n          this.onMenuGenComplete(data);\n        });\n    }\n\n    else if (data.enrollStatus == 0) {\n      this.loginError03 = data.note;\n      this.account = {actCode: \"\"};\n    }\n\n    else {\n      this.loginError03 = \"Something went wrong. Please try again Later.\";\n      this.account = {actCode: \"\"};\n\n    }\n  };\n\n  onMenuGenComplete = function (data) {\n\n    //IF MENU GENERATION IS SUCCESSFUL\n    if (data.loginStatus == 1 || data.loginStatus == 2) {\n      let menus = data.privMenus;\n      // console.log(data);\n      let accounts = data.accounts;\n      let operators = data.rechargeOperators;\n      let welcomeVal = {\n        fName: data.fName,\n        lName: data.lName,\n        welcomeText: data.welcomeText,\n        transactional: data.transactional,\n        currentAppVersion: data.currentAppVersion\n      };\n\n      let encWelcomeVal = this.cryptoUtil.getEncryptVal(JSON.stringify(welcomeVal));\n      this.storage.insertIntoStorage('welcomeVal', encWelcomeVal);\n\n      let encMenu = this.cryptoUtil.getEncryptVal(JSON.stringify(menus));\n      let encAllAccounts = this.cryptoUtil.getEncryptVal(JSON.stringify(accounts));\n\n      this.storage.insertIntoStorage('privMenus', encMenu);\n      this.storage.insertIntoStorage('accounts', encAllAccounts);\n      this.storage.insertIntoStorage('passPolicy', data.passPolicyText);\n      this.storage.insertIntoStorage('rechargeOperator', operators);\n\n      this.navCtrl.setRoot('WelcomePage', {});\n\n    }\n\n    else if (data.loginStatus == 0) {\n      this.loginError03 = \"UserID or Password or Device info or all are incorrect.\";\n      this.account = {actCode: \"\"};\n\n    }\n\n    else {\n      this.loginError03 = this.messageProvider.getErrorMessage(data.status);\n      this.account = {actCode: \"\"};\n    }\n  };\n\n  ///////////////////Function for resending email/////////////////////////////\n  resendMail = function () {\n    this.loginError03 = \"\";\n    let appData = this.storage.retrieveFromStorage(\"appData\");\n    // alert(appData);\n    let unMaskRefToken = this.maskTokenUtil.getUnMaskVal(appData.refreshToken);\n    // alert(unMaskRefToken);\n    this.tokenService.getNewToken(unMaskRefToken)\n      .then(data => {\n        this.onNewTokenGenCompleteForEmail(data);\n      });\n  };\n\n  onNewTokenGenCompleteForEmail = function (data) {\n\n    if (data.status == 0) {\n      this.navCtrl.setRoot('ExpirePage');\n    }\n    else {\n      let appData = this.storage.retrieveFromStorage(\"appData\");\n      let unMaskToken = this.maskTokenUtil.getUnMaskVal(appData.token);\n      this.authService.resendEmail(appData.userId, appData.appId, unMaskToken)\n        .then(data => {\n          this.onResendEmailComplete(data);\n        });\n    }\n  };\n\n  onResendEmailComplete = function (data) {\n\n    if (data.enrollStatus == 1) {\n      let alert = this.alertCtrl.create({\n        title: 'Device Activation',\n        message: '<center> Please Check your Email Address for Activation Code.</center>',\n        buttons: ['Ok'],\n        cssClass: \"alertLogCss\"\n      });\n      alert.present();\n      setTimeout(() => {\n        alert.dismiss();\n      }, 10000);\n    }\n\n    else if (data.enrollStatus == 0) {\n      this.loginError03 = data.note;\n      this.account = {actCode: \"\"};\n    }\n\n    else {\n      this.loginError03 = this.messageProvider.getErrorMessage(data.status);\n      this.account = {actCode: \"\"};\n    }\n  };\n\n\n  ionViewDidLoad() {\n    // console.log('ionViewDidLoad UserLogin03Page');\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/user-login03/user-login03.ts"],"sourceRoot":""}
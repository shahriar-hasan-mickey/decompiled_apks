define(["jquery","underscore","Backbone","collections/sadad/duebillPayCollections","text!views/sadad/billpayInquiry.tpl","text!views/sadad/sadadList.tpl","models/validation/sadad/sadadValidationModel","text!views/common/queuemode.tpl"],function(e,i,t,n,a,o,r,s){var l=new EncryptedLocalStorage("secret"),d=t.View.extend({el:"#container",e1:"#menuwrapper",e2:"#mobcontent",events:{"click #pay":"pay","click #back":"back","click #numkeyPad input":"openNumPad"},initialize:function(){},openNumPad:function(i){id=i.target.id;var t=/iPad|iPhone|iPod/.test(navigator.userAgent),n=l.get("isKeyPadNeed");if(t&&n){var a=e("#"+id).val();navigator.notification.keypadOpen(a,9,function(i){e("#"+id).val(convertNumbers2English(i))},function(e){})}},update:function(){l.set("currentPage","");var i=this,t=(getDeviceId(),l.get("access_token"));showSpinner();var a=function(e){i.billpayInquiry()},o=function(e){i.errorresponse()};i.collection=new n,i.collection.fetch({data:e.param({access_token:t}),dataType:"json",type:"POST",timeout:parseInt(l.get("sadadcalltimeout")),cache:!1,success:function(e){"0000"==ackStatus?a(e):o(e)},error:o})},billpayInquiry:function(){hideSpinner(),this.$("#mobcontent").html(i.template(a)).i18n()},back:function(){hideSpinner(),this.$("#mobcontent").html(i.template(o)).i18n()},pay:function(){e("#chkboxid").hide(),e("#selectdenomi_id").hide(),e("#amountvalidation").hide();var i=e("#hidamtdue").val();l.set("totamtdue",i),e("#inputdenomi_id").hide(),e("#billlimitamt").hide(),e("#billmorelimitamt").hide();var n=(l.get("dbFlag"),e("input[name=duedate]").is(":checked"));if(0==n)return e("#chkboxid").show(),!1;var a=[];e(":radio:checked").each(function(i){a[i]=e(this).val()});for(var o="false",r=!1,s={},d=0,c=0;c<a.length;c++){var u=a[c],m=u.split("~"),p=new Array,h=0;e.each(m,function(e,i){p[h]=i,h++}),""==p[3]&&(p[3]="-"),"undefined"==typeof p[3]&&(p[3]="-"),null==p[3]&&(p[3]="-"),l.set("BillerName",p[4]),l.set("BillerType",p[9]),l.set("Billeruniquid",p[7]),l.set("Billerservicesref",p[8]);var v,f=e("#billamountent"+p[2]).val(),y=e("#denominationCurr"+p[2]+" option:selected").val();if(!y){if(l.set("denominationId",""),l.set("denominationAmount",""),l.set("denominationCurrency",""),l.set("sellingPrice",""),l.set("sellingCurrency",""),""==f||null==f||void 0==f)return e("#inputdenomi_id").show(),!1;if(1>f)return e("#billlimitamt").show(),!1;v=f}if(!f){var g=y.split("~"),b=g[1],w=b,k=g[2];l.set("denominationCurrency",k);var P=g[0],V=g[4],x=g[3];if(l.set("denominationId",P),l.set("denominationAmount",w),l.set("denominationCurrency",k),l.set("sellingPrice",V),l.set("sellingCurrency",x),""==b||"-1"==b||void 0==b)return e("#selectdenomi_id").show(),!1;v=b}if(-1!=v.indexOf(".")||(v+=".00"),parseFloat(v)<=0){o="true";break}p[1]=v,d=parseFloat(d)+parseFloat(v),d+="",-1!=d.indexOf(".")||(d+=".00"),l.set("amtValchck",d),l.set("hidTotalAmt",d),s[c+""]=p}if("true"==o)return e("#amountvalidation").show(),!1;if(1==r)return!1;l.set("BillerLists",s);var q=l.get("hidTotalAmt");t.history.navigate("#/billpayinquiry1/"+q)},errorresponse:function(){hideSpinner(),t.history.navigate("#/exception")},disposeView:function(e){return t.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return d});
define(["jquery","underscore","Backbone","collections/sadad/addBillsCollections","collections/sadad/billerSubCategoryCollections","collections/sadad/billerCategoryCollections","collections/sadad/billerInDetailsCollections","collections/sadad/billInquiryAccountCollections","collections/sadad/sadadEnquireCollections","collections/sadad/oneTimePayValidationCollections","text!views/sadad/oneTimePay.tpl","models/validation/sadad/postpaidValidationModel","models/validation/sadad/prepaidValidationModel","text!views/common/queuemode.tpl","text!views/sadad/oneTimePayAccCard.tpl"],function(e,r,t,a,o,i,d,n,s,l,u,c,p,m,h){var P="N",v=new EncryptedLocalStorage("secret"),_=t.View.extend({el:"#container",e1:"#menuwrapper",e2:"#mobcontent",events:{"click #enquire":"enquirePostpaidAmount","click #confirm":"confirm","change #serviceType":"billerSubCatg","change #serviceProviderType":"showServiceProvicerDetails","change #selectidProof":"allowtoEnterIdProof","change #frmacnt":"selectTypeAsAcct","change #frmcardcnt":"selectTypeAsCard","click #billercomp":"changeBillerComp","click #idPayAmountPost":"openNumPad","change #idSubsNo":"idSubsNo","click #getId":"getId"},openNumPad:function(){id="idPayAmountPost";var r=/iPad|iPhone|iPod/.test(navigator.userAgent),t=v.get("isKeyPadNeed");r&&t&&navigator.notification.keypadOpen(e("#"+id).val(),9,function(r){e("#"+id).val(convertNumbers2English(r))},function(r){e("#"+id).val(convertNumbers2English(r))})},idSubsNo:function(){var r=e("#serviceProviderType").val(),t=v.get("billerMobLenMin"),a=v.get("billerSubLenMin"),o=document.getElementById("idSubsNo"),i=e("#idSubsNo").val();if("PREPAID"==r){o=o.value.length;var d=t-o;if(t>o&&(i="0"+i,e("#idSubsNo").val(i)),t>o){for(var n=0;d>n;n++)i="0"+i;e("#idSubsNo").val(i),v.set("idSubsNoval",i)}}else{o=o.value.length;var d=a-o;if(a>o){for(var n=0;d>n;n++)i="0"+i;e("#idSubsNo").val(""),v.set("idSubsNoval",i),""!=o&&void 0!=o&&e("#idSubsNo").val(i)}}},getId:function(){var r=v.get("id_type");"NAT"==r?e("#selectidProof").prop("selectedIndex",2):"IQA"==r&&e("#selectidProof").prop("selectedIndex",1),e("#idProof").val(v.get("iqama_number"))},dropselectenable:function(){this.$("#accard").html(r.template(h)).i18n();var t=e("input[name=billercomp]:checked").val(),a=t.split("~"),o=a[0];"017"==o?e("#enquire").attr("disabled","disabled"):e("#enquire").removeAttr("disabled");var i,d=v.get("paymentMethoddefaultselection"),n=v.get("defaultSelectionListDetails");if(""!=n&&null!=n){"ACCOUNT"==d?i=v.get("fromaccDTO"):"CREDITCARD"==d&&(i=v.get("creditcards"));var s=0,l="",u=new Array;r.each(i,function(e,r){"ACCOUNT"==d?u[s]=e.accountNumber:"CREDITCARD"==d&&(u[s]=e.creditCardNoMasked.replace(/\-/g,"")),fromAccdefaultselection==u[s]&&(l=parseInt(r)),s++}),"ACCOUNT"==d?(e("input:radio[name=frmacno]")[l].checked=!0,e(".creditCard").hide(),e(".fromAcc").show(),e("#labelAccount").addClass("active"),e("#labelAccount").addClass("btn-success"),e("#labelAccount").removeClass("btn-default"),e("#labelCard").removeClass("active"),e("#labelCard").addClass("btn-default"),e("#labelCard").removeClass("btn-success")):"CREDITCARD"==d&&(e("input:radio[name=frmcard]")[l].checked=!0,e(".creditCard").show(),e(".fromAcc").hide(),e("#Error_FrmAcctNo").hide(),e("#labelAccount").removeClass("active"),e("#labelAccount").removeClass("btn-success"),e("#labelAccount").addClass("btn-default"),e("#labelCard").addClass("active"),e("#labelCard").removeClass("btn-default"),e("#labelCard").addClass("btn-success")),e(".dropselect").dropselect()}},selectTypeAsAcct:function(){e("#hidPaymentMode").val("ACCT"),e("#Error_IdProof").hide(),e("#Error_IdSubsNo").hide(),e("#Error_idPayAmountPre").hide(),e("#Error_idPayAmountPost").hide(),e("#Error_FrmAcctNo").hide(),e("#Error_CreditCardNo").hide(),e("#Error_IdPattern").hide(),e("#Error_ValidminmsgPost").hide(),e("#Error_ValidminmsgPre").hide(),e("#Error_ValidmaxmsgPost").hide(),e("#Error_ValidmaxmsgPre").hide(),e("#labelAccount").addClass("active"),e("#labelAccount").addClass("btn-success"),e("#labelAccount").removeClass("btn-default"),e("#labelCard").removeClass("active"),e("#labelCard").addClass("btn-default"),e("#labelCard").removeClass("btn-success")},selectTypeAsCard:function(){e("#hidPaymentMode").val("CARD"),e("#Error_IdProof").hide(),e("#Error_IdSubsNo").hide(),e("#Error_idPayAmountPre").hide(),e("#Error_idPayAmountPost").hide(),e("#Error_FrmAcctNo").hide(),e("#Error_CreditCardNo").hide(),e("#Error_IdPattern").hide(),e("#Error_ValidminmsgPost").hide(),e("#Error_ValidminmsgPre").hide(),e("#Error_ValidmaxmsgPost").hide(),e("#Error_ValidmaxmsgPre").hide(),e("#labelAccount").removeClass("active"),e("#labelAccount").removeClass("btn-success"),e("#labelAccount").addClass("btn-default"),e("#labelCard").addClass("active"),e("#labelCard").removeClass("btn-default"),e("#labelCard").addClass("btn-success")},initialize:function(){},update:function(){P="N",v.set("currentPage","");var t=this;v.set("srvtype","");var a=v.get("queueMode");if("P"==a){showSpinner();var o=function(e){t.billerAccount()},d=function(e){t.errorresponse()};t.collection=new i([],{});var n=(new Date).getTime(),s="01",l="",u="SADAD",c=v.get("custno");t.collection.fetch({data:e.param({serviceid:s,inqflag:"",language:l,paramcode:u,userid:c,requestid:n}),dataType:"json",timeout:parseInt(v.get("calltimeout")),type:"POST",cache:!1,success:function(e){"0000"==ackStatus?o(e):d(e)},error:d})}else v.set("queueModeModule","onetimepay"),this.$("#mobcontent").html(r.template(m)).i18n()},billerAccount:function(){var r=this;showSpinner();var t=function(e){r.OTPayment()},a=function(e){r.errorresponse()};r.collection=new n([],{});var o=(new Date).getTime(),i=v.get("segmentvalue"),d="ALL",s="S",l="SADAD";r.collection.fetch({data:e.param({trans_type:"ONETIMEPAY",segment:i,status:"ACTIVE",billerinitflag:"N",serviceid:d,flag:s,paramcode:l,requestid:o}),dataType:"json",type:"POST",timeout:parseInt(v.get("calltimeout")),cache:!1,success:function(e){"0000"==ackStatus?t(e):a(e)},error:a})},OTPayment:function(){hideSpinner(),this.$("#mobcontent").html(r.template(u)).i18n(),e(".amtformatter").formatamount()},billerSubCatg:function(){v.set("srvtype",""),e("#accard").empty(),e("#idPayAmountPost").prop("readonly",!1),e("#Due_Amt").hide(),e("#Due_Date").hide(),e("#Exat_Pay").hide(),e("#Min_Pay").hide(),e("#Max_Pay").hide(),e("#invalid_Due_Amt").hide(),e("#Error_Common_Neg_Val").hide(),e("#billercompany").hide(),e("#dynamicbillercompany").empty(),e("#paymentDIV").hide(),e("#serviceProviderTypeDiv").hide(),e("#selectidProofdiv").hide(),e("#idProof").val(""),e("#idProofdiv").hide(),e("#idSubsNo").val(""),e("#idSubsNoDiv").hide(),e("#idPayAmountPost").val(""),e("#idPayAmountPostDiv").hide(),e("#idPayAmountPre").val(""),e("#idPayAmountPreDiv").hide(),e("#idDemonDiv").hide(),e("#idpreDemonDiv").hide(),e("#Min_Paypre").hide(),e("#Max_Paypre").hide(),e("#Error_IdProof").hide(),e("#Error_IdSubsNo").hide(),e("#Error_idPayAmountPre").hide(),e("#Error_idPayAmountPost").hide(),e("#Error_FrmAcctNo").hide(),e("#Error_CreditCardNo").hide(),e("#Error_IdPattern").hide(),e("#Error_ValidminmsgPost").hide(),e("#Error_ValidminmsgPre").hide(),e("#Error_ValidmaxmsgPost").hide(),e("#Error_ValidmaxmsgPre").hide(),showSpinner();var t=this,a=(e("#hiddenservice").val(),function(e){t.errorresponse()});t.collection=new o([],{});var i=e("#hiddenservice").val(),d=(new Date).getTime(),n=v.get("custno"),s="";t.collection.fetch({data:e.param({userid:n,inqflag:"BILLER",paramcode:i,language:s,requestid:d}),dataType:"json",timeout:parseInt(v.get("calltimeout")),type:"POST",cache:!1,success:function(t){if("0000"==ackStatus){if(e("#billercompany").removeAttr("style"),e(".selectHolder").empty(),e("#billercompany").empty(),e("#dynamicbillercompany").html('<div class="dropselectbiller" data-title="'+e.i18n.t("app.sadad.onetimepay.billercompany")+'" id="billercompany" style="display:none;"></div>'),0!=r.size(billercategory)){var o=0,i="";r.each(billercategory,function(e,r){i+='<label class="list-group-item" id="billerComp">',i+='<input type="radio" id="billercomp" name="billercomp" value="'+e.strBillerServiceCode+"~"+e.strBillerServiceDesc+"~"+r+'" />',i+='<span class="nme" id="nme'+r+'">'+e.strBillerServiceDesc+"</span> </label>",o++}),e("#billercompany").html(i),e("#billercompany").show(),e(".dropselectbiller").dropselectbiller()}hideSpinner()}else a(t)},error:a})},changeBillerComp:function(){var r=e("input[name=billercomp]:checked").val(),t=r.split("~"),a=t[1],o=t[2];e("#nme"+o).text(a),this.showBillerinDetails()},showBillerinDetails:function(){v.set("srvtype",""),e("#enquire").removeAttr("disabled"),e("#idPayAmountPost").prop("readonly",!1),e("#Due_Amt").hide(),e("#Due_Date").hide(),e("#invalid_Due_Amt").hide(),e("#Error_Common_Neg_Val").hide(),e("#Exat_Pay").hide(),e("#Min_Pay").hide(),e("#Max_Pay").hide(),e("#paymentDIV").hide(),e("#serviceProviderTypeDiv").hide(),e("#selectidProofdiv").hide(),e("#idProof").val(""),e("#idProofdiv").hide(),e("#idSubsNo").val(""),e("#idSubsNoDiv").hide(),e("#idPayAmountPost").val(""),e("#idPayAmountPostDiv").hide(),e("#idPayAmountPre").val(""),e("#idPayAmountPreDiv").hide(),e("#idDemonDiv").hide(),e("#idpreDemonDiv").hide(),e("#Min_Paypre").hide(),e("#Max_Paypre").hide(),e("#Error_IdProof").hide(),e("#Error_IdSubsNo").hide(),e("#Error_idPayAmountPre").hide(),e("#Error_idPayAmountPost").hide(),e("#Error_FrmAcctNo").hide(),e("#Error_CreditCardNo").hide(),e("#Error_IdPattern").hide(),e("#Error_ValidminmsgPost").hide(),e("#Error_ValidminmsgPre").hide(),e("#Error_ValidmaxmsgPost").hide(),e("#Error_ValidmaxmsgPre").hide(),showSpinner();var t=this,a=(e("#hiddenservice").val(),function(e){t.errorresponse()}),o=function(e){t.showServiceProvicerDetails(e)};t.collection=new d([],{});var i=(e("#hiddenservice").val(),(new Date).getTime()),n=v.get("custno"),s="",l=e("input[name=billercomp]:checked").val(),u=l.split("~"),c=u[0];v.set("billerId",c),t.collection.fetch({data:e.param({userid:n,paramcode:c,language:s,requestid:i}),dataType:"json",timeout:parseInt(v.get("calltimeout")),type:"POST",cache:!1,success:function(t){if("0000"==ackStatus){var i=v.get("billerDetails_cache"),d=i[0].strBillerType,n=i[0].strSadadOperator;if(e("#BillerType").val(i[0].strBillerType),e("#BillerDesclaimer").val(i[0].strBillerDesclaimer),e("#BillerIdLenMin").val(i[0].strBillerIdLenMin),e("#BillerIdLenMax").val(i[0].strBillerIdLenMax),e("#BillerMobLenMin").val(i[0].strBillerMobLenMin),e("#BillerMobLenMax").val(i[0].strBillerMobLenMax),e("#BillerSubLenMin").val(i[0].strBillerSubLenMin),e("#BillerSubLenMax").val(i[0].strBillerSubLenMax),i[0].strPrepaid_start_with?e("#strPrepaidStartWith").val(i[0].strPrepaid_start_with):e("#strPrepaidStartWith").val(""),i[0].strPostpaid_start_with?e("#strPostpaidStartWith").val(i[0].strPostpaid_start_with):e("#strPostpaidStartWith").val(""),i[0].strPostpaid_start_des_en?e("#strPostpaidStartDesEn").val(i[0].strPostpaid_start_des_en):e("#strPostpaidStartDesEn").val(""),i[0].strPrepaid_start_des_en?e("#strPrepaidStartDesEn").val(i[0].strPrepaid_start_des_en):e("#strPrepaidStartDesEn").val(""),i[0].strPostpaid_start_des_ar?e("#strPostpaidStartDesAr").val(i[0].strPostpaid_start_des_ar):e("#strPostpaidStartDesAr").val(""),i[0].strPrepaid_start_des_ar?e("#strPrepaidStartDesAr").val(i[0].strPrepaid_start_des_ar):e("#strPrepaidStartDesAr").val(""),e("#BillerPerServType").val(i[0].strBillerPerServType),e("#BillerSadadOperator").val(n),e("#serviceProviderType").empty(),"BOTH"==d){if(0!=r.size(serviceType)){var s=0;e("#serviceProviderType").append('<option id="serviceTypeVal'+s+'"value="">'+e.i18n.t("app.sadad.onetimepay.billerTypeselect")+"</option>"),r.each(serviceType,function(r){e("#serviceProviderType").append('<option id="serviceTypeVal'+s+'"value="'+r.paramCode+'">'+r.paramDescription+"</option>"),s++}),e("#serviceProviderTypeDiv").show()}}else if("PREPAID"==d||"NMB"==n){e("#idSubsNoDiv").show(),e("#idSubsNo").attr("placeholder",i[0].strBillerSubNoLable),e("#idSubsNo").attr("maxlength",parseInt(i[0].strBillerSubLenMax));var l=v.get("device.platform");"Android"==l||e(".lenthcontrol").inputlength();v.get("demon");e("#Min_Paypre").hide(),e("#Max_Paypre").hide(),e("#idPayAmountPostDiv").show()}else if("PREPAID"==d||""==n)o(d);else{e("#idSubsNoDiv").show(),e("#Min_Paypre").hide(),e("#Max_Paypre").hide(),e("#idSubsNo").attr("placeholder",i[0].strBillerSubNoLable),e("#idSubsNo").attr("maxlength",parseInt(i[0].strBillerSubLenMax));var l=v.get("device.platform");"Android"==l||e(".lenthcontrol").inputlength(),e("#idPayAmountPostDiv").show()}hideSpinner()}else a(t)},error:a})},showServiceProvicerDetails:function(t){v.set("srvtype",""),e("#idPayAmountPost").prop("readonly",!1),e("#Due_Amt").hide(),e("#Due_Date").hide(),e("#invalid_Due_Amt").hide(),e("#Error_Common_Neg_Val").hide(),e("#Exat_Pay").hide(),e("#Min_Pay").hide(),e("#Max_Pay").hide(),e("#paymentDIV").hide(),e("#selectidProofdiv").hide(),e("#idProof").val(""),e("#idProofdiv").hide(),e("#idSubsNo").val(""),e("#idSubsNoDiv").hide(),e("#idPayAmountPost").val(""),e("#idPayAmountPostDiv").hide(),e("#idPayAmountPre").val(""),e("#idPayAmountPreDiv").hide(),e("#idDemonDiv").hide(),e("#idpreDemonDiv").hide(),e("#Min_Paypre").hide(),e("#Max_Paypre").hide(),e("#Error_IdProof").hide(),e("#Error_IdSubsNo").hide(),e("#Error_IdPattern").hide(),e("#Error_idPayAmountPre").hide(),e("#Error_idPayAmountPost").hide(),e("#Error_FrmAcctNo").hide(),e("#Error_CreditCardNo").hide(),e("#Error_ValidminmsgPost").hide(),e("#Error_ValidminmsgPre").hide(),e("#Error_ValidmaxmsgPost").hide(),e("#Error_ValidmaxmsgPre").hide();var a;if(a="PREPAID"==t?t:e("#serviceProviderType").val(),"PREPAID"==a){var o=v.get("billerDetails_cache");e("#idSubsNoDiv").show(),e("#idSubsNo").attr("placeholder",o[0].strBillerMobLabel),e("#idSubsNo").attr("maxlength",parseInt(o[0].strBillerMobLenMax));var i=v.get("device.platform");"Android"==i||v.set("Maxlengthcontrol",e("#idSubsNo").attr("maxlength",parseInt(o[0].strBillerMobLenMax)));var d=e("#BillerSadadOperator").val();if("NMB"!=d){var n=v.get("idType_cache");if(e("#selectidProof").empty(),0!=r.size(n)){var s=0;e("#selectidProof").append('<option id="idProofVal'+s+'"value="">'+e.i18n.t("app.sadad.onetimepay.idproffselect")+"</option>"),r.each(n,function(r){e("#selectidProof").append('<option id="idProofVal'+s+'"value="'+r.paramCode+'">'+r.paramDescription+"</option>"),s++}),e("#selectidProofdiv").show()}}else{this.dropselectenable();var l=v.get("demon"),u=v.get("lower"),c=v.get("upper");if(null!=l&&""!=l&&void 0!=l){var p=l;if(e("#demonn").empty(),0!=r.size(p)){var s=0;e("#demonn").append('<option id="demonnTypeVal"value="">'+e.i18n.t("app.sadad.onetimepay.selectrechargtop")+"</option>"),r.each(p,function(r,t){e("#demonn").append('<option id="demonnTypeVal'+s+'"value="'+r+'">KWD '+r+"</option>"),s++})}e("#idDemonDiv").show(),e("#idpreDemonDiv").show(),e("#Min_Paypre").hide(),e("#Max_Paypre").hide()}else e("#idPayAmountPreDiv").show(),e("#paymentDIV").show(),parseFloat(u)>0&&(e("#Min_Paypre").show(),e("#Min_Paypre").html(e.i18n.t("app.sadad.onetimepay.min_amt_lbl")+" : "+checkAmount(e.formatNumber(u,{format:"#,###.000",locale:"us"})))),parseFloat(c)>0&&(e("#Max_Paypre").show(),e("#Max_Paypre").html(e.i18n.t("app.sadad.onetimepay.max_amt_lbl")+" : "+checkAmount(e.formatNumber(c,{format:"#,###.000",locale:"us"}))))}}else{e("#idSubsNoDiv").show(),e("#Min_Paypre").hide(),e("#Max_Paypre").hide();var o=v.get("billerDetails_cache");e("#idSubsNo").attr("placeholder",o[0].strBillerSubNoLable),e("#idSubsNo").attr("maxlength",parseInt(o[0].strBillerSubLenMax)),e("#idPayAmountPostDiv").show()}e(".lenthcontrol").inputlength()},allowtoEnterIdProof:function(){this.dropselectenable(),e("#idProofdiv").show();var r=v.get("billerDetails_cache");e("#idProof").attr("placeholder",r[0].strBillerIDLabel),e("#idProof").attr("maxlength",parseInt(r[0].strBillerIdLenMax));var t=v.get("device.platform");"Android"==t||e(".lenthcontrol").inputlength(),e("#idPayAmountPreDiv").show(),e("#paymentDIV").show(),e("#idProof").focus();var a=v.get("lower"),o=v.get("upper");parseFloat(a)>0&&(e("#Min_Paypre").show(),e("#Min_Paypre").html(e.i18n.t("app.sadad.onetimepay.min_amt_lbl")+" : "+checkAmount(e.formatNumber(a,{format:"#,###.000",locale:"us"})))),parseFloat(o)>0&&(e("#Max_Paypre").show(),e("#Max_Paypre").html(e.i18n.t("app.sadad.onetimepay.max_amt_lbl")+" : "+checkAmount(e.formatNumber(o,{format:"#,###.000",locale:"us"}))))},enquirePostpaidAmount:function(){v.set("srvtype",""),e("#Due_Amt").hide(),e("#Due_Date").hide(),e("#Exat_Pay").hide(),e("#Min_Pay").hide(),e("#Max_Pay").hide(),e("#invalid_Due_Amt").hide(),e("#Error_Common_Neg_Val").hide(),e("#Error_IdProof").text(""),e("#Error_IdSubsNo").text(""),e("#Error_IdPattern").text(""),e("#Error_idPayAmountPre").text(""),e("#Error_idPayAmountPost").text(""),e("#Error_iddemonAmountPre").text(""),e("#Error_iddemonAmountPre").hide(),e("#Error_FrmAcctNo").text(""),e("#Error_CreditCardNo").text(""),e("#Error_IdProof").hide(),e("#Error_IdSubsNo").hide(),e("#Error_IdPattern").hide(),e("#Error_idPayAmountPre").hide(),e("#Error_idPayAmountPost").hide(),e("#Error_FrmAcctNo").hide(),e("#Error_CreditCardNo").hide(),e("#Error_ValidminmsgPost").hide(),e("#Error_ValidminmsgPre").hide(),e("#Error_ValidmaxmsgPost").hide(),e("#Error_ValidmaxmsgPre").hide(),e("#idPayAmountPost").prop("readonly",!1);var r=e("#idSubsNo").val(),t=(e("#idPayAmountPost").val(),e("#BillerSubLenMin").val()),a=e("#BillerSubLenMax").val(),o=e("#strPostpaidStartWith").val(),i=e("#strPostpaidStartDesEn").val(),d=e("#strPostpaidStartDesAr").val(),n=v.get("language_id"),l="false";if("en-US"==n)if("undefined"==typeof r||""==r)"0"==t?(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthmust")+" "+a),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),l="true"):(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthbetween")+" "+t+"-"+a),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),l="true");else{var u=r.length,c=parseInt(t),p=parseInt(a),m=o.replace(new RegExp(",","g"),"|"),h=(o.replace(new RegExp(",","g")," or "),"/^("+m+")"),P=new RegExp(h.replace(new RegExp("/","g"),""));P.test(r)?0==c||c==p?u!=p&&(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthmust")+" "+a),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),l="true"):u>=c&&p>=u||(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthbetween")+" "+t+"-"+a),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),l="true"):(e("#Error_IdPattern").text(i),e("#idSubsNo").focus(),e("#Error_IdPattern").show(),l="true")}else if("undefined"==typeof r||""==r)"0"==t?(e("#Error_IdSubsNo").text(a+" "+e.i18n.t("validation.sadad.otpfieldlengthmust")),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),l="true"):(e("#Error_IdSubsNo").text(a+"-"+t+" "+e.i18n.t("validation.sadad.otpfieldlengthbetween")),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),l="true");else{var u=r.length,c=parseInt(t),p=parseInt(a),m=o.replace(new RegExp(",","g"),"|"),h=(o.replace(new RegExp(",","g")," or "),"/^("+m+")"),P=new RegExp(h.replace(new RegExp("/","g"),""));P.test(r)?0==c?u!=p&&(e("#Error_IdSubsNo").text(a+" "+e.i18n.t("validation.sadad.otpfieldlengthmust")),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),l="true"):u>=c&&p>=u||(e("#Error_IdSubsNo").text(a+"-"+t+" "+e.i18n.t("validation.sadad.otpfieldlengthbetween")),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),l="true"):(e("#Error_IdPattern").text(d),e("#idSubsNo").focus(),e("#Error_IdPattern").show(),l="true")}if("true"==l)return!1;this.dropselectenable();var _=this,f=function(e){_.errorresponse()};_.collection=new s([],{});var y=v.get("custno"),b=e("#idSubsNo").val(),E=e("input[name=billercomp]:checked").val(),g=E.split("~"),A=g[0];"017"!=A&&(showSpinner(),_.collection.fetch({data:e.param({customerid:y,incpaymentranges:"",biller:b,billerid:A,requestid:timestamp}),dataType:"json",type:"POST",timeout:parseInt(v.get("calltimeout")),cache:!1,success:function(r){if("0000"==ackStatus){v.set("billerRangeInfo",billerInfoPlusDetail),e("#Due_Amt").empty(),e("#Due_Date").empty(),e("#Exat_Pay").empty(),e("#Min_Pay").empty(),e("#Max_Pay").empty();var t=v.get("billinqdetails"),a=t[0].amountdue;v.set("amtDue",a);var o=t[0].exapayreq,i=t[0].billduedate,d=t[0].srvtype;v.set("srvtype",d),("undefined"==typeof i||""==i)&&(i="-"),("undefined"==typeof o||""==o)&&(o="-"),("false"==o||"False"==o||"FALSE"==o)&&(o="NO"),("true"==o||"True"==o||"TRUE"==o)&&(o="YES"),e("#idPayAmountPost").val(a),e("#postAmtDue").val(a),e("#postExactPay").val(o),e("#PostDueDate").val(i);var n=v.get("billerRangeInfo"),s=(v.get("basecurr"),v.get("billerId")),l="",u="",c=n&&n[0].billerPaymentRangesDTO[0]?n[0].billerPaymentRangesDTO[0].billerRangeDTO[0]:"";if(c&&c.billerid==s&&(l=c.lower,u=c.upper),e("#Due_Amt").show(),e("#Due_Date").show(),e("#Exat_Pay").show(),e("#Due_Amt").html(e.i18n.t("app.sadad.onetimepay.dueamount")+" : "+a),e("#Due_Date").html(e.i18n.t("app.sadad.onetimepay.duedate")+" : "+i),"YES"!=o&&parseFloat(l)>0&&(e("#Min_Pay").show(),e("#Min_Pay").html(e.i18n.t("app.sadad.onetimepay.min_amt_lbl")+" : "+checkAmount(e.formatNumber(l,{format:"#,###.000",locale:"us"})))),"YES"!=o&&parseFloat(u)>0&&(e("#Max_Pay").show(),e("#Max_Pay").html(e.i18n.t("app.sadad.onetimepay.max_amt_lbl")+" : "+checkAmount(e.formatNumber(u,{format:"#,###.000",locale:"us"})))),"YES"==o?e("#Exat_Pay").html(e.i18n.t("app.sadad.onetimepay.exactpayment")+" : "+e.i18n.t("app.sadad.onetimepay.exactpaymentyes")):"NO"==o&&e("#Exat_Pay").html(e.i18n.t("app.sadad.onetimepay.exactpayment")+" : "+e.i18n.t("app.sadad.onetimepay.exactpaymentno")),"true"==o||"YES"==o||"Yes"==o||"-"==o){var p=v.get("device.platform");if("Android"==p?e("#idPayAmountPost").prop("readonly",!0):e("#idPayAmountPost").attr("disabled","disabled"),"undefined"==typeof a||""==a)return e("#invalid_Due_Amt").show(),hideSpinner(),!1;if(-1!=a.indexOf("-"))return e("#Error_Common_Neg_Val").show(),hideSpinner(),!1}else e("#idPayAmountPost").prop("readonly",!1),"undefined"!=typeof a&&""!=a&&-1!=a.indexOf("-")&&e("#idPayAmountPost").val("0.00");"-"==o?e("#paymentDIV").hide():e("#paymentDIV").show(),hideSpinner()}else f(r)},error:f}))},confirm:function(r){var t=this;e("#Error_IdProof").text(""),e("#Error_IdSubsNo").text(""),e("#Error_idPayAmountPre").text(""),e("#Error_idPayAmountPost").text(""),e("#Error_iddemonAmountPre").text(""),e("#Error_iddemonAmountPre").hide(),e("#Error_FrmAcctNo").text(""),e("#Error_CreditCardNo").text(""),e("#Error_IdPattern").text(""),e("#Error_IdProof").hide(),e("#Error_IdSubsNo").hide(),e("#Error_IdPattern").hide(),e("#Error_idPayAmountPre").hide(),e("#Error_idPayAmountPost").hide(),e("#Error_FrmAcctNo").hide(),e("#Error_CreditCardNo").hide(),e("#Error_ValidminmsgPost").hide(),e("#Error_ValidminmsgPre").hide(),e("#Error_ValidmaxmsgPost").hide(),e("#Error_ValidmaxmsgPre").hide();var a,o,i,d,n,s,l,u,c,p,m,h,P,_=v.get("lower"),f=v.get("upper");l=e("#hidPaymentMode").val();var y=e("#BillerType").val(),b=e("#BillerSadadOperator").val();"BOTH"==y&&(y=e("#serviceProviderType").val());var E=v.get("billerId");if("017"!=E)if("PREPAID"==y){var g=e("#demonn").val();v.set("demonnamount",g),a=e("#idProof").val(),v.set("iqamaID",a),o=e("#idSubsNo").val(),i=e("#idPayAmountPre").val(),u=e("#BillerIdLenMin").val(),c=e("#BillerIdLenMax").val(),p=e("#BillerSubLenMin").val(),m=e("#BillerSubLenMax").val();var A=e("#strPrepaidStartWith").val(),S=e("#strPrepaidStartDesEn").val(),x=e("#strPrepaidStartDesAr").val(),I=v.get("language_id");h=e("#BillerMobLenMin").val(),P=e("#BillerMobLenMax").val();var N=e("#selectidProof").val();v.set("selectedIdProof",N);var w="false";if("en-US"==I){if("undefined"==typeof a||""==a)"NMB"!=b&&("0"==u||u==c?(e("#Error_IdProof").text(e.i18n.t("validation.sadad.otpfieldlengthmust")+" "+c),e("#idProof").focus(),e("#Error_IdProof").show(),w="true"):(e("#Error_IdProof").text(e.i18n.t("validation.sadad.otpfieldlengthbetween")+" "+u+"-"+c),e("#idProof").focus(),e("#Error_IdProof").show(),w="true"));else{var D=a.length,C=parseInt(u),M=parseInt(c);0==C||C==M?D!=M&&(e("#Error_IdProof").text(e.i18n.t("validation.sadad.otpfieldlengthmust")+" "+c),e("#idProof").focus(),e("#Error_IdProof").show(),w="true"):D>=C&&M>=D||(e("#Error_IdProof").text(e.i18n.t("validation.sadad.otpfieldlengthbetween")+" "+u+"-"+c),e("#idProof").focus(),e("#Error_IdProof").show(),w="true"),2==e("#selectidProof").prop("selectedIndex")&&0!=a.indexOf("1")?(e("#Error_IdProof").text(e.i18n.t("validation.sadad.valididnumber")),e("#idProof").focus(),e("#Error_IdProof").show(),w="true"):1==e("#selectidProof").prop("selectedIndex")&&0!=a.indexOf("2")&&(e("#Error_IdProof").text(e.i18n.t("validation.sadad.valididnumber")),e("#idProof").focus(),e("#Error_IdProof").show(),w="true")}if("undefined"==typeof o||""==o)"0"==h||u==c?(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthmust")+" "+P),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),w="true"):(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthbetween")+" "+h+"-"+P),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),w="true");else{var T=o.length,V=parseInt(h),B=parseInt(P),R=A.replace(new RegExp(",","g"),"|"),F=(A.replace(new RegExp(",","g")," or "),"/^("+R+")"),O=new RegExp(F.replace(new RegExp("/","g"),""));O.test(o)?0==V||V==B?T!=B&&(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthmust")+" "+P),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),w="true"):T>=V&&B>=T||(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthbetween")+" "+h+"-"+P),e("#idSubsNo").focus(),e("#Error_IdSubsNo").show(),w="true"):(e("#Error_IdPattern").text(S),e("#idSubsNo").focus(),e("#Error_IdPattern").show(),w="true")}}else{if("undefined"==typeof a||""==a)"NMB"!=b&&("0"==u?(e("#Error_IdProof").text(c+" "+e.i18n.t("validation.sadad.otpfieldlengthmust")),e("#idProof").focus(),e("#Error_IdProof").show(),w="true"):(e("#Error_IdProof").text(c+"-"+u+" "+e.i18n.t("validation.sadad.otpfieldlengthbetween")),e("#idProof").focus(),e("#Error_IdProof").show(),w="true"));else{var D=a.length,C=parseInt(u),M=parseInt(c);0==C?D!=M&&(e("#Error_IdProof").text(c+" "+e.i18n.t("validation.sadad.otpfieldlengthmust")),e("#idProof").focus(),e("#Error_IdProof").show(),w="true"):D>=C&&M>=D||(e("#Error_IdProof").text(c+"-"+u+" "+e.i18n.t("validation.sadad.otpfieldlengthbetween")),e("#idProof").focus(),e("#Error_IdProof").show(),w="true")}if("undefined"==typeof o||""==o)"0"==h?(e("#Error_IdSubsNo").text(P+" "+e.i18n.t("validation.sadad.otpfieldlengthmust")),e("#Error_IdSubsNo").show(),w="true"):(e("#Error_IdSubsNo").text(P+"-"+h+" "+e.i18n.t("validation.sadad.otpfieldlengthbetween")),e("#Error_IdSubsNo").show(),w="true");else{var T=o.length,V=parseInt(h),B=parseInt(P),R=A.replace(new RegExp(",","g"),"|"),F=(A.replace(new RegExp(",","g")," or "),"/^("+R+")"),O=new RegExp(F.replace(new RegExp("/","g"),""));O.test(o)?0==V?T!=B&&(e("#Error_IdSubsNo").text(P+" "+e.i18n.t("validation.sadad.otpfieldlengthmust")),e("#Error_IdSubsNo").show(),w="true"):T>=V&&B>=T||(e("#Error_IdSubsNo").text(P+"-"+h+" "+e.i18n.t("validation.sadad.otpfieldlengthbetween")),e("#Error_IdSubsNo").show(),w="true"):(e("#Error_IdPattern").text(x),e("#idSubsNo").focus(),e("#Error_IdPattern").show(),w="true")}}var L=v.get("demon");if(null!=L&&""!=L&&void 0!=L)("undefined"==typeof g||""==g)&&(e("#Error_iddemonAmountPre").text(e.i18n.t("app.sadad.onetimepay.plsselectrechargtop")),e("#demonn").focus(),e("#Error_iddemonAmountPre").show(),w="true");else{("undefined"==typeof i||""==i)&&(e("#Error_idPayAmountPre").text(e.i18n.t("validation.sadad.amountisnotnull")),e("#idPayAmountPre").focus(),e("#Error_idPayAmountPre").show(),w="true"),("0"==i||-1!=i.indexOf("-"))&&(e("#Error_idPayAmountPre").text(e.i18n.t("validation.sadad.negamountvaldate")),e("#idPayAmountPre").focus(),e("#Error_idPayAmountPre").show(),w="true"),parseFloat(i)<=0&&(e("#Error_idPayAmountPre").text(e.i18n.t("validation.sadad.negamountvaldate")),e("#idPayAmountPre").focus(),e("#Error_idPayAmountPre").show(),w="true");var k=v.get("basecurr"),q=(v.get("dbFlag"),v.get("amtDue"));parseFloat(i)>0&&""!=i&&""!=i&&"0"!=i&&parseFloat(_)>0&&parseFloat(i)<parseFloat(_)&&(e("#Error_ValidminmsgPre").text(e.i18n.t("app.sadad.onetimepay.errorpaygreaterthan")+" "+k+" "+checkAmount(e.formatNumber(_,{format:"#,###.000",locale:"us"}))),e("#Error_ValidminmsgPre").show(),w="true"),parseFloat(f)>0&&parseFloat(i)>parseFloat(f)&&(e("#Error_ValidmaxmsgPre").text(e.i18n.t("app.sadad.onetimepay.errorpaylessthan")+" "+k+" "+checkAmount(e.formatNumber(f,{format:"#,###.000",locale:"us"}))),e("#Error_ValidmaxmsgPre").show(),w="true")}}else{o=e("#idSubsNo").val(),d=e("#idPayAmountPost").val(),p=e("#BillerSubLenMin").val(),m=e("#BillerSubLenMax").val();var W=e("#strPostpaidStartWith").val(),U=e("#strPostpaidStartDesEn").val(),Y=e("#strPostpaidStartDesAr").val(),I=v.get("language_id");if("en-US"==I)if("undefined"==typeof o||""==o)"0"==p?(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthmust")+" "+m),e("#Error_IdSubsNo").show(),w="true"):(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthbetween")+" "+p+"-"+m),e("#Error_IdSubsNo").show(),w="true");else{var T=o.length,V=parseInt(p),B=parseInt(m),R=W.replace(new RegExp(",","g"),"|"),F=(W.replace(new RegExp(",","g")," or "),"/^("+R+")"),O=new RegExp(F.replace(new RegExp("/","g"),""));O.test(o)?0==V?T!=B&&(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthmust")+" "+m),e("#Error_IdSubsNo").show(),w="true"):T>=V&&B>=T||(e("#Error_IdSubsNo").text(e.i18n.t("validation.sadad.otpfieldlengthbetween")+" "+p+"-"+m),e("#Error_IdSubsNo").show(),w="true"):(e("#Error_IdPattern").text(U),e("#idSubsNo").focus(),e("#Error_IdPattern").show(),w="true")}else if("undefined"==typeof o||""==o)"0"==p?(e("#Error_IdSubsNo").text(m+" "+e.i18n.t("validation.sadad.otpfieldlengthmust")),e("#Error_IdSubsNo").show(),w="true"):(e("#Error_IdSubsNo").text(m+"-"+p+" "+e.i18n.t("validation.sadad.otpfieldlengthbetween")),e("#Error_IdSubsNo").show(),w="true");else{var T=o.length,V=parseInt(p),B=parseInt(m),R=W.replace(new RegExp(",","g"),"|"),F=(W.replace(new RegExp(",","g")," or "),"/^("+R+")"),O=new RegExp(F.replace(new RegExp("/","g"),""));O.test(o)?0==V?T!=B&&(e("#Error_IdSubsNo").text(m+" "+e.i18n.t("validation.sadad.otpfieldlengthmust")),e("#Error_IdSubsNo").show(),w="true"):T>=V&&B>=T||(e("#Error_IdSubsNo").text(m+"-"+p+" "+e.i18n.t("validation.sadad.otpfieldlengthbetween")),e("#Error_IdSubsNo").show(),w="true"):(e("#Error_IdPattern").text(Y),e("#idSubsNo").focus(),e("#Error_IdPattern").show(),w="true")}var j=e("#postExactPay").val(),z=v.get("billerRangeInfo"),k=v.get("basecurr"),H="",J="",K="",$=(v.get("amtDue"),z&&z[0].billerPaymentRangesDTO[0]?z[0].billerPaymentRangesDTO[0].billerRangeDTO[0]:"");$&&$.billerid==E&&(H=$.lower,J=$.upper,K=$.dbFlag),("undefined"==typeof d||""==d)&&(e("#Error_idPayAmountPost").text(e.i18n.t("validation.sadad.amountisnotnull")),e("#idPayAmountPost").focus(),e("#Error_idPayAmountPost").show(),w="true"),("0"==d||-1!=d.indexOf("-"))&&(e("#Error_idPayAmountPost").text(e.i18n.t("validation.sadad.negamountvaldate")),e("#idPayAmountPost").focus(),e("#Error_idPayAmountPost").show(),w="true"),parseFloat(d)<=0&&(e("#Error_idPayAmountPost").text(e.i18n.t("validation.sadad.negamountvaldate")),e("#idPayAmountPost").focus(),e("#Error_idPayAmountPost").show(),w="true");var q=v.get("amtDue");parseFloat(d)>0&&""!=d&&""!=d&&"0"!=d&&"NO"==j&&parseFloat(H)>0&&parseFloat(d)<parseFloat(H)&&(parseFloat(q)<H&&parseFloat(q)>0||(e("#Error_ValidminmsgPost").text(e.i18n.t("app.sadad.onetimepay.errorpaygreaterthan")+" "+k+" "+checkAmount(e.formatNumber(H,{format:"#,###.000",locale:"us"}))),e("#Error_ValidminmsgPost").show(),w="true")),"NO"==j&&parseFloat(J)>0&&parseFloat(d)>parseFloat(J)&&(e("#Error_ValidmaxmsgPost").text(e.i18n.t("app.sadad.onetimepay.errorpaylessthan")+" "+k+" "+checkAmount(e.formatNumber(J,{format:"#,###.000",locale:"us"}))),e("#Error_ValidmaxmsgPost").show(),
w="true")}else{var I=v.get("language_id"),w="false",d=e("#idPayAmountPost").val();v.set("idPayAmountPost",d),("undefined"==typeof d||""==d)&&(e("#Error_idPayAmountPost").text(e.i18n.t("validation.sadad.amountisnotnull")),e("#idPayAmountPost").focus(),e("#Error_idPayAmountPost").show(),w="true"),("0"==d||-1!=d.indexOf("-"))&&(e("#Error_idPayAmountPost").text(e.i18n.t("validation.sadad.negamountvaldate")),e("#idPayAmountPost").focus(),e("#Error_idPayAmountPost").show(),w="true"),parseFloat(d)<=0&&(e("#Error_idPayAmountPost").text(e.i18n.t("validation.sadad.negamountvaldate")),e("#idPayAmountPost").focus(),e("#Error_idPayAmountPost").show(),w="true")}n=e("input[name=frmacno]:checked").val(),s=e("input[name=frmcard]:checked").val();var l=e("#hidPaymentMode").val();return e("#labelCard").hasClass("btn-success")?e("#Error_FrmAcctNo").hide():"ACCT"==l&&("undefined"==typeof n||""==n)&&(e("#Error_FrmAcctNo").text(e.i18n.t("validation.sadad.fromaccmsg")),e("#Error_FrmAcctNo").show(),w="true"),e("#labelAccount").hasClass("btn-success")?e("#Error_CreditCardNo").hide():("undefined"==typeof s||""==s)&&(e("#Error_CreditCardNo").text(e.i18n.t("validation.sadad.selectcc")),e("#Error_CreditCardNo").show(),w="true"),"true"==w?!1:void t.showOTP()},showOTP:function(){showSpinner();var r=e("#billercategory option:selected").val(),a=e("#billercategory option:selected").text(),o=e("input[name=billercomp]:checked").val(),i=o.split("~"),d=(i[0],e("#BillerType").val()),n="";n=e("#labelAccount").hasClass("btn-success")?"ACCT":e("#labelCard").hasClass("btn-success")?"CARD":e("#hidPaymentMode").val(),v.set("BillerName",a),v.set("BillerType",i[1]);var s,u,c,p,m;"ACCT"==n?(s=e("input[name=frmacno]:checked").val(),void 0!=s&&(u=s.split("~"),s=u[0],c=u[2],p=u[0],m=u[0])):(s=e("input[name=frmcard]:checked").val(),void 0!=s&&(u=s.split("~"),s=u[0],c=u[1],p=u[2],m=u[3]));var h=e("#idSubsNo").val(),P=e("#idPayAmountPre").val(),_=e("#idPayAmountPost").val(),f=v.get("billerDetails_cache"),y=e("#PostDueDate").val(),b=new Array;"BOTH"==d&&(d=e("#serviceProviderType").val()),b[0]=s,b[1]=h;var E;if(E="PREPAID"==d?P:_,-1!=E.indexOf(".")||(E+=".00"),b[2]=E,b[3]=d,"ACCT"==n?b[4]="Account":b[4]="CreditCard",b[5]=r,b[6]=f[0].strBillerServiceCode,b[7]=f[0].strBillerServiceDesc,b[8]=a,b[9]=f[0].strBillerPerServType,"PREPAID"==d){var g=new Date,A=g.getDate();10>A&&(A="0"+A);var S=g.getMonth()+1;10>S&&(S="0"+S),b[10]=g.getYear()+1900+"-"+S+"-"+A}else b[10]=y;b[11]=p,b[12]=m,b[13]=n;var x=c;-1!=c.indexOf(",")&&(x=c.replace(/,/g,"")),c=x;var I=b[2];e("#Error_FrmAcctNo").text(""),e("#Error_CreditCardNo").text(""),e("#Error_FrmAcctNo").hide(),e("#Error_CreditCardNo").hide();var N=e("#hidddailylimit").val(),w=e("#hiddavaillimit").val();if(parseFloat(I)>parseFloat(c)&&"ACCT"!=n)return e("#Error_CreditCardNo").text(e.i18n.t("validation.sadad.amountcheck")),e("#Error_CreditCardNo").show(),hideSpinner(),!1;if(parseFloat(I)>parseFloat(w))return"ACCT"==n?(e("#Error_FrmAcctNo").text(e.i18n.t("validation.sadad.availablelimit")),e("#Error_FrmAcctNo").show()):(e("#Error_CreditCardNo").text(e.i18n.t("validation.sadad.availablelimit")),e("#Error_CreditCardNo").show()),hideSpinner(),!1;if(parseFloat(I)>parseFloat(N))return"ACCT"==n?(e("#Error_FrmAcctNo").text(e.i18n.t("validation.sadad.dailylimit")),e("#Error_FrmAcctNo").show()):(e("#Error_CreditCardNo").text(e.i18n.t("validation.sadad.dailylimit")),e("#Error_CreditCardNo").show()),hideSpinner(),!1;var D=v.get("srvtype");(""==D||null==D||"null"==D)&&v.set("srvtype",b[9]),v.set("opt_bill_details",b);var C,M,T,V=v.get("custno"),B="KWD",n=b[13];"ACCT"==n?(paymentmodeVal="ACCOUNT",paymethod="ACTDEB",C=b[0],M="",T=""):(paymentmodeVal="CREDITCARD",paymethod="CCARD",C="",M=b[11],T=b[12]);var R="",F="",O=new Array;O[0]=b[10];var L=JSON.stringify(O),k=L.replace(/"/g,"");v.set("strbillerDueDate",k);var q=new Array;q[0]=b[6];var W=JSON.stringify(q),U=W.replace(/"/g,""),Y=new Array;Y[0]=b[1];var j=JSON.stringify(Y),z=j.replace(/"/g,""),H=new Array;H[0]=b[2];var J=v.get("billerId");if("017"!=J){var K,$=H[0],G=JSON.stringify(H),Q=v.get("demon"),X=v.get("demonnamount");if(v.set("servicetype",d),"PREPAID"==d)K=null!=Q&&""!=Q&&void 0!=Q?X:G.replace(/"/g,"");else{var G=e("#idPayAmountPost").val();v.set("idPayAmountPost",G),K=G}}else var $=v.get("idPayAmountPost"),G=v.get("idPayAmountPost"),K="["+G+"]";var Z=v.get("srvtype"),ee="0.00";("undefined"==C||void 0==C)&&(C=""),("undefined"==M||void 0==M)&&(M=""),("undefined"==T||void 0==T)&&(T="");var re=getDeviceId(),te=paymentmodeVal+""+C+M+T+paymethod+k+U+z+K+ee+re,ae=CryptoJS.MD5(te);te=ae+"",showSpinner();var oe=this,ie=function(e){"ACCT"==n?"PREPAID"==d?(hideSpinner(),t.history.navigate("#/oneTimePaymentConfirm")):(hideSpinner(),t.history.navigate("#/oneTimePaymentConfirm")):"PREPAID"==d?(hideSpinner(),t.history.navigate("#/oneTimePaymentConfirm")):(hideSpinner(),t.history.navigate("#/oneTimePaymentConfirm"))},de="POST";"PREPAID"==d&&(de="RCHG","[001]"==U&&(U="[149]")),v.set("pmttype",de);var ne=v.get("iqamaID"),se=v.get("selectedIdProof");v.set("strbillerCode",U);var le=function(e){oe.errorresponse()};oe.collection=new l([],{});var ue=(new Date).getTime();oe.collection.fetch({data:e.param({appchecksum:te,custno:V,fromcurrname:B,paymentmode:paymentmodeVal,processdate:R,paymethod:paymethod,hidduedate:k,hidbillercode:U,hidbillername:z,hidpayamount:K,hidservicetype:Z,currentdate:F,transfee:ee,custaccountno:C,creditcardnumber:M,creditcardacctnumber:T,totalAmount:$,otpModule:"one_time_payment",owneridno:ne,hididtypecode:se,billingaccno:z,pmttype:de,requestid:ue}),dataType:"json",type:"POST",timeout:parseInt(v.get("calltimeout")),cache:!1,success:function(e){"0000"==ackStatus?ie(e):le(e)},error:le})},errorresponse:function(){hideSpinner(),t.history.navigate("#/exception")},disposeView:function(e){return t.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return _});
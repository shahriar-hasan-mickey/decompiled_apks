define(["jquery","underscore","Backbone","text!views/sadad/addbillConfirm.tpl"],function(e,n,t,i){var a=new EncryptedLocalStorage("secret"),o=t.View.extend({el:"#container",e1:"#menuwrapper",e2:"#mobcontent",events:{"click #submitConfirm":"submitConfirm","click #back":"back"},initialize:function(){this.on("error",function(e,n){alert(n)})},update:function(){this.addbillOTP()},addbillOTP:function(){hideSpinner(),this.$("#mobcontent").html(n.template(i,{})).i18n()},submitConfirm:function(){t.history.navigate("#/addbillOTP")},back:function(){showSpinner(),this.subview=this.disposeView(new addbills),this.subview.render(),e.mobile.loading("hide"),this.undelegateEvents(),hideSpinner()},otpValidation:function(n){showSpinner(),this.model=new OTPValidationModel({url:"json/"}),this.$(".alert").hide(),t.Validation.bind(this);var i=this.$("form").serializeObject();if(this.model.set(i,{validate:!0})){this.model.clear(),t.Validation.unbind(this);var o=(e("#otp").val(),this),r=function(e){o.addNewBills()},c=function(e){o.errorresponse()};o.collection=new OTPValidateCollections([],{});var s=(new Date).getTime(),d="SMS",l="0",u=e("#otp").val(),b=a.get("custno");o.collection.fetch({data:e.param({opttype:d,refno:l,activationno:u,customerno:b,requestid:s}),dataType:"json",type:"POST",timeout:parseInt(a.get("calltimeout")),cache:!1,success:function(e){"0000"==ackStatus?r(e):c(e)},error:c})}else hideSpinner(),this.$(".alert-error").fadeIn(),n.preventDefault()},addNewBills:function(){var n=this;showSpinner();var t=function(e){n.OtpSuccess()},i=function(e){n.errorresponse()};n.collection=new manageAddConfirmCollections([],{}),timestamp=(new Date).getTime();var o="",r="",c="ACTIVE",s=e("#mobileno").val(),d="",l=e("#nickname").val(),u=e("#comp").val(),b="",h="",p="",m="",f="",v="",w="",y="",S="",k="",T="",V="",g="",O="5";n.collection.fetch({data:e.param({creditcardnumber:o,service:r,beneStatus:c,benAcctno:s,beneficiaryibannumber:d,bennickname:l,benname:u,benaddr1:b,benaddr2:h,benaddr3:p,benbankname:m,hidbankcountrycode:f,benbankaddr1:v,benbankaddr2:w,beneficiarybankaddress3:y,bennationality:S,hidbenbankcountry:k,benbankbic:T,citycode:V,beneficiaryaccountcurrency:g,beneTypeCode:O}),dataType:"json",type:"POST",timeout:parseInt(a.get("sadadcalltimeout")),cache:!1,success:function(e){"0000"==ackStatus?t(e):i(e)},error:i})},OtpSuccess:function(){return hideSpinner(),this.$("#mobcontent").html(n.template(addbillOTPSuccessTemplate)).i18n(),this},errorresponse:function(){hideSpinner(),t.history.navigate("#/exception")},disposeView:function(e){return t.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return o});
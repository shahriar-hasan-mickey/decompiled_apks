define(["jquery","underscore","Backbone","collections/creditcard/manageBeneAddCollections","routers/creditcardrouter","collections/creditcard/creditCardDetailsCollections","text!views/creditcard/manageBeneAdd.tpl","models/validation/activateCreditCardValidationModel"],function(e,t,i,r,n,a,o,c){var s=new EncryptedLocalStorage("secret"),d=i.View.extend({el:"#container",e1:"#menuwrapper",e2:"#mobcontent",events:{"click #validateCardPin":"validateCardandPin"},initialize:function(){},update:function(){var e=this;s.set("currentPage",""),showSpinner(),e.listcompile()},listcompile:function(){hideSpinner(),this.$("#mobcontent").html(t.template(o))},validateCardandPin:function(){e("#secError").hide(),this.model=new c({url:"json/"}),this.$(".alert").hide(),i.Validation.bind(this);var t=this.$("form").serializeObject();if(this.model.set(t,{validate:!0})){this.model.clear(),i.Validation.unbind(this);var r=this,n=function(e){r.showOTP()},o=function(e){r.showErrordiv()},d=function(e){r.showErrordiv()};r.collection=new a([],{}),timestamp=(new Date).getTime();var l=e("#shbcardno").val(),h=Encrypt(l),u=getDeviceId(),v=l+""+u,p=CryptoJS.MD5(v);v=p+"",showSpinner(),r.collection.fetch({data:e.param({appchecksum:v,accountId:h,moduletype:"BENE"}),dataType:"json",type:"POST",timeout:parseInt(s.get("calltimeout")),cache:!1,success:function(t){s.get("errorcode");if("0000"==ackStatus)n(t);else if("9999"==ackStatus){var i=s.get("errordesc");e("#showError").text(i),e("#secError").show(),hideSpinner()}else d(t),hideSpinner()},error:o})}else hideSpinner(),this.$(".alert-error").fadeIn()},securityadvicecheck:function(t){"TWOFA"==e("#securityFlag").val()?this.loginotpverification(t,e("#securityFlag").val()):"TPIN"==e("#securityFlag").val()?this.loginotpverification(t,e("#securityFlag").val()):"SQ"==e("#securityFlag").val()&&this.loginotpverification(t,e("#securityFlag").val())},showOTP:function(){var t=e("#nickname").val(),r=e("#shbcardno").val(),n=Encrypt(r);s.set("creditCardNoActual",r),s.set("creditCardNoMask",n),s.set("creditCardNameActual",t),hideSpinner(),i.history.navigate("#/manageBeneAddConfirm")},showErrordiv:function(){hideSpinner();var t=s.get("errordesc");e("#showError").text(t),e("#secError").show()},errorresponse:function(){hideSpinner(),i.history.navigate("#/exception")},disposeView:function(e){return i.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return d});
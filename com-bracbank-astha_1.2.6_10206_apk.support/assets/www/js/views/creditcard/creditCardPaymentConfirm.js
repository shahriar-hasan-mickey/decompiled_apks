define(["jquery","underscore","Backbone","text!views/creditcard/creditCardPaymentConfirm.tpl","text!views/creditcard/creditCardPaymentsOtpResult.tpl","collections/creditcard/creditCardPaymentsCollections","collections/creditcard/creditCardPaymentCardValidationCollections","collections/common/otpValidateCollections","models/validation/creditCardLimitValidationModel"],function(t,e,a,c,n,o,r,i,s){var m=new EncryptedLocalStorage("secret"),p=a.View.extend({el:"#container",events:{"click #submitOTP":"submitOTP"},initialize:function(){this.on("error",function(t,e){})},update:function(){var t=this;showSpinner();m.get("CCpayfrmActNo"),m.get("CCpaytoActNo"),m.get("ccpayremarks");t.blockccotp()},blockccotp:function(){hideSpinner();var t=m.get("frmaccpaymaskno"),a=m.get("toaccpaymaskno"),n=m.get("CCpayamt"),o=m.get("CCpayconv"),r=o.replace("KWD",""),i=m.get("CCpayexrate"),s=m.get("ccpayremarks"),p=m.get("CCpayfrmActNo"),d=m.get("CCpaytoActNo");m.set("frmaccnt",p),m.set("toaccntnum",d),this.$("#mobcontent").html(e.template(c,{fromacc:p,toacc:d,transAmt:n,payRemarks:s,conamount:r,exchangerate:i,frmaccpaymaskno:t,toaccpaymaskno:a})).i18n()},submitOTP:function(){a.history.navigate("#/creditcardpaymentOTP")},submitOTP11:function(){var e=this,a=function(t){e.submitSuccess()},c=function(t){e.errorresponse()};e.collection=new r([],{});var n,o,i,s,p,d,u,l,y,C,g,f,v,h,k,P,w,T,A;(new Date).getTime();n="KWD",o="KWD",i="",w=m.get("cartpe"),"O"!=w&&(s=m.get("toAcctId")),p=m.get("frmAcctId"),d=m.get("toaccno"),u=m.get("paymentRemarksval"),l=m.get("CCpayamt"),y=m.get("convamtwithoutcomma"),C="creditcardpayments",g=m.get("CashPayAmount"),f=m.get("productName"),v=m.get("patypecode"),h="PAYNOW",k="KWD",P="KWD",T=m.get("time"),A=m.get("toaccnopar");var O=p+m.get("appdynamicToken");O=CryptoJS.SHA512(O)+"",showSpinner(),e.collection.fetch({data:t.param({appDynamicValue:O,otpModule:"card_payment",toCreditCardNumber:A,creditCardType:w,fromaccountId:p,toaccountId:s,remarks:u,transtype:h,paymentType:v,salt:T,validtype:"Posting",paydate:i,access_token:m.get("access_token"),transamount:l,transcurrency:P}),dataType:"json",type:"POST",timeout:parseInt(m.get("calltimeout")),cache:!1,success:function(t){m.get("errorcode");"0000"==ackStatus?a(t):c(t)},error:c})},submitSuccess:function(){m.set("CCpayOTPfrmActNo",""),m.set("CCpayOTPtoActNo","");var e=t("#from").val(),c=t("#to").val();t("#transamt").val(),t("#payremarks").text(),t("#convertedamt").val(),t("#exrate").text();m.set("CCpayOTPfrmActNo",e),m.set("CCpayOTPtoActNo",c),a.history.navigate("#/creditcardpaymentOTP")},errorresponse:function(){a.history.navigate("#/exception"),hideSpinner()},disposeView:function(t){return a.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=t,this.currentView.delegateEvents(),this.currentView}});return p});
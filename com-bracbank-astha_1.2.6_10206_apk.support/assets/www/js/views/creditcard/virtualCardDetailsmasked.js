define(["jquery","underscore","Backbone","routers/creditcardrouter","routers/requestrouter","collections/creditcard/creditCardvcccalculatorCollections","text!views/creditcard/virtualCardDetailsmasked.tpl","libs/swiper/jquery.flip.min","views/errors/exception"],function(e,t,i,r,n,c,a,o,s){var d=new EncryptedLocalStorage("secret"),u=i.View.extend({el:"#container",e1:"#menuwrapper",e2:"#mobcontent",events:{"change #fromactno":"details","click #editname":"savenickname","click #updatebtn":"updatebtn","click #increaselimit":"increaselimit","click #paynow":"paynow","click #addfund":"AddFund"},initialize:function(){new n},update:function(){d.set("currentPage",""),d.set("virtualmaskflag",""),showSpinner();var t=this;t.listcompile();var i=function(e){t.listcompile()},r=function(e){t.listcompile()},n=d.get("tocreditcard"),a=d.get("indx"),o=n[a].accountNumber;o=DEcryptusertime(o);var s=n[a].creditCardNoMasked,u=n[a].expiryDate,l=u.substring(0,4),p=u.substring(5,7),m=(u.substring(8,10),p+"/"+l),h=function(e){t.errorresponse()};t.collection=new c([],{});var v=(new Date).getTime();t.collection.fetch({data:e.param({hidmaskedcardnumber:s,hidcardnumber:o,hidexpirydate:m,hidexpirydateformat:"1",hidcvvtype:"1",hidservicecode:"",hidcardproduct:"MC",hidkeyversion:"01",requestid:v}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(d.get("calltimeout")),success:function(e){var t=d.get("errorcode");"0000"==ackStatus?"0000"==t?i(e):r(e):null!=t&&"MSI-ES-1001"!=t?i(e):h(e)},error:h})},listcompile:function(){hideSpinner();var i=d.get("cccardacctno");i=DEcryptusertime(i),this.$("#mobcontent").html(t.template(a,{ccactnn:i})),e(".amtformatter").formatamount()},AddFund:function(){showSpinner();e("#ccnum").val();i.history.navigate("#/virtualCardOtp/0")},errorresponse:function(){hideSpinner(),i.history.navigate("#/exception")},disposeView:function(e){return i.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return u});
define(["jquery","underscore","Backbone","collections/creditcard/manageBeneEditCollections","routers/creditcardrouter","text!views/creditcard/manageBeneEdit.tpl","text!views/creditcard/manageBeneEditConfirm.tpl","models/validation/activateCreditCardValidationModel"],function(e,t,i,n,r,a,o,c){var d=new EncryptedLocalStorage("secret"),s=i.View.extend({el:"#container",e1:"#menuwrapper",e2:"#mobcontent",events:{"click #validateCardPin":"showOTP"},initialize:function(){},update:function(e,t,i,n){var r=this;showSpinner(),d.set("currentPage","");var a=d.get("crediteditno"),o=d.get("clracctNumber");d.set("CCEditBeneCode",t),d.set("CCEditBeneActno",a),r.listcompile(e,t,a,i,n,o)},listcompile:function(e,i,n,r,o,c){hideSpinner(),this.$("#mobcontent").html(t.template(a,{card:e,nickname:r,benecode:i,benactno:n})).i18n()},errorresponse:function(){hideSpinner(),i.history.navigate("#/exception")},showOTP:function(){d.set("managebeneCCEditCardNo",""),this.model=new c({url:"json/"}),this.$(".alert").hide(),i.Validation.bind(this);var t=this.$("form").serializeObject();if(this.model.set(t,{validate:!0})){this.model.clear(),i.Validation.unbind(this);var n=e("#nickname").val(),r=e("#ccnoactno").val(),a=e("#ccnobenecodeupdate").val(),o=e("#card").val();d.set("nickname",n),d.set("cardnum",o),d.set("managebeneCCEditCardNo",r),i.history.navigate("#/manageBeneEditConfirm/"+n+"/"+o+"/"+a)}else this.$(".alert-error").fadeIn(),hideSpinner()},disposeView:function(e){return i.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return s});
define(["jquery","underscore","Backbone","collections/creditcard/ccusagectrlCreditCardCtrlModifyCollections","text!views/creditcard/creditCardusagecontrolrequestresult.tpl"],function(e,t,r,i,n){var s=new EncryptedLocalStorage("secret"),c=r.View.extend({el:"#mobcontent",events:{"click #postingrequest":"doanotherrequest"},initialize:function(){},render:function(){s.set("promoid",""),hideSpinner(),s.set("currentPage","transferConfirm");var t=this;timestamp=(new Date).getTime();var r=function(e){t.modifiedlimitcompile()},n=function(e){t.errorresponse()};t.collection=new i([],{}),showSpinner();var c=s.get("creditcardcontrols"),a=[],o=[],p=[],l=[],d=[],u=[],g=[],h=[],f=[],m=[],y=[],S=[],O=[],v=[],J=[],N=[];c.forEach(function(i,C){var k=getDeviceId(),D=i.CreditCardNumber,q=i.localflagval,w=i.interflagval,b=i.ecomflagval,T=(new Date).getTime(),M=i.custartdate,x=M.split("/")[0],j=M.split("/")[1],E=M.split("/")[2],I=E+j+x,P=i.cuenddate,z=P.split("/")[0],B=P.split("/")[1],L=P.split("/")[2],V=L+B+z;a.push(D),o.push(i.CreditCardNumber),p.push(i.ecomind),l.push(i.posind),d.push(i.atmind),u.push(i.motoind),g.push(I),h.push(V),f.push(i.hidmaskcardnumber),J.push(i.hidmaskctrlfetcherrorcode),N.push(i.hidmaskusagestatus),y.push(q),S.push(w),O.push(b),m.push(T);var $=[];$.push(q),$.push(w),$.push(b),v.push($);var A=JSON.stringify(v),F=A.replace(/"/g,""),G=(F.replace(/null/g,""),JSON.stringify(a)),H=(G.replace(/"/g,""),CryptoJS.MD5(G));G=H+"";var K=JSON.stringify(o),Q=JSON.stringify(p),R=JSON.stringify(l),U=JSON.stringify(d),W=JSON.stringify(u),X=JSON.stringify(g),Y=JSON.stringify(h),Z=JSON.stringify(f),_=JSON.stringify(J),ee=JSON.stringify(N),te=JSON.stringify(y),re=JSON.stringify(S),ie=JSON.stringify(O),ne=JSON.stringify(o+""+g+h+k),se=ne.replace(/"/g,""),H=CryptoJS.MD5(se);se=H+"";var ce=(G.replace(/"/g,""),K.replace(/"/g,"")),ae=Q.replace(/"/g,""),oe=R.replace(/"/g,""),pe=U.replace(/"/g,""),le=W.replace(/"/g,""),de=X.replace(/"/g,""),ue=Y.replace(/"/g,""),ge=Z.replace(/"/g,""),he=_.replace(/"/g,""),fe=ee.replace(/"/g,"");te.replace(/"/g,""),re.replace(/"/g,""),ie.replace(/"/g,"");c.length-1==C&&t.collection.fetch({data:e.param({appchecksum:se,hidcreditcardno:ce,hidecomind:ae,hidposind:oe,hidatmind:pe,hidmotoind:le,hidcustartdate:de,hidcuenddate:ue,hidmaskcardnumber:ge,usagecode:he,usagestatus:fe,requestid:T}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(s.get("calltimeout")),success:function(e){"0000"==ackStatus?(s.set("ccusagecontrolmodifyresultDTO",ccusagecontrolmodifyDTO),r(e)):n(e)},error:n})})},modifiedlimitcompile:function(){return hideSpinner(),this.$el.html(t.template(n)).i18n(),this},errorresponse:function(){hideSpinner(),r.history.navigate("#/exception")},doanotherrequest:function(t){t.preventDefault(),e("#servicerequestMnu").trigger("click")}});return c});
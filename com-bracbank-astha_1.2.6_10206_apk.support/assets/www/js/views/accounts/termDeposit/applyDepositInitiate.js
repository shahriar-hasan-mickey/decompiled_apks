define(["jquery","underscore","Backbone","text!views/accounts/termDeposit/applyDepositInitiate.tpl","collections/accounts/termDeposit/getDepositNomineeDetailsCollections","collections/accounts/termDeposit/getMaturityAmountDetailsCollections","collections/accounts/termDeposit/createFDAccountCollections","collections/accounts/termDeposit/getTenuresDetailsCollections","collections/accounts/termDeposit/getProductDetailsCollections","collections/transfer/getAuthModeCollections","collections/wealth/otpPostLoginGenerationCollections","collections/wealth/otpPostLoginVerificationCollections","collections/transfer/getTransactionLimitCollections","collections/transfer/getAccountBalanceCollections","views/errors/exception"],function(e,t,o,a,n,r,i,s,c,l,p,d,u,m,f){var h=null,y=!1,g=new EncryptedLocalStorage("secret"),v=o.View.extend({el:"#container",events:{"click #backButn":"gotoPreviousPage","click #applydepositcancel":"gotoPreviousPage","click #applydepositverify":"applydepositVerify","change #amt":"resetValue","change #FDRSelectAcc":"FDRSelectAccOption","change #FDRProductTypeSelect":"FDRProductTypeSelect","change #FDRTenorSelect":"FDRTenorSelect","change #Debit":"renewalTypeOptionShow","change #Lost":"renewalTypeOptionHide","change #renewalTypeOption":"credAccShow","click #applydepositinitiatecancel":"applydepositinitiatecancel","blur #amt":"amtvalidation","click #applydepositconfirm":"depositVerifySuccessPopUp","click #fd_close_btn":"revokeDepositOTPSpinner","click #fd_cancel_btn":"revokeDepositOTPSpinner","click #addDepositTandCPopup":"addDepositOpenTandCPopup"},initialize:function(){},render:function(){h=null;var o=this;e("html").removeClass().addClass("app fntzoom"),o.$el.html(t.template(a)),e("#nominee_Details").html(""),e("#renewalType").css({display:"block"}),e("#credAccount").css({display:"none"}),e("#roitext").css({display:"none"}),o.getFDAuthMode(),g.set("transamount",""),g.set("nomineeDetailsList",""),g.set("DepositAccID",""),g.set("DepositAccNumber",""),g.set("selectAccType",""),g.set("productTypeID",""),g.set("productTypeValue",""),g.set("TenorSelect",""),g.set("prodSubHeadCode",""),g.set("prodTblCode",""),g.set("renewalopt",""),g.set("renewaloptselect","yes"),g.set("TenorSelectVal",""),g.set("depositminamt",""),e("#nominee_Relation").css({display:"none"}),g.set("depositmaxamt",""),e("#FDRProductTypeSelect").html('<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.sltprodtype")+"</option>"),e("#FDRTenorSelect").html('<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.slttenure")+"</option>"),e("#applydepositverify").prop("disabled",!1).css({"background-color":"#0072bc"}),e("#FDRProductTypeSelect").prop("disabled",!1),e("#availBalDiv").hide(),g.set("depositmultiplesamt","")},FDRSelectAccOption:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=e("#FDRSelectAcc option:selected").val(),a=e("#FDRSelectAcc option:selected").text(),r=e("#FDRSelectAcc option:selected").attr("data"),i=e("#FDRSelectAcc option:selected").attr("accstatus");g.set("DepositAccID",o),g.set("DepositAccNumber",a),g.set("selectAccType","CASA"),g.set("depoAccCurency",r),e("#nomineeError").html(""),e("#accError").html("");var s=this;e("#transAmountError").html(""),e("#credAccSelt").val(o).change(),e("#amt").val(""),g.set("productTypeID",""),g.set("productTypeValue",""),g.set("prodSubHeadCode",""),g.set("prodTblCode",""),e("#availBalDiv").hide(),e("#availbalance").html(""),g.set("depositminamt",""),g.set("renewalopt",""),g.set("renewaloptselect","yes"),e("#renewalTypeOption ").prop("selectedIndex",0),e("#renewalError").html(""),e("#credAccount").css({display:"none"}),g.set("nomineeDetailsList",""),e("#nominee_Details").html(""),e("#nominee_Relation").css({display:"none"}),e("#tc_check").prop("checked",!1);var c=function(t){hideSpinner();var o=g.get("nomineeDetailsList");if(!isNull(o)&&o.length>0){e("#nominee_Details").html("");var a='<li class="list-group-item"><h4>Nominee</h4><li>';e.each(o,function(e,t){a+='<li class="list-group-item"><p class="small">'+t.nomineeName+"</span></p></li>"}),e("#nominee_Details").html(a),e("#nominee_Relation").css({display:"block"}),e("#applydepositverify").prop("disabled",!1).css({"background-color":"#0072bc"})}else e("#nominee_Details").html(""),e("#nominee_Relation").css({display:"none"}),e("#applydepositverify").prop("disabled",!0).css({"background-color":"#337ab7"}),isNull(o)&&0==o.length?e("#nomineeError").html(e.i18n.t("app.product.termdeposits.nominedetailerr")):e("#nomineeError").html(e.i18n.t("app.product.termdeposits.nominedoberror"));s.getAccountBalance()},l=function(t){e("#nominee_Details").html(""),e("#nominee_Relation").css({display:"none"}),e("#nomineeError").html(e.i18n.t("app.product.termdeposits.nominedetailerr")),e("#applydepositverify").prop("disabled",!0).css({"background-color":"#337ab7"})};s.collection=new n,isNull(o)||"A"!=i?(isError=!0,e("#availBalDiv").hide(),e("#availbalance").html(""),e("#accError").html(e.i18n.t("app.product.termdeposits.fdaccproderr")),e("#FDRProductTypeSelect").html('<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.sltprodtype")+"</option>"),e("#FDRTenorSelect").html('<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.slttenure")+"</option>"),e("#fdrmaturitAmt").val(""),e("#roiValue").html(""),g.set("TenorSelect",""),e("#roitext").css({display:"none"}),e("#tpamt").val(""),e("#amt").val(""),g.set("nomineeDetailsList",""),e("#nominee_Details").html(""),e("#nominee_Relation").css({display:"none"}),e("#tc_check").prop("checked",!1)):isNull(o)?(isError=!0,e("#accError").html(e.i18n.t("app.product.termdeposits.accerr"))):(showSpinner(),s.collection.fetch({data:e.param({access_token:g.get("access_token"),acctid:o}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?c(e):l(e)},error:l}))},getMaturityAmount:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=this,a=function(t){hideSpinner(),e("#fdrmaturitAmt").val(g.get("maturityAmount")),isNull(g.get("interestRate"))?e("#roitext").css({display:"none"}):(e("#roitext").css({display:"block"}),e("#roiValue").html(g.get("interestRate")))},n=function(e){hideSpinner(),o.errorresponse()};showSpinner(),o.collection=new r,o.collection.fetch({data:e.param({access_token:g.get("access_token"),producttypeid:g.get("productTypeID"),tenure:g.get("TenorSelect"),amount:e("#amt").val().replace(/,/g,""),productype:g.get("selectDepositType"),accountid:g.get("DepositAccID")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?a(e):n(e)},error:n})},createFDAccount:function(t){"object"==typeof t&&t.stopImmediatePropagation(),e("#verify .close").trigger("click");var a=this,n=g.get("nomineeDetailsList"),r=n[0].nomineeAdrressList,s=function(e){hideSpinner(),o.history.navigate("#/applyDepositConfirm")},c=function(e){hideSpinner(),a.errorresponse()};showSpinner(),a.collection=new i,a.collection.fetch({data:e.param({access_token:g.get("access_token"),accountid:g.get("DepositAccID"),producttype:g.get("selectDepositType"),productcode:g.get("productTypeID"),tenure:g.get("TenorSelect"),acctCategory:g.get("selectAccType"),transactionamount:g.get("transamount"),renewalopt:g.get("renewalopt"),creditaccountid:g.get("DepositAccID"),nomineeaddress:r[0].nomineeAddressTypeAddress1,regnum:n[0].regNum,nomineereltype:n[0].nomineeRelType,nomineename:n[0].nomineeName,nomineecity:r[0].nomineeAddressTypeCity,nomineestateprov:r[0].nomineeAddressTypeStateProv,nomineepostalcode:r[0].nomineeAddressTypePostalCode,nomineecountry:r[0].nomineeAddressTypeCountry,nomineeminorflg:n[0].nomineeMinorFlg,nomineebirthdt:n[0].nomineeBirthDt,nomineepercentvalue:n[0].nomineePercentValue,tdGenLedgerSubHead:g.get("prodSubHeadCode"),intTblCode:g.get("prodTblCode"),fromActName:g.get("profileName"),depsubtype:g.get("productTypeValue"),renewaltype:g.get("renewalopt"),authMode:g.get("authmode")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?s(e):c(e)},error:c})},amtvalidation:function(t){"object"==typeof t&&t.stopImmediatePropagation(),e("#transAmountError").html(""),e("#FDRTenorSelect").html('<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.slttenure")+"</option>"),y=!1;var o=this,a=parseFloat(g.get("depofromAcntAvailBal")),n=e("#amt").val().replace(/,/g,""),r=(parseFloat(g.get("depositminamt")),parseFloat(g.get("dailyAvailableLimit")));isNull(g.get("depofromAcntAvailBal"))&&(a=0),isNull(n)?(isError=!0,y=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.transamterror"))):!isNull(n)&&parseFloat(n)>a?(isError=!0,y=!0,e("#transAmountError").html(e.i18n.t("validation.transfer.nobal"))):!isNull(n)&&parseFloat(n)>r&&(isError=!0,y=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.dailylimit")+checkAmount(e.formatNumber(r,{format:"#,###",locale:"us"})))),o.resetValue(t),1==y||isNull(g.get("productTypeID"))||o.getTenures(t)},applydepositVerify:function(e){"object"==typeof e&&e.stopImmediatePropagation();var t=this,o=g.get("nomineeDetailsList");!isNull(g.get("DepositAccID"))&&!isNull(o)&&o.length>0?t.PaymentValidation():isNull(g.get("DepositAccID"))&&t.PaymentValidation()},applydepositCancel:function(e){"object"==typeof e&&e.stopImmediatePropagation(),o.history.navigate("#/applyForDeposit")},renewalTypeOptionShow:function(t){"object"==typeof t&&t.stopImmediatePropagation(),e("#renewalType").css({display:"block"}),g.set("renewalopt",""),g.set("renewaloptselect","yes"),e("#renewalTypeOption ").prop("selectedIndex",0),e("#renewalError").html("")},renewalTypeOptionHide:function(t){"object"==typeof t&&t.stopImmediatePropagation(),e("#renewalType").css({display:"none"}),g.set("renewalopt",""),g.set("renewaloptselect","no"),e("#renewalTypeOption ").prop("selectedIndex",0),e("#renewalError").html(""),e("#credAccount").css({display:"none"})},applydepositinitiatecancel:function(e){"object"==typeof e&&e.stopImmediatePropagation(),o.history.navigate("#/applyDepositInitiate")},credAccShow:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=e("#renewalTypeOption").val();"P"==o?e("#credAccount").css({display:"block"}):e("#credAccount").css({display:"none"}),g.set("renewalopt",o),e("#renewalError").html("")},FDRProductTypeSelect:function(t){"object"==typeof t&&t.stopImmediatePropagation(),e("#prodTypeError").html(""),e("#transAmountError").html("");var o=this,a=e("#FDRProductTypeSelect option:selected").val(),n=e("#FDRProductTypeSelect option:selected").text(),r=e("#FDRProductTypeSelect option:selected").attr("subheadcode"),i=e("#FDRProductTypeSelect option:selected").attr("tblcode");g.set("productTypeID",a),g.set("productTypeValue",n),g.set("prodSubHeadCode",r),g.set("prodTblCode",i),isNull(a)&&(isError=!0,e("#prodTypeError").html(e.i18n.t("app.product.termdeposits.seltprodtypeerr"))),o.resetValue(t)},getTenures:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=this,a=function(t){hideSpinner();var o='<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.slttenure")+"</option>",a=g.get("tenorList");isNull(a)?e("#FDRTenorSelect").html(o):(e.each(a,function(e,t){var a=t.description;o+="<option value="+t.code+" id="+e+" data="+t.description+" subheadcode="+t.tdGenLedgerSubHeadCode+" tblcode="+t.intTblCode+" minDepositAmount ="+t.minDepositAmount+" multiples="+t.multiples+" maxSlabAmount ="+t.maxSlabAmount+" >"+a+"</option>"}),e("#FDRTenorSelect").html(o),e("#FDRTenorSelect").prop("selectedIndex",0))},n=function(e){hideSpinner(),o.errorresponse()};o.collection=new s,o.collection.fetch({data:e.param({access_token:g.get("access_token"),accountid:g.get("DepositAccID"),producttype:g.get("selectProductType"),producttypeid:g.get("productTypeID"),amount:e("#amt").val().replace(/,/g,"")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?a(e):n(e)},error:n})},getProductType:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=this,a=function(t){hideSpinner();var o=g.get("productTypeList");if(!isNull(o)&&o.length>0){var a='<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.sltprodtype")+"</option>";e.each(o,function(e,t){a+="<option value="+t.code+" id="+e+" data="+t.description+" subheadcode="+t.tdGenLedgerSubHeadCode+" tblcode="+t.intTblCode+" >"+t.description+"</option>"}),e("#FDRProductTypeSelect").html(a),e("#FDRProductTypeSelect").prop("selectedIndex",0),e("#FDRProductTypeSelect").prop("disabled",!1)}else isError=!0,e("#availBalDiv").hide(),e("#availbalance").html(""),e("#accError").html(e.i18n.t("app.product.termdeposits.fdaccproderr")),e("#FDRProductTypeSelect").html('<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.sltprodtype")+"</option>"),e("#FDRProductTypeSelect").prop("disabled",!0),e("#FDRTenorSelect").html('<option value=""  selected="selected">'+e.i18n.t("app.product.termdeposits.slttenure")+"</option>")},n=function(e){hideSpinner(),o.errorresponse()};showSpinner(),o.collection=new c,o.collection.fetch({data:e.param({access_token:g.get("access_token"),accountid:g.get("DepositAccID"),producttype:g.get("selectProductType")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?a(e):n(e)},error:n})},FDRTenorSelect:function(t){"object"==typeof t&&t.stopImmediatePropagation(),e("#tenorError").html("");var o=this,a=e("#FDRTenorSelect option:selected").val(),n=e("#FDRTenorSelect option:selected").text(),r=e("#amt").val().replace(/,/g,""),i=parseFloat(g.get("dailyAvailableLimit")),s=e("#FDRTenorSelect option:selected").attr("maxSlabAmount").replace(/,/g,""),c=e("#FDRTenorSelect option:selected").attr("mindepositamount").replace(/,/g,"");s=checkAmount(e.formatNumber(s,{format:"####",locale:"us"})),g.set("TenorSelect",a),g.set("TenorSelectVal",n),g.get("depositminamt",c),g.set("depositmaxamt",s),0==y&&(!isNull(c)&&parseFloat(r)<parseFloat(c)?(isError=!0,y=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.transamtmindepoerr")+checkAmount(e.formatNumber(c,{format:"#,###",locale:"us"})))):s>i?!isNull(r)&&parseFloat(r)>i&&(isError=!0,y=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.dailylimit")+checkAmount(e.formatNumber(i,{format:"#,###",locale:"us"})))):!isNull(r)&&parseFloat(r)>parseFloat(s)&&(isError=!0,y=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.availbalanceerror")+checkAmount(e.formatNumber(s,{format:"#,###",locale:"us"}))))),isNull(g.get("productTypeID"))||isNull(a)||isNull(r)||1==y||o.getMaturityAmount(t),isNull(a)&&(e("#fdrmaturitAmt").val(""),e("#roiValue").html(""),e("#roitext").css({display:"none"}),e("#tpamt").val(""),g.set("TenorSelect",""))},resetValue:function(t){"object"==typeof t&&t.stopImmediatePropagation(),e("#FDRTenorSelect").prop("selectedIndex",0),e("#fdrmaturitAmt").val(""),e("#roiValue").html(""),g.set("TenorSelect",""),e("#roitext").css({display:"none"}),e("#tpamt").val("")},numberOnly:function(e){"object"==typeof e&&e.stopImmediatePropagation();var t=window.event?e.keyCode:e.which;return 8===e.keyCode||46===e.keyCode?!0:48>t||t>57?!1:!0},PaymentValidation:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=this,a=!1;e("#tcError").html(""),e("#transAmountError").html(""),e("#accError").html(""),e("#prodTypeError").html(""),e("#tenorError").html(""),e("#renewalError").html("");var n=e("#amt").val().replace(/,/g,""),r=e("#FDRTenorSelect option:selected").val(),i=e("#FDRProductTypeSelect option:selected").val(),s=e("#FDRSelectAcc option:selected").val(),c=(g.get("accountCurrency"),g.get("depoAccCurency"),parseFloat(g.get("depofromAcntAvailBal"))),l=parseFloat(g.get("depositminamt")),p=parseFloat(g.get("dailyAvailableLimit")),d=parseFloat(g.get("depositmaxamt"));isNull(g.get("depofromAcntAvailBal"))&&(c=0),isNull(n)?(a=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.transamterror"))):!isNull(n)&&parseFloat(n)>c?(a=!0,e("#transAmountError").html(e.i18n.t("validation.transfer.nobal"))):!isNull(l)&&parseFloat(n)<parseFloat(l)?(a=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.transamtmindepoerr")+checkAmount(e.formatNumber(l,{format:"#,###",locale:"us"})))):d>p?!isNull(n)&&parseFloat(n)>p&&(a=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.dailylimit")+checkAmount(e.formatNumber(p,{format:"#,###",locale:"us"})))):!isNull(n)&&parseFloat(n)>d&&(a=!0,e("#transAmountError").html(e.i18n.t("app.product.termdeposits.availbalanceerror")+checkAmount(e.formatNumber(d,{format:"#,###",locale:"us"})))),isNull(s)&&(a=!0,e("#accError").html(e.i18n.t("app.product.termdeposits.accerr"))),isNull(i)&&(a=!0,e("#prodTypeError").html(e.i18n.t("app.product.termdeposits.seltprodtypeerr"))),isNull(r)&&(a=!0,e("#tenorError").html(e.i18n.t("app.product.termdeposits.selttenorerror"))),"yes"==g.get("renewaloptselect")&&isNull(g.get("renewalopt"))&&(a=!0,e("#renewalError").html(e.i18n.t("app.product.termdeposits.seltrenewopterr"))),e("#tc_check").is(":checked")||(a=!0,e("#tcError").html(e.i18n.t("app.product.termdeposits.termconerr"))),a||(g.set("transamount",n),o.validateFDCard())},getAccountBalance:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=g.get("selectAccType");"PC"==o?g.set("typeOfTransfer","PC"):"DC"==o?g.set("typeOfTransfer","DC"):"CC"==o?g.set("typeOfTransfer","CC"):"CASA"==o&&g.set("typeOfTransfer","CASA");var a=this,n=function(n){hideSpinner(),e("#accError").html(""),e("#availBalDiv").show(),isValidAccount=!1;var r,i,s=g.get("availableBalance"),c=parseFloat(s.slice(0,-2)),l=g.get("accountCurrency");"DC"==o?(r=checkAmount(e.formatNumber(c,{format:"#,###.00",locale:"us"})),i=r+" "+l,g.set("depofromAcntAvailBal",c)):"CASA"==o?(r=checkAmount(e.formatNumber(c,{format:"#,###.00",locale:"us"})),i=r+" "+l,g.set("depofromAcntAvailBal",c)):"PC"==o?(r=checkAmount(e.formatNumber(s,{format:"#,###.00",locale:"us"})),i=r+" "+l,g.set("depofromAcntAvailBal",s)):"CC"==o&&(r=checkAmount(e.formatNumber(s,{format:"#,###.00",locale:"us"})),i=r+" "+l,g.set("depofromAcntAvailBal",s)),e("#availbalance").html(i),a.getProductType(t),a.resetValue(t)},r=function(e){a.errorresponse()};showSpinner(),a.collection=new m,a.collection.fetch({data:e.param({access_token:g.get("access_token"),accountId:g.get("DepositAccID"),accountType:g.get("selectAccType"),beneficiaryInstructionId:null}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?n(e):r(e)},error:r})},getFDAuthMode:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=this;g.set("IsAuthMode","false"),e("#fd_auth_mode").html("");var a=e("#amt").val().replace(/,/g,""),n=function(e){hideSpinner();var t=g.get("securitySettingList");!isNull(t)&&t.length>0?g.set("IsAuthMode","true"):(g.set("alertType",null),g.set("IsAuthMode","false")),o.populateAuthMode()},r=function(t){hideSpinner(),o.populateAuthMode(),e("#transAmountError").html(g.get("errordesc"))};showSpinner(),o.collection=new l,o.collection.fetch({data:e.param({access_token:g.get("access_token"),transactionAmount:a,tenantServiceCode:"ADD_DEPOSIT"}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?n(e):r(e)},error:r}),o.getTransLimitView()},populateAuthMode:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o="",a="",n=g.get("securitySettingList"),r="<label for='username'>"+e.i18n.t("app.transfer.managebeneficiary.selectauthorisationmode")+"</label>";r+="<div class='custRadio_pass'>",!isNull(n)&&n.length>0?(e("#within_onetime_transferDiv").html(""),e.each(n,function(t,n){"SMS"==n?(o="sms",a=e.i18n.t("app.transfer.managebeneficiary.sms")):"EMAIL"==n?(o="mail",a=e.i18n.t("app.transfer.managebeneficiary.mail")):"TOKEN"==n?(o="fScan",a=e.i18n.t("app.transfer.managebeneficiary.token")):"ESIGN"==n&&(o="esign",a=e.i18n.t("app.transfer.managebeneficiary.esign")),r+='<div class="box"><div class="radio"><label>',r+=0==t?'<input type="radio" name="fd_payment_authmode" id="optionsRadios'+t+'" value="'+n+'" checked>':'<input type="radio" name="fd_payment_authmode" id="optionsRadios'+t+'" value="'+n+'">',r+='<div class="row bg"><div class="col-xs-12 p0"><span class="menu_icon ico-xs '+o+'"></span><span class="small">'+a+"</span></div></div></label></div></div>"}),e("#fd_auth_mode").html(r)):e("#fd_auth_mode").html("")},depositVerifySuccessPopUp:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o="",a="";e("#fd_otpNullError").html(""),e("#fd_otpNullErrorDiv").hide();var n=e("#fd_otp1").attr("data"),r=e("#fd_otp2").attr("data"),i=e("#fd_otp3").attr("data"),s=e("#fd_otp4").attr("data"),c=e("#fd_otp5").attr("data"),l=e("#fd_otp6").attr("data");if(isNull(n)||isNull(r)||isNull(i)||isNull(s)||isNull(c)||isNull(l))return e("#fd_otpNullErrorDiv").show(),void e("#fd_otpNullError").html(e.i18n.t("validation.newregistration.otpnotnull"));var p=n+r+i+s+c+l,u=e("input[name='fd_payment_authmode']:checked").val();"SMS"==u?(a=g.get("mobileNo"),o=null):"EMAIL"==u&&(a=null,o=g.get("emailId"));var m=this,f=function(o){hideSpinner(),m.revokeDepositOTPSpinner(),e("#verify .close").trigger("click"),m.createFDAccount(t)},h=function(t){hideSpinner(),isNull(g.get("errordesc"))||(e("#fd_otpNullErrorDiv").show(),e("#fd_otpNullError").html(g.get("errordesc")))},m=this;showSpinner(),m.collection=new d;getDeviceId(),(new Date).getTime();m.collection.fetch({data:e.param({access_token:g.get("access_token"),transactionType:"ADD_DEPOSIT",activationno:p,uniqueId:g.get("otpCode"),twoFAType:g.get("alertType")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?f(e):h(e)},error:h})},validateFDCard:function(t){"object"==typeof t&&(t.preventDefault(),t.stopImmediatePropagation());var o=this;if("false"==g.get("IsAuthMode"))return void o.createFDAccount();var a=e("input[name='fd_payment_authmode']:checked").val();g.set("authmode",a),"SMS"==a||"EMAIL"==a||"ESIGN"==a?o.dpsValidateCardPin("N"):"TOKEN"==a&&(g.set("otpCode",""),g.set("alertType",a),e("#verify").modal("show"),e("#fd_otp1, #fd_otp2, #fd_otp3, #fd_otp4, #fd_otp5, #fd_otp6").removeAttr("data"),"TOKEN"==g.get("alertType")&&(e("#fd_titleAuth").html(e.i18n.t("app.registration.opthelptokentext")),e("#fd_myModalLabel").html(e.i18n.t("app.registration.otptokenheadertext")),e("#fd_challengeText").html(""),e("#OTPcontainer1").hide(),e("#fd_resend_btn").hide()),e("#fd_otpNullError").html(""),e("#fd_otpNullErrorDiv").hide(),e(".inputs").on("input",function(t){t.stopImmediatePropagation();var o=t.currentTarget.id,a=e("#"+o).val();e("#"+o).attr("data",a),e("#"+o).val(a.replace(/[^\*]/,"."))}),e("#fd_otp1, #fd_otp2, #fd_otp3, #fd_otp4, #fd_otp5, #fd_otp6").val(""))},dpsValidateCardPin:function(t){e(".otp_msg_txt").html("");var o=e("input[name='fd_payment_authmode']:checked").val();g.set("alertType",o);var a=this,n=function(o){hideSpinner(),"Y"==t&&(e("#OTPcontainer1").slideDown("slow"),h.set(1),h.animate(0,function(){e("#OTPcontainer1").slideUp("slow")})),e("#verify").modal("show"),e("#fd_otp1, #fd_otp2, #fd_otp3, #fd_otp4, #fd_otp5, #fd_otp6").removeAttr("data"),"SMS"==g.get("alertType")?(e("#fd_titleAuth").html(e.i18n.t("app.registration.opthelptext")+" "+maskMobile(g.get("contactNumber"))),e("#fd_myModalLabel").html(e.i18n.t("app.transferss.verfici")),e("#fd_challengeText").html(""),e("#OTPcontainer1").show(),e("#fd_resend_btn").show()):"EMAIL"==g.get("alertType")?(e("#fd_titleAuth").html(e.i18n.t("app.registration.opthelpemailtext")+" "+maskEmailID(g.get("emailId"))),e("#fd_myModalLabel").html(e.i18n.t("app.transferss.verfici")),e("#fd_challengeText").html(""),e("#OTPcontainer1").show(),e("#fd_resend_btn").show()):"ESIGN"==g.get("alertType")&&(e("#fd_titleAuth").html(e.i18n.t("app.registration.otphelpesigntext")),e("#fd_myModalLabel").html(e.i18n.t("app.transferss.verfici")),e("#fd_challengeText").html(e.i18n.t("app.transferss.genratedTocn")+" "+g.get("otpCode")),e("#OTPcontainer1").hide(),e("#fd_resend_btn").hide()),setTimeout(function(){e("#fd_otp1").focus()},500),e("#fd_otpNullError").html(""),e("#fd_otpNullErrorDiv").hide(),e(".inputs").on("input",function(t){t.stopImmediatePropagation();var o=t.currentTarget.id,a=e("#"+o).val();e("#"+o).attr("data",a),e("#"+o).val(a.replace(/[^\*]/,"."))}),e("#fd_otp1, #fd_otp2, #fd_otp3, #fd_otp4, #fd_otp5, #fd_otp6").val(""),("SMS"==g.get("alertType")||"EMAIL"==g.get("alertType"))&&a.invokeOTPSpinner()},r=function(e){a.errorresponse()},a=this;showSpinner(),a.collection=new p;getDeviceId(),(new Date).getTime();a.collection.fetch({data:e.param({access_token:g.get("access_token"),transactionType:"ADD_DEPOSIT",resendflag:t,authMode:g.get("alertType")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?n(e):r(e)},error:r})},invokeOTPSpinner:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=this;return e("#fd_resend_btn").hide(),e("#OTPcontainer1").show(),e("#fd_otp1, #fd_otp2, #fd_otp3, #fd_otp4, #fd_otp5, #fd_otp6").val(""),null!=h?(h.set(1),void h.animate(0,function(){e("#OTPcontainer1").slideUp("slow")})):(h=new ProgressBar.Circle(OTPcontainer1,{color:"#333",strokeWidth:8,trailWidth:8,easing:"linear",duration:6e4*parseInt(g.get("otpExpiryPeriod")),text:{autoStyleContainer:!1},from:{color:"#ec5f59",width:8},to:{color:"#ec5f59",width:8},step:function(t,o){o.path.setAttribute("stroke",t.color),o.path.setAttribute("stroke-width",t.width);var a=Math.round(o.value()*(60*g.get("otpExpiryPeriod")));"0"==a?(o.setText(""),e("#fd_resend_btn").show()):(e("#fd_resend_btn").hide(),o.setText(a+"s"))}}),h.text.style.fontFamily='"Raleway", Helvetica, sans-serif',h.text.style.fontSize="12px",h.text.style.fontWeight="bold",h.set(1),h.animate(0,function(){e("#OTPcontainer1").slideUp("slow")}),void e("#fd_resend_btn").click(function(){o.dpsValidateCardPin("Y")}))},revokeDepositOTPSpinner:function(){null!=h&&h.stop()},getTransLimitView:function(t){"object"==typeof t&&t.stopImmediatePropagation();var o=this,a=function(e){hideSpinner()},n=function(e){o.errorresponse()};o.collection=new u,o.collection.fetch({data:e.param({access_token:g.get("access_token"),payeeType:"OA"}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?a(e):n(e)},error:n})},addDepositOpenTandCPopup:function(e){e.stopImmediatePropagation(),g.set("tandctype","adddeposit"),openTermsAndConditionsPopup()},gotoPreviousPage:function(e){e.stopImmediatePropagation(),window.history.back()},errorresponse:function(){hideSpinner(),openErrorPopup()},disposeView:function(e){return o.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return v});
define(["jquery","underscore","Backbone","backbonevalidation","models/requests/requestMetaFormModel","models/validation/requestValidationModel","collections/requests/applyChequeBookRequestCollections","collections/requests/requestVerificationCollections","views/requests/chequebookconfirmrequest","text!views/requests/chequebookrequest.tpl","text!views/requests/chequebookconfirmrequest.tpl"],function(e,t,o,n,r,s,c,i,a,u,l){var h=new EncryptedLocalStorage("secret"),d=o.View.extend({el:"#mobcontent",events:{"click #chequebookrequest":"gotoconfirmrequest"},initialize:function(){},update:function(t,o){h.set("currentPage","");var n=this;timestamp=(new Date).getTime();var r=function(e){n.requestcompile()};n.collection=new c([],{}),timestamp=(new Date).getTime(),showSpinner();var s="",i=h.get("lang_id");"en-US"==i?s="EN":"en-AR"==i&&(s="AR"),n.collection.fetch({data:e.param({requestid:timestamp,access_token:h.get("access_token"),language:s}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(h.get("calltimeout")),success:function(e){r("0000"==ackStatus?e:e)},error:r})},requestcompile:function(){return hideSpinner(),this.$el.html(t.template(u,{})).i18n(),this.$el.trigger("create"),this},gotoconfirmrequest:function(t){e("#errorFromAct").hide(),e("#errorBranch").hide(),e("#errornoofleaves").hide();var o=e("input[name=frmacno]:checked").val(),n=e("#branch option:selected").val(),r=e("#branch option:selected").text(),s=e("#leafnos option:selected").val(),c=e("#chqbookknos").val(),a="false";("undefined"==typeof o||""==o)&&(e("#errorFromAct").show(),a="true"),("undefined"==typeof n||""==n)&&(e("#errorBranch").show(),a="true"),""==s&&(e("#errornoofleaves").show(),a="true");var u=o.split("~"),l=u[0],d=u[1],p=u[2],m=u[5];if(h.set("sraccno",p),h.set("srcasaaccno",p),h.set("sraccname",d),h.set("srbranch",n),h.set("srbranchname",r),h.set("srchequeleaves",c),h.set("srleavesnos",s),h.set("sraccno",l),h.set("sraccname",d),h.set("sraccountId",m),"true"==a)return!1;showSpinner();var f=this,q=function(e){f.verificationcompile()},v=function(e){f.errorresponse()};f.collection=new i([],{}),timestamp=(new Date).getTime(),f.collection.fetch({data:e.param({access_token:h.get("access_token"),casaAcctId:m,noofchequeleaves:s,noofchequebooks:c,branchname:n,validtype:"Validation",servicecode:"CHQBOOKREQ",code:"CHQBOOKREQ"}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?q(e):v(e)},error:v})},verificationcompile:function(){hideSpinner(),o.history.navigate("#/chequebookconfirmrequest")},errorresponse:function(){hideSpinner(),o.history.navigate("#/exception")},disposeView:function(e){return o.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return d});
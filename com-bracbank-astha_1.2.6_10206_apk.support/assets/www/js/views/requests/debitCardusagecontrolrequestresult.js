define(["jquery","underscore","Backbone","collections/requests/debitcardusagectrlCreditCardCtrlModifyCollections","text!views/requests/debitCardusagecontrolrequestresult.tpl"],function(e,t,r,i,a){var n=new EncryptedLocalStorage("secret"),c=r.View.extend({el:"#mobcontent",events:{"click #postingrequest":"doanotherrequest"},initialize:function(){},render:function(){hideSpinner(),n.set("currentPage","transferConfirm");var t=this;timestamp=(new Date).getTime();var r=function(e){t.modifiedlimitcompile()},a=function(e){t.errorresponse()};t.collection=new i([],{}),showSpinner();var c,s,o,d,p,l=n.get("creditcardcontrols"),u=[],s=[],g=[],h=[],f=[],m=[],y=[],S=getDeviceId();l.forEach(function(e,t){u.push(e.CardNumber),g.push(e.hidmaskcardnumber),h.push(e.controlFlag),f.push(e.ecommerceFlag),m.push(e.hidcardType),y.push(e.hidexpiryDate),s=JSON.stringify(g),o=JSON.stringify(u),d=JSON.stringify(h),p=JSON.stringify(f),hidcardTypee=JSON.stringify(m),hidexpiryDatee=JSON.stringify(y)});var O=s.replace(/"/g,""),J=o.replace(/"/g,""),N=d.replace(/"/g,""),v=p.replace(/"/g,""),b=hidexpiryDatee.replace(/"/g,""),C=hidcardTypee.replace(/"/g,""),c=JSON.stringify(u+""+S),D=c.replace(/"/g,""),T=CryptoJS.MD5(D);D=T+"",t.collection.fetch({data:e.param({appchecksum:D,hidmaskcardnumber:O,debitcardnumber:J,debitcardtype:C,debitcardexpdate:b,debitcardctrlflag:N,dcecommerceflag:v,requestid:timestamp}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(n.get("calltimeout")),success:function(e){"0000"==ackStatus?(n.set("debitCardControlUpdateresultDTO",debitCardControlUpdateSubListDTO),r(e)):a(e)},error:a})},render1:function(){n.set("promoid",""),hideSpinner(),n.set("currentPage","transferConfirm");var t=this;timestamp=(new Date).getTime();var r=function(e){t.modifiedlimitcompile()},a=function(e){t.errorresponse()};t.collection=new i([],{}),showSpinner();var c=n.get("creditcardcontrols"),s=[],o=[],d=[],p=[],l=[],u=[],g=[],h=[],f=[],m=[],y=[],S=[],O=[],J=[],N=[],v=[];c.forEach(function(i,b){var C=getDeviceId(),D=i.CreditCardNumber,T=i.localflagval,k=i.interflagval,q=i.ecomflagval,w=(new Date).getTime(),x=i.custartdate,M=x.split("/")[0],I=x.split("/")[1],P=x.split("/")[2],j=P+I+M,E=i.cuenddate,F=E.split("/")[0],L=E.split("/")[1],U=E.split("/")[2],z=U+L+F;s.push(D),o.push(i.CreditCardNumber),d.push(i.ecomind),p.push(i.posind),l.push(i.atmind),u.push(i.motoind),g.push(j),h.push(z),f.push(i.hidmaskcardnumber),N.push(i.hidmaskctrlfetcherrorcode),v.push(i.hidmaskusagestatus),y.push(T),S.push(k),O.push(q),m.push(w);var B=[];B.push(T),B.push(k),B.push(q),J.push(B);var V=JSON.stringify(J),$=V.replace(/"/g,""),A=($.replace(/null/g,""),JSON.stringify(s)),G=(A.replace(/"/g,""),CryptoJS.MD5(A));A=G+"";var H=JSON.stringify(o),K=JSON.stringify(d),Q=JSON.stringify(p),R=JSON.stringify(l),W=JSON.stringify(u),X=JSON.stringify(g),Y=JSON.stringify(h),Z=JSON.stringify(f),_=JSON.stringify(N),ee=JSON.stringify(v),te=JSON.stringify(y),re=JSON.stringify(S),ie=JSON.stringify(O),ae=JSON.stringify(o+""+g+h+C),ne=ae.replace(/"/g,""),G=CryptoJS.MD5(ne);ne=G+"";var ce=(A.replace(/"/g,""),H.replace(/"/g,"")),se=K.replace(/"/g,""),oe=Q.replace(/"/g,""),de=R.replace(/"/g,""),pe=W.replace(/"/g,""),le=X.replace(/"/g,""),ue=Y.replace(/"/g,""),ge=Z.replace(/"/g,""),he=_.replace(/"/g,""),fe=ee.replace(/"/g,"");te.replace(/"/g,""),re.replace(/"/g,""),ie.replace(/"/g,"");c.length-1==b&&t.collection.fetch({data:e.param({appchecksum:ne,hidcreditcardno:ce,hidecomind:se,hidposind:oe,hidatmind:de,hidmotoind:pe,hidcustartdate:le,hidcuenddate:ue,hidmaskcardnumber:ge,usagecode:he,usagestatus:fe,requestid:w}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(n.get("calltimeout")),success:function(e){"0000"==ackStatus?(n.set("ccusagecontrolmodifyresultDTO",ccusagecontrolmodifyDTO),r(e)):a(e)},error:a})})},modifiedlimitcompile:function(){return hideSpinner(),this.$el.html(t.template(a)).i18n(),this},errorresponse:function(){hideSpinner(),r.history.navigate("#/exception")},doanotherrequest:function(t){t.preventDefault(),e("#servicerequestMnu").trigger("click")}});return c});
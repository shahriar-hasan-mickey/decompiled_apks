define(["jquery","underscore","Backbone","models/validation/requestValidationModel","models/requests/requestMetaFormModel","backbonevalidation","collections/creditcard/creditCardSummaryCollections","text!views/requests/internationalCardUsage.tpl"],function(e,t,i,n,r,o,s,a){var c=new EncryptedLocalStorage("secret"),l=i.View.extend({el:"#mobcontent",events:{"click #intercardusgrequest":"gotoconfirmrequest"},render:function(){c.set("currentPage","transferConfirm");var t=this,i=function(e){t.requestcompile()},n=function(e){t.errorresponse()};t.collection=new s([],{});(new Date).getTime();showSpinner(),t.collection.fetch({data:e.param({access_token:c.get("access_token")}),dataType:"json",type:"POST",timeout:parseInt(c.get("calltimeout")),cache:!1,success:function(e){var t=(c.get("errordesc"),c.get("errorcode"));"0000"==ackStatus?i(e):null!=t&&"MTC-RT-0003"!=t?i(e):n(e)},error:n})},requestcompile:function(){return hideSpinner(),e("#exp").val(""),this.$el.html(t.template(a,{})).i18n(),this.$el.trigger("create"),this},gotoconfirmrequest:function(t){this.model=new n({url:"json/"}),this.$(".alert").hide(),i.Validation.bind(this);var o=this.$("form").serializeObject();if(this.model.set(o,{validate:!0})){this.model.clear(),i.Validation.unbind(this),t.preventDefault(),this.model=new r({url:"json/"});var s=e("input[name=toacc]:checked").val(),a=e("#interusage option:selected").text();if("undefined"==typeof s)return e("#errorAct").show(),!1;var l=s.split("~"),u=l[0];l[1];c.set("stopCardNo",u),c.set("interusage",a),showSpinner(),this.verificationcompile()}else hideSpinner(),this.$(".alert-error").fadeIn(),t.preventDefault()},verificationcompile:function(e){this.undelegateEvents(),hideSpinner(),i.history.navigate("#/internationalcusconfirm")},errorresponse:function(){hideSpinner(),i.history.navigate("#/exception")},disposeView:function(e){return i.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return l});
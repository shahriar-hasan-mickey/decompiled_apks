define(["jquery","underscore","Backbone","models/requests/requestMetaFormModel","models/validation/requestValidationModel","collections/requests/applyFinanceRequestPostingCollections","collections/requests/requestVerificationCollections","text!views/requests/applyhomefinanceconfirmrequest.tpl","text!views/requests/applyhomefinancerequest.tpl","views/requests/applyhomefinancerequestresult"],function(e,t,n,i,o,a,s,r,c,l){var u=new EncryptedLocalStorage("secret"),p=n.View.extend({el:"#mobcontent",events:{"click #applyhomefinance":"gotoconfirmrequest","click #applyhomefinancerequestposting":"applyhomefinancerequestposting","click #applyhomefinancecalc":"applyhomefinancecalc","click #sal":"openNumPadSal","click #amt":"openNumPadAmt"},initialize:function(){},openNumPadSal:function(){this.openNumPad("sal")},openNumPadAmt:function(){this.openNumPad("amt")},openNumPad:function(t){var n=/iPad|iPhone|iPod/.test(navigator.userAgent),i=u.get("isKeyPadNeed");n&&i&&navigator.notification.keypadOpen(e("#"+t).val(),9,function(n){e("#"+t).val(convertNumbers2English(n))},function(n){e("#"+t).val(convertNumbers2English(n))})},update:function(t,n){u.set("currentPage","");var i=this;timestamp=(new Date).getTime();var o=function(e){i.requestcompile()},s=function(e){i.errorresponse()};i.collection=new a([],{}),timestamp=(new Date).getTime(),showSpinner();var r="",c=u.get("lang_id");"en-US"==c?r="EN":"en-AR"==c&&(r="AR"),i.collection.fetch({data:e.param({requestid:timestamp,service:"01",language:r,paramcode:"SRVFINANCE"}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(u.get("calltimeout")),success:function(e){"0000"==ackStatus?o(e):s(e)},error:s})},requestcompile:function(){return hideSpinner(),this.$el.html(t.template(c,{})).i18n(),this.$el.trigger("create"),this},applyhomefinancerequestposting:function(){this.subview=this.disposeView(new l),this.subview.render().$el.trigger("create"),this.undelegateEvents()},gotoconfirmrequest:function(t){e("#errorCheckBox").hide(),this.model=new o({url:"json/"}),n.Validation.bind(this);var a=this.$("form").serializeObject();if(this.model.set(a,{validate:!0})){this.model.clear(),n.Validation.unbind(this),t.preventDefault(),this.model=new i({url:"json/"});var s=e("#fintype").val(),r=e("#applyfor option:selected").text(),c=e("#ename").val(),l=e("#mobno").val(),p=e("#dob").val(),h=e("#city  option:selected").text(),m=e("#employername").val(),f=e("#length").val(),d=e("#sal").val(),v=e("#amt").val();if(!e("#iagreee").prop("checked"))return e("#errorCheckBox").show(),!1;u.set("hffintype",s),u.set("hfapplyfor",r),u.set("hfename",c),u.set("hfmobno",l),u.set("hfdob",p),u.set("hfcity",h),u.set("hfemployername",m),u.set("hflength",f),u.set("hfsal",d),u.set("hfamt",v),showSpinner(),this.verificationcompile(s,r,c,l,p,h,m,f,d,v)}},applyhomefinancecalc:function(){u.get("lang_id")},verificationcompile:function(){hideSpinner(),n.history.navigate("#/applyhomefinanceconfirmrequest")},errorresponse:function(){hideSpinner(),n.history.navigate("#/exception")},disposeView:function(e){return n.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return p});
define(["jquery","underscore","Backbone","models/requests/requestMetaFormModel","models/validation/requestValidationModel","routers/requestrouter","collections/requests/applyFinanceRequestPostingCollections","collections/requests/requestVerificationCollections","text!views/requests/applypersonalfinanceconfirmrequest.tpl","text!views/requests/applypersonalfinancerequest.tpl","views/requests/applypersonalfinancerequestresult"],function(e,t,n,i,a,o,s,r,l,c,p){var u=new EncryptedLocalStorage("secret"),f=n.View.extend({el:"#mobcontent",events:{"click #applypersonalfinance":"gotoconfirmrequest","click #applypersonalfinancerequestposting":"applypersonalfinancerequestposting","click #applypersonalfinancecalc":"applypersonalfinancecalc","click #sal":"openNumPadSal","click #amt":"openNumPadAmt"},initialize:function(){new o},openNumPadSal:function(){this.openNumPad("sal")},openNumPadAmt:function(){this.openNumPad("amt")},openNumPad:function(t){var n=/iPad|iPhone|iPod/.test(navigator.userAgent),i=u.get("isKeyPadNeed");n&&i&&navigator.notification.keypadOpen(e("#"+t).val(),9,function(n){e("#"+t).val(convertNumbers2English(n))},function(n){e("#"+t).val(convertNumbers2English(n))})},update:function(t,n){u.set("currentPage","transferConfirm");var i=this;timestamp=(new Date).getTime();var a=function(e){i.requestcompile()},o=function(e){i.errorresponse()};i.collection=new s([],{}),timestamp=(new Date).getTime(),showSpinner();var r="",l=u.get("lang_id");"en-US"==l?r="EN":"en-AR"==l&&(r="AR"),i.collection.fetch({data:e.param({requestid:timestamp,service:"01",language:r,paramcode:"SRVFINANCE"}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(u.get("calltimeout")),success:function(e){"0000"==ackStatus?a(e):o(e)},error:o})},requestcompile:function(){return hideSpinner(),this.$el.html(t.template(c,{})).i18n(),this.$el.trigger("create"),this},applypersonalfinancerequestposting:function(){this.subview=this.disposeView(new p),this.subview.render().$el.trigger("create"),this.undelegateEvents()},gotoconfirmrequest:function(t){e("#errorCheckBox").hide(),this.model=new a({url:"json/"}),n.Validation.bind(this);var o=this.$("form").serializeObject();if(this.model.set(o,{validate:!0})){this.model.clear(),n.Validation.unbind(this),t.preventDefault(),this.model=new i({url:"json/"});var s=e("#fintype").val(),r=e("#applyfor option:selected").val(),l=r.split("~"),c=l[0],p=l[1],f=e("#ename").val(),d=e("#mobno").val(),m=e("#dob").val(),h=e("#city  option:selected").text(),v=e("#employername").val(),g=e("#length").val(),y=e("#sal").val(),w=e("#amt").val();if(!e("#iagreee").prop("checked"))return e("#errorCheckBox").show(),!1;showSpinner(),u.set("pffintype",s),u.set("pfapplyfor",c),u.set("applyforcode",p),u.set("pfename",f),u.set("pfmobno",d),u.set("pfdob",m),u.set("pfcity",h),u.set("pfemployername",v),u.set("pflength",g),u.set("pfsal",y),u.set("pfamt",w),this.verificationcompile()}},verificationcompile:function(){hideSpinner(),n.history.navigate("#/applypersonalfinanceconfirmrequest")},applypersonalfinancecalc:function(){u.get("lang_id")},errorresponse:function(){hideSpinner(),n.history.navigate("#/exception")},disposeView:function(e){return n.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return f});
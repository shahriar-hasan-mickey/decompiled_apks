define(["jquery","underscore","Backbone","collections/creditcard/creditCardLimitOtpResultCollections","text!views/requests/applynewcreditcardconfirmrequest.tpl","text!views/requests/applynewcreditcardrequestresult.tpl","views/requests/applynewcreditcardrequestresult"],function(e,t,r,i,n,c,a){var s=new EncryptedLocalStorage("secret"),o=r.View.extend({el:"#mobcontent",events:{"click #applynewcreditcardrequestposting":"applynewcreditcardrequestposting"},initialize:function(){},render:function(){showSpinner(),this.requestcompile()},requestcompile:function(){return hideSpinner(),e(this.el).html(t.template(n,{})).i18n(),this},applynewcreditcardrequestposting:function(){var t=s.get("custno"),r=s.get("acceptcampaign"),n=s.get("promoid"),c=new Array;"Y"==r?c[0]="Origin":c[0]=e("#cardtype").val(),c[1]=e("#firstname").val(),c[2]=e("#dob").val(),c[3]=e("#mobno").val(),c[4]=e("#accno").val(),c[5]=e("#selectcity").val(),c[6]=e("#empname").val(),c[7]=e("#los").val(),c[8]=e("#sal").val(),c[9]=e("#selectcard").val();var a=JSON.stringify(c),o=new Array,l=s.get("applynewcc"),p=l[0],u=l[1],d=l[2],v=l[3],m=l[4],g=l[5],w=l[6],h=l[7],y=l[8],f=l[9];"Y"==r?o[0]="Crossselling":o[0]=p,o[1]=u,o[2]=d,o[3]=v,o[4]=m,o[5]=g,o[6]=w,o[7]=h,o[8]=y,o[9]=f;var q=JSON.stringify(o),S=q.replace(/^\[(.+)\]$/,"$1");S=S.replace(/"/g,""),valueJSONcheckvalue=S.split(" ").join("+");var C,V="NewCreditCardRequest",k="006",O=getDeviceId(),b=s.get("shamd5flagreqcheck");if("E"==b);else{C=V+""+k+valueJSONcheckvalue+O;var E=CryptoJS.MD5(C);C="E-"+E}var N=this;showSpinner();var J=function(e){N.postingcompile()},x=function(e){N.errorresponse()};N.collection=new i([],{id:t});e("form").serialize();N.collection.fetch({data:e.param({appchecksum:C,applyFor:f,ccCategory:"",requestid:timestamp,servicerequestname:"NewCreditCardRequest",customernumber:t,servicerequesttype:"006",actionFlag:r,campainId:n,name:a,value:q}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(s.get("calltimeout")),success:function(e){"0000"==ackStatus?J(e):x(e)},error:x})},postingcompile:function(){this.undelegateEvents(),s.set("cidforcc",""),s.set("acceptcampaign",""),r.history.navigate("#/applynewcreditcardrequestresult")},errorresponse:function(){hideSpinner(),r.history.navigate("#/exception")},disposeView:function(e){return r.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return o});
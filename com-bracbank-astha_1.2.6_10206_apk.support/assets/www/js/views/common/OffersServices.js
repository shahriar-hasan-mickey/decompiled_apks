define(["jquery","underscore","Backbone","collections/locator/offersSearchResultCollections"],function(e,t,n,o){var a=new EncryptedLocalStorage("secret"),i=n.View.extend({render:function(){function t(e){a.set("locationPage","#/landinglayout/offersresume"),onGeoLocationError(e)}function n(t){a.set("locationPage","");var n,o,s=(t.coords,a.get("app.context.path"));-1!=s.indexOf("dev")?(n="24.669170",o="46.70533"):(n=t.coords.latitude,o=t.coords.longitude);var l=new google.maps.LatLng(n,o),g=getDeviceId(),u=15;i(l);"en-US"==e.i18n.lng()?language="EN":"en-AR"==e.i18n.lng()&&(language="AR"),timestamp=(new Date).getTime(),c.collection.fetch({data:e.param({login_type:"prelogin",latitude:n,longitude:o,reqtype:"OFFERS",device_id:g,language:language,type:"1",distance:u,city:"",requestid:timestamp}),dataType:"json",type:"POST",cache:!1,success:function(t){var i=a.get("offersListDTO"),s=[];e.each(i,function(e){var t=i[e],c=t.location_latitude,l=t.location_longitude,g=r(n),u=r(o),d=r(c),h=r(l),f=6371,v=Math.acos(Math.sin(g)*Math.sin(d)+Math.cos(g)*Math.cos(d)*Math.cos(u-h))*f;a.set("distance",v),s.push(i[e])});var l=(a.get("distance"),s);a.set("resultsearchlist_JSON",l);var g=a.get("FileStorageFlag");window.localStorage.getItem("FileStorage");if("N"!=g){alert("show1");a.get("resultsearchlist_JSON");c.localstorefile()}}})}function i(e){var t="24.669170",n="46.70533",o=a.get("dlat"),i=a.get("dlong"),c=(a.get("offersname"),a.get("originalIndex"),r(t)),s=r(n),l=r(o),g=r(i),u=6371;Math.acos(Math.sin(c)*Math.sin(l)+Math.cos(c)*Math.cos(l)*Math.cos(s-g))*u}function r(e){var t=e*Math.PI/180;return t}var c=this;c.collection=new o,navigator.geolocation&&navigator.geolocation.getCurrentPosition(n,t,{enableHighAccuracy:!0,timeout:1e4,maximumAge:1e4})},localstorefile:function(){alert("show2");var e=this;require(["jquery","views/OffersServicesbg"],function(t,n){e.view=new n,e.view.render()})},disposeView:function(e){return n.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return i});
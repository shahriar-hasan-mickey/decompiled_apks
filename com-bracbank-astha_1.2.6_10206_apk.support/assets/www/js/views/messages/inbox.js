define(["jquery","underscore","Backbone","text!views/messages/inbox.tpl","text!views/messages/inboxmessagedeletesuccess.tpl","collections/messages/messagesInboxCollections","collections/messages/deleteItemsCollections"],function(e,t,s,n,c,a,o){var l=!1,r=new EncryptedLocalStorage("secret"),h=s.View.extend({el:"#mobcontent",events:{"click #msgdelete":"deleteMessage","click #submit":"deleteHome","click #selectAll":"selectAllCheckBox","change .checkinput":"changeCheckBox"},initialize:function(){r.set("messageInbox",""),r.set("msgSub","")},render:function(){var t=this,s=function(e){t.messagesInboxCompile()},n=function(e){t.errorresponse()};showSpinner(),t.collection=new a([],{});(new Date).getTime();t.collection.fetch({data:e.param({access_token:r.get("access_token")}),dataType:"json",type:"POST",success:function(e){"0000"==ackStatus?(hideSpinner(),s(e)):n(e)},error:n})},messagesInboxCompile:function(){this.$el.html(t.template(n)).i18n()},selectAllCheckBox:function(){l?(l=!1,e(".checkinput").removeClass("active"),e("#msgdelete").attr("disabled","disabled")):(l=!0,e(".checkinput").addClass("active"),e("#msgdelete").removeAttr("disabled"))},changeCheckBox:function(){var t=!1;e(this).hasClass("active")?e(this).removeClass("active"):e(this).addClass("active"),e(".checkinput").each(function(s,n){e(n).hasClass("active")&&(t=!0)}),t?(l=!1,e("#msgdelete").removeAttr("disabled")):e("#msgdelete").attr("disabled","disabled")},deleteMessage:function(){var t=[];e(".checkinput").each(function(s,n){if(e(n).hasClass("active")){var i=e(n).find("> input[type=checkbox]").val();t.push(i)}});var s="";for(i=0;i<t.length;i++)i>0&&(s+="~"),s+=t[i];var n=this,c=function(e){n.itemsDeleteSuccess()},a=function(e){n.errorresponse()};n.collection=new o([],{});(new Date).getTime();showSpinner(),n.collection.fetch({data:e.param({access_token:r.get("access_token"),messageactionname:"inbox",messageids:s,appchecksum:""}),dataType:"json",type:"POST",success:function(e){"0000"==ackStatus?(hideSpinner(),c(e)):a(e)},error:a})},itemsDeleteSuccess:function(){return this.$el.html(t.template(c)).i18n(),this.$el.trigger("create"),this},deleteHome:function(){hideSpinner(),s.history.navigate("#/messageCenter")},errorresponse:function(){hideSpinner(),s.history.navigate("#/exception")},disposeView:function(e){return s.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return h});
define(["jquery","underscore","Backbone","routers/approuter","routers/wealthrouter","text!views/billsAndFees/contactList.tpl"],function(e,a,t,i,n,s){var m=new EncryptedLocalStorage("secret"),o=t.View.extend({el:"#container",events:{"click #contactBackBtn":"backToPreviousPage","keyup #contact_search_box":"filterContactList","click .contactItem,.GroupConListItem":"getContactInfo","click .contactItemGroup":"contactGroupPoup"},render:function(){var e=this;e.loadTemplate()},filterContactList:function(a){a.stopImmediatePropagation();var t=this;jQuery.expr[":"].contains=function(e,a,t){return jQuery(e).text().toUpperCase().indexOf(t[3].toUpperCase())>=0};var i=a.target.value;i.length>0?(e(".search_clear").is(":visible")||(e(".search_clear").show(),e(".search_clear").on("click",function(){e("#contact_search_box").val(""),t.loadTemplate(),e("#contact_search_box").focus()})),e(".conItems").hide(),e('.conItems:contains("'+i+'")').length>0||e('.conItems[phonenumber*="'+i+'"]').length>0?(e(".nocontacts").hide(),e('.conItems:contains("'+i+'")').show(),e('.conItems[phonenumber*="'+i+'"]').show()):e(".nocontacts").show()):(e(".search_clear").hide(),e(".nocontacts").hide(),e(".conItems").show())},backToPreviousPage:function(e){e.stopImmediatePropagation(),window.history.back()},loadTemplate:function(){var t=this;e("html").removeClass().addClass("app"),this.$el.html(a.template(s)),e("#contact_list_div").html("");var i=/Android|iPad|iPhone|iPod/.test(navigator.userAgent);if(i)showSpinner(),navigator.contactsPhoneNumbers.list(function(a){hideSpinner();var i=t.createContactListUI(a);e("#contact_list_div").html(i)},function(e){hideSpinner()});else{var n=[{id:"1",firstName:"Kate",middleName:"",lastName:"Bell",displayName:"Kate Bell",thumbnail:"images/common/user.png",phoneNumbers:[{number:"(555) 564-8583",normalizedNumber:"(555) 564-8583",type:"MOBILE"},{number:"+91 9634634324",normalizedNumber:"+91 9634634324",type:"OTHER"}]},{id:"2",firstName:"Daniel",middleName:"",lastName:"Higgins",displayName:"Daniel Higgins",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+880 31-713311",normalizedNumber:"+880 31-713311",type:"HOME"},{number:"(408) 555-5270",normalizedNumber:"(408) 555-5270",type:"MOBILE"},{number:"+88 1755-661199",normalizedNumber:"+88 1755-661199",type:"OTHER"}]},{id:"2",firstName:"Daniel",middleName:"",lastName:"Higgins",displayName:"Daniel Higgins",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+880 31-713311",normalizedNumber:"+880 31-713311",type:"HOME"}]},{id:"3",firstName:"John",middleName:"Paul",lastName:"Appleseed",displayName:"John Paul Appleseed",thumbnail:null,phoneNumbers:[{number:"1700-763512",normalizedNumber:"1700-763512",type:"MOBILE"},{number:"+880 1700-763512",normalizedNumber:"+880 1700-763512",type:"HOME"}]},{id:"2",firstName:"Daniel",middleName:"",lastName:"Higgins",displayName:"Daniel Higgins",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+880 31-713311",normalizedNumber:"+880 31-713311",type:"HOME"}]},{id:"2",firstName:"Daniel",middleName:"",lastName:"Higgins",displayName:"Daniel Higgins",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+880 31-713311",normalizedNumber:"+880 31-713311",type:"HOME"}]},{id:"2",firstName:"Daniel",middleName:"",lastName:"Higgins",displayName:"Daniel Higgins",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+880 31-713311",normalizedNumber:"+880 31-713311",type:"HOME"}]},{id:"2",firstName:"Daniel",middleName:"",lastName:"Higgins",displayName:"Daniel Higgins",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+880 31-713311",normalizedNumber:"+880 31-713311",type:"HOME"}]},{id:"2",firstName:"Daniel",middleName:"",lastName:"Higgins",displayName:"Daniel Higgins",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+880 31-713311",normalizedNumber:"+880 31-713311",type:"HOME"}]},{id:"3",firstName:"TAP",middleName:"",lastName:"wallet",displayName:"TAP Wallet",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+88 01812344660",normalizedNumber:"+88 01812344660",type:"HOME"}]},{id:"4",firstName:"UPAY",middleName:"",lastName:"wallet",displayName:"UPAY Wallet",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+88 01847419492",normalizedNumber:"+88 01847419492",type:"HOME"}]},{id:"4",firstName:"cashouttest",middleName:"",lastName:"wallet",displayName:"cashouttest",thumbnail:"images/common/user3.png",phoneNumbers:[{number:"+88 018474194921",normalizedNumber:"+88 018474194921",type:"HOME"}]}],m=t.createContactListUI(n);e("#contact_list_div").html(m)}},getContactInfo:function(a){a.stopImmediatePropagation(),e("#contactListModel").modal("hide");var t=a.currentTarget.id;m.set("isOpenBookPage","true");var i=/(^(\+88|88|91|\+91))/,n=e("#"+t).attr("phonenumber").replace(/[^0-9]/g,"").replace(i,""),s=m.get("formDatasInEls");e.each(s,function(e,a){a.id==m.get("thisInputId")&&(a.value=n)}),m.set("formDatasInEls",s),window.history.back()},createContactListUI:function(e){var t="",i=a.sortBy(e,function(e){return e.displayName.toLocaleUpperCase()});e=i;var n=0;if(e.length>0)for(var s=0;s<e.length;s++){if(e[s].phoneNumbers.length>1){var m=JSON.stringify(e[s].phoneNumbers),o="";o=isNull(e[s].thumbnail)?'<span class="contact_initial">'+e[s].displayName.charAt(0)+"</span>":'<img class="media-object img-circle" src="'+e[s].thumbnail+'">',t+='<li class="list-group-item conItems contactItemGroup"  id="phone_list_'+n+'" conname="'+e[s].displayName+'"  phonenumber="'+m.replace(/"/g,"'")+'"><div class="media"><div class="media-left">'+o+'</div><div class="media-body"><p>'+e[s].displayName+'<a class="btn btn-default phone_btn pull-right">Select Number <span class="phone_number">+'+e[s].phoneNumbers.length+"</span></a></p> </div></div></li>"}else{var m=e[s].phoneNumbers[0],r=m.type,l=m.number.replace(/\s/g,""),o="";o=isNull(e[s].thumbnail)?'<span class="contact_initial">'+e[s].displayName.charAt(0)+"</span>":'<img class="media-object img-circle" src="'+e[s].thumbnail+'">',t+='<li class="list-group-item conItems contactItem" id="phone_list_'+n+'" conname="'+e[s].displayName+'"  phonenumber="'+l+'"><div class="media"><div class="media-left">'+o+'</div><div class="media-body"><p>'+e[s].displayName+"</p><span>"+r+" - "+l+"</span></div></div></li>"}n++}else t+='<div style="text-align:center; font-weight:bold; padding-top:20px;">No Contacts Found</div>';return t},contactGroupPoup:function(a){a.stopImmediatePropagation();for(var t=a.currentTarget.id,i=e("#"+t).attr("conname"),n='<div class="popupWrap"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><div class="phoneBook"><h4>'+i+'</h4><ul class="list-group m0">',s=JSON.parse(e("#"+t).attr("phonenumber").replace(/'/g,'"')),m=0;m<s.length;m++){var o=s[m],r=o.type,l=o.number.replace(/\s/g,"");n+='<li class="list-group-item"><span class="GroupConListItem" id="phone_item_'+m+'" phonenumber ='+l+">"+r+" - "+l+"</span></li>"}n+="</ul></div></div></div></div></div>",e("#contactListModel").html(n),e("#contactListModel").modal("show")},errorresponse:function(){hideSpinner(),openErrorPopup()},disposeView:function(e){return t.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return o});
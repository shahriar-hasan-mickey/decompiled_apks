define(["jquery","underscore","Backbone","collections/login/registerFirstTimeLoginCollections","collections/login/updateEmailIDCollections","collections/wealth/accSummaryCollections","text!views/login/authorizationMode.tpl"],function(e,t,n,o,i,a,r){var s=null,c=new EncryptedLocalStorage("secret"),l=n.View.extend({el:"#container",events:{"click #edit":"editEmailID","click #save":"updateEmailID","click #next_btn":"saveAuthorizationMode","click #verify_btn":"gotoLogin","click #cancel_btn":"backToLogin"},initialize:function(){},render:function(e){s=null,this.$el.html(t.template(r))},backToLogin:function(){n.history.navigate("#/login")},editEmailID:function(){e("#edit").hide(),e("#save").show(),e("#email_auth").removeAttr("readonly")},updateEmailID:function(){e("#emailNullError").html("");var t=e("#email_auth").text();showSpinner();var n=this,o=function(t){hideSpinner(),e("#save").hide(),e("#edit").show(),e("#email_auth").attr("readonly","readonly")},a=function(e){n.errorresponse()};n.collection=new i([],{});(new Date).getTime();n.collection.fetch({data:e.param({emailid:t,access_token:c.get("access_token")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?o(e):a(e)},error:a})},saveAuthorizationMode:function(){var t=this,i=e("input[name='authmode']:checked").val();showSpinner();var a=function(e){n.history.navigate("#/wealth")},r=function(e){t.errorresponse()};t.collection=new o([],{}),t.collection.fetch({data:e.param({access_token:c.get("access_token"),qnsans:c.get("getQuesAns"),authmode:i}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?a(e):r(e)},error:r})},getCasaAccountList:function(){var t=this;showSpinner();var o=function(e){hideSpinner(),c.set("isFABData","false"),c.set("isExpiryPopup","false"),c.set("isFirstTimeLogin",!0),c.set("isWalletCCPCData","false"),c.set("isCreditCardData","false"),c.set("isPrepaidCardData","false"),c.set("isCreditPrepaidCardData","false"),c.set("isFromLogin","true"),n.history.navigate("#/landinglayout",{trigger:!0,replace:!0})},i=function(e){t.errorresponse()};t.collection=new a,t.collection.fetch({data:e.param({access_token:c.get("access_token"),userflag:"Y"}),dataType:"json",type:"POST",cache:!1,success:function(e){if("0000"==ackStatus){c.get("errorcode");o(e)}else o(e)},error:i})},gotoLogin:function(){var t=e("#otp1").val(),o=e("#otp2").val(),i=e("#otp3").val(),a=e("#otp4").val(),r=e("#otp5").val(),s=e("#otp6").val();return""==t||""==o||""==i||""==a||""==r||""==s?void e("#otpNullError").html(e.i18n.t("validation.newregistration.otpnotnull")):(hideSpinner(),c.set("firstLoginFlag","true"),void n.history.navigate("#/login"))},invokeOTPSpinner:function(){return e(".resend_button").hide(),e("#OTPcontainer1").show(),null!=s?(s.set(1),void s.animate(0,function(){e("#OTPcontainer1").slideUp("slow")})):(s=new ProgressBar.Circle(OTPcontainer1,{color:"#333",strokeWidth:8,trailWidth:8,easing:"linear",duration:18e4,text:{autoStyleContainer:!1},from:{color:"#ec5f59",width:8},to:{color:"#ec5f59",width:8},step:function(t,n){n.path.setAttribute("stroke",t.color),n.path.setAttribute("stroke-width",t.width);var o=Math.round(180*n.value());0===o?(n.setText(""),e(".resend_button").show()):(e(".resend_button").hide(),n.setText(o+"s"))}}),s.text.style.fontFamily='"Raleway", Helvetica, sans-serif',s.text.style.fontSize="12px",s.text.style.fontWeight="bold",s.set(1),s.animate(0,function(){e("#OTPcontainer1").slideUp("slow")}),void e(".resend_button").click(function(){e("#OTPcontainer1").slideDown("slow"),s.set(1),s.animate(0,function(){e("#OTPcontainer1").slideUp("slow")})}))},errorresponse:function(e){hideSpinner(),openErrorPopup()}});return l});
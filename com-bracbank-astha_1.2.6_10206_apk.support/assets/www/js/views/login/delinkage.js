define(["jquery","underscore","Backbone","text!views/login/delinkage.tpl","collections/login/delinkageCollections","collections/common/otpValidateCollections","models/validation/OTPValidationModel","views/errors/exception"],function(e,i,t,n,r,o,a,l){var s=new EncryptedLocalStorage("secret"),c=t.View.extend({el:"#container",e1:"#preloginmobcontent",events:{"click #delinkageclick":"delinkageverification"},update:function(){showSpinner(),this.delinkagecompiler()},delinkagecompiler:function(){return hideSpinner(),this.$el.html(i.template(n)),this},delinkageverification:function(i){this.model=new a({url:"json/"}),t.Validation.bind(this);var n=this.$("form").serializeObject();if(this.model.set(n,{validate:!1})){this.model.clear(),t.Validation.unbind(this),i.preventDefault(),showSpinner();var o=this,l=function(e){o.delinkverify()},c=function(e){o.errorresponse()};o.collection=new r([],{}),timestamp=(new Date).getTime();var d=s.get("custno"),p=s.get("timeStampharse"),m=DEcryptuser(d,p),u=Encryptuser(m,timestamp),h=u,g=Encryptuser(m,timestamp),f=getDeviceId();s.set("device_id",f),o.collection.fetch({data:e.param({hiduserid:h,timeenv:g,timephrase:timestamp,delinkflag:"DELINK",device_id:f,requestid:timestamp}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(s.get("calltimeout")),success:function(e){"0000"==ackStatus?l(e):c(e)},error:c})}else this.$(".alert-error").fadeIn(),hideSpinner()},delinkverify:function(){hideSpinner(),t.history.fragment=null,t.history.navigate("#/delinkagesuccess",{trigger:!0,replace:!0})},errorresponse:function(e){hideSpinner(),openErrorPopup()}});return c});
define(["jquery","underscore","Backbone","routers/morerouter","routers/estatementrouter","collections/more/currencyConverterCollections","text!views/more/currencyConverter/currencyConverter.tpl"],function(e,r,t,o,n,c,a){var u=new EncryptedLocalStorage("secret"),i=t.View.extend({el:"#container",events:{"click #backBtn":"gotoMorePage","click #cancel":"gotoMorePage","click #convert":"getExchangeRate"},initialize:function(){new o,new n},render:function(){hideSpinner(),this.$el.html(r.template(a)),e("html").removeClass("primarybg hasBoth").addClass("app"),e("#convertedAmountDiv").hide(),e("#currConvShortNotesUIDiv").hide(),e("#exchangeRateDiv").hide()},gotoMorePage:function(){t.history.navigate("#/more")},getExchangeRate:function(){var r=this;e("#fromCurrError").html(""),e("#toCurrError").html(""),e("#amtNullError").html("");var t=e("#fromAmount").val(),o=e("#toAmount").val(),n=e("#amt").val().replace(/,/g,"");return null==t||""==t?void e("#fromCurrError").html("Please select a From Currency"):null==o||""==o?void e("#toCurrError").html("Please select a To Currency"):null==n||""==n?void e("#amtNullError").html("Please enter an amount to convert"):t==o?void e("#toCurrError").html("The From Currency and the To Currency cannot be the same"):(u.set("fromCurrency",t),u.set("toCurrency",o),u.set("convAmount",n),r.convertAmount(),void 0)},convertAmount:function(){var r=this,t=function(r){hideSpinner(),e("#convertedAmount").empty();var t=u.get("exchangeRate");e("#exchangeRateDiv").show(),e("#exchangeRate").html(t);var o=checkAmount(e.formatNumber(u.get("buyRate"),{format:"#,###.00",locale:"us"})),n=u.get("fromCurrency"),c=u.get("toCurrency"),a=u.get("convAmount");e("#convertedAmountDiv").show(),convertAmt=checkAmount(e.formatNumber(a,{format:"#,###.00",locale:"us"}))+" "+n+" = "+o+" "+c,e("#convertedAmount").append(convertAmt);var i=e.parseJSON(window.localStorage.getItem("shortNotesObj"));isNull(i.CURR_CONV)||(e("#currConvShortNotesUIDiv").show(),e("#currConvShortNotesDiv").html(i.CURR_CONV))},o=function(e){r.errorresponse()};showSpinner(),r.collection=new c,r.collection.fetch({data:e.param({access_token:u.get("access_token"),fromCurrency:u.get("fromCurrency"),toCurrency:u.get("toCurrency"),transferAmount:u.get("convAmount")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?t(e):o(e)},error:o})},errorresponse:function(){hideSpinner(),openErrorPopup()},disposeView:function(e){return t.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return i});
define(["jquery","underscore","Backbone","collections/tools/TDRatesDropdownCollections","collections/tools/TDRatesCollections","text!views/more/TDRates.tpl","text!views/more/TDRates2.tpl"],function(e,r,t,c,n,o,i){var s=new EncryptedLocalStorage("secret"),a=t.View.extend({el:"#container",e1:"#menuwrapper",e2:"#mobcontent",initialize:function(){e("#deptype").prop("selectedIndex",-1),e("#curr").prop("selectedIndex",-1)},events:{"change #deptype":"dropdownValuecheck","change #fromcurr":"Currencyvalcheck","click #tools":"tools"},render:function(){var r=this,t=function(e){r.showRegTemplate()},n=function(e){r.errorresponse()};showSpinner(),r.collection=new c,timestamp=(new Date).getTime(),r.collection.fetch({data:e.param({access_token:s.get("access_token"),depositType:"DEPOSIT"}),dataType:"json",type:"POST",timeout:parseInt(s.get("calltimeout")),cache:!1,success:function(e){"0000"==ackStatus?(hideSpinner(),t(e)):n(e)}})},showRegTemplate:function(){hideSpinner(),this.$("#mobcontent").html(r.template(o)).i18n()},dropdownValuecheck:function(){e("#currdrop").hide(),e("#errdepotype").hide(),e("#errcurr").hide();var t=e("input[name='deptype']:checked").val();e("#currdrop").hide();var c=t.split("~"),n=c[0];s.set("depotype",n);var o=c[1],i=s.get("depositTypesdes");if(""!=o&&null!=o&&void 0!=o&&"undefined"!=o){e("#currdrop").show();var a=i[o].currencyDetails,p=a[0].currencyCode;s.set("currencycodee",p);var l=a[0].currencyDescription;if(s.set("currencydescc",l),e("#currdrop").html('<div class="dropselectbiller" data-title="'+e.i18n.t("app.creditcard.ccdetails.currency")+'" id="currencycompany" style="display:none;"></div>'),0!=r.size(a)){var u=0,d="";r.each(a,function(e,r){d+='<label class="list-group-item" id="fromcurr">',d+='<input type="radio" id="fromcurr" name="fromcurr" value="'+e.currencyCode+"~"+e.currencyDescription+"~"+r+'" />',d+='<p><span id="currencydesc" class="nme" id="nme'+r+'" >'+e.currencyDescription+"</span></p> </label>",u++}),e("#currencycompany").html(d),e("#currencycompany").show(),e(".dropselectbiller").dropselectbiller();e("#fromcurr").val()}}else e("#currdrop").hide(),e("#currencycompany").hide(),e("#currencycompany").empty();var m=e("input[name=fromcurr]:checked").val(),h=m.split("~"),y=h[0];s.set("currenId",y);var f=h[1];s.set("currenTxt",f),(""!=e("#fromcurr").val()||null!=e("#fromcurr").val()||void 0!=e("#fromcurr").val())&&this.TDtemplatecompile()},Currencyvalcheck:function(r,t){var c=e("input[name=fromcurr]:checked").val(),n=c.split("~"),o=n[0];s.set("currenId",o);var i=n[1];s.set("currenTxt",i),this.TDtemplatecompile()},TDtemplatecompile:function(){var t=this,c=s.get("currenId"),o=s.get("depotype"),a=function(e){t.$("#tddata").html(r.template(i))},p=function(e){t.errorresponse()},l=o+c;l=null==l?"":l,checkSumEncrypt(l);var u=localStorage.getItem("FINALCHECKSUM");showSpinner(),t.collection=new n,timestamp=(new Date).getTime(),t.collection.fetch({data:e.param({appchecksum:u,access_token:s.get("access_token"),currency:c,depositType:o}),dataType:"json",type:"POST",timeout:parseInt(s.get("calltimeout")),cache:!1,success:function(e){"0000"==ackStatus?(hideSpinner(),a(e)):p(e)}})},errorresponse:function(){hideSpinner(),openErrorPopup()},tools:function(e){e.preventDefault(),t.history.fragment=null,t.history.navigate("#/more",{trigger:!0,replace:!0})},disposeView:function(e){return t.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return a});
define(["jquery","underscore","Backbone","text!views/touchid/touchdevicelist.tpl","collections/common/otpGenerateCollections","collections/common/otpValidateCollections","collections/logout/logoutCollections","collections/touchid/touchIDDeactivateCollection","collections/touchid/touchIDRegisterCollection","views/errors/exception"],function(e,t,c,i,n,a,o,s,l,r){var u=new EncryptedLocalStorage("secret"),d=c.View.extend({el:"#container",e1:"#preloginmobcontent",events:{"click input[name=deviceListSubmit]":"updateDeviceSelection","change input[type=radio]":"changeEnableDisable","click #deviceListCancel":"cancelDeviceSelection"},render:function(){var e=u.get("bioMetricDetailsDTO");return null!=e&&e.length>0?this.$el.html(t.template(i)):this.updateTouchFlag(),this},changeEnableDisable:function(){var t=e("input[type=radio]:checked");t.length>0&&e.each(t,function(c){t[c].checked&&t[c].id=="deviceYes"+c?(e("#labelYes"+c).addClass("active"),e("#labelYes"+c).addClass("btn-success"),e("#labelYes"+c).removeClass("btn-default"),e("#labelNo"+c).removeClass("active"),e("#labelNo"+c).addClass("btn-default"),e("#labelNo"+c).removeClass("btn-success")):(e("#labelYes"+c).removeClass("active"),e("#labelYes"+c).removeClass("btn-success"),e("#labelYes"+c).addClass("btn-default"),e("#labelNo"+c).addClass("active"),e("#labelNo"+c).removeClass("btn-default"),e("#labelNo"+c).addClass("btn-success"))})},creatempinsuccessverification:function(e){e.preventDefault(),u.set("currentPage",""),this.creatempinsuccessverify()},updateDeviceSelection:function(t){var c=t.currentTarget.id;c=c.split("deviceListSubmit")[1];var i=u.get("bioMetricDetailsDTO"),n=new Array,a=new Array,o=new Array,l=new Array;n.push(i[c].deviceID),n=JSON.stringify(n).replace(/"/g,""),a.push("D"),a=JSON.stringify(a).replace(/"/g,""),null!=i[c].deviceName&&""!=i[c].deviceName?o.push(i[c].deviceName):null!=i[c].deviceModel&&""!=i[c].deviceModel?o.push(i[c].deviceModel):null!=i[c].deviceID&&""!=i[c].deviceID&&o.push(i[c].deviceID),l.push(i[c].biometric_type_flag);var r=this,d=function(e){r.updateTouchFlag()},p=function(e){r.errorresponse()};r.collection=new s([],{});var h=(new Date).getTime(),v=(u.get("custnoenc"),u.get("timeStampharse"),u.get("deccust")),g=(getDeviceId(),i[c].deviceID+"D"+u.get("BiometricType")+"Deregister"),m=CryptoJS.MD5(g);g=m+"";var f,b=v,D=Encryptuser(v,h),y=D,S=Encryptuser(b,h),w=u.get("emailid");f=""!=w&&"null"!=w&&null!=w&&void 0!=w?w:"",showSpinner(),r.collection.fetch({data:e.param({appchecksum:g,multiple_deviceid:n,multiple_deviceidflag:a,userid:y,timeenv:S,timephrase:h,touchIdFlag:"Deregister",custemail:f,biometriclogintype:u.get("BiometricType")}),dataType:"json",type:"POST",cache:!1,success:function(t){if("0000"==ackStatus){if("FID"==l[0])var c=e.i18n.t("app.faceid.notifaceDeregister");else var c=e.i18n.t("app.touchid.notiTouchDeregister");pushLocalNotification(c+" "+o[0]),d(t)}else p(t)},error:p})},cancelDeviceSelection:function(t){alert("show"),t.preventDefault(),showSpinner();var c=this,i=function(e){c.cancelcompile()},n=function(e){c.errorresponse()};c.collection=new o([],{});var a=(new Date).getTime();c.collection.fetch({data:e.param({usersession:u.get("access_token"),access_token:u.get("access_token"),requestid:a}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?i(e):n(e)},error:n})},cancelcompile:function(){hideSpinner(),c.history.fragment=null,c.history.navigate("#/backtohome",{trigger:!0,replace:!0})},showregSuccess:function(){u.set("touchIdReg","A"),u.set("touchIdRegServer","A"),hideSpinner(),c.history.fragment=null,c.history.navigate("#/touchidregsuccess",{trigger:!0,replace:!0})},updateTouchFlag:function(){showSpinner();var t=this,c=function(e){t.showregSuccess()},i=function(e){t.errorresponse()};t.collection=new l([],{});var n=((new Date).getTime(),getDeviceId());t.collection.fetch({data:e.param({access_token:u.get("access_token"),appchecksum:"",device_id:n,ulpid:u.get("ulpID"),biometriclogintype:u.get("BiometricType")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?c(e):i(e)},error:i})},errorresponse:function(e){hideSpinner(),openErrorPopup()}});return d});
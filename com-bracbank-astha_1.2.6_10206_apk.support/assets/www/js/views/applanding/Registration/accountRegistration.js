define(["jquery","underscore","Backbone","text!views/applanding/Registration/accountRegistration.tpl","collections/applanding/Registration/cardPinValidationCollections"],function(e,t,r,o,n){var c=null,i=new EncryptedLocalStorage("secret"),a=!1,l=r.View.extend({el:"#container",events:{"click #accRegCancelBtn":"gotoPreviousPage","click #accRegValidateBtn":"gotoNextPage"},render:function(){c=null,hideSpinner(),this.$el.html(t.template(o,{})),a=!1,this.$el.trigger("create"),e("html").addClass("loginbg").removeClass("preloginbg"),e("#first,#second,#third,#fourth").removeAttr("disabled","disabled"),e(".first,.mid,.last").removeAttr("disabled","disabled")},gotoPreviousPage:function(e){"object"==typeof e&&e.stopImmediatePropagation(),r.history.navigate("#/newregistration")},gotoNextPage:function(t){"object"==typeof t&&t.stopImmediatePropagation();var r=this;a=!1,e("#regAccNumError").html(""),e("#regMobNumError").html("");var o=e("#regAccNum").val(),n=e("#regMobNum").val();isNull(o)&&(a=!0,e("#regAccNumError").html("Please enter the account number")),isNull(o)||(o.length<13&&(a=!0,e("#regAccNumError").html("Account Number should be minimum of 13 characters")),o.length>16&&(a=!0,e("#regAccNumError").html("Account Number should be maximum of 16 characters")),13!=o.length&&16!=o.length&&(a=!0,e("#regAccNumError").html("Account Number should be either 13/16 characters"))),isNull(n)&&(a=!0,e("#regMobNumError").html("Please enter the mobile number")),isNull(n)||n.length>16&&(a=!0,e("#regMobNumError").html("Mobile Number should be maximum of 16 characters")),a||(i.set("regAccNum",o),i.set("regMobNum",n),r.gotoAccNumValidation(t))},gotoAccNumValidation:function(t){"object"==typeof t&&t.stopImmediatePropagation();var r=this,o=i.get("regAccNum"),c=i.get("regMobNum"),a=(new Date).getTime();i.set("saltreg",a),i.set("registeraccountNumber",o);var l=EncryptWithDynamicSalt(o,a),s=EncryptWithDynamicSalt(c,a);i.set("encAccNum",l);var u=function(e){hideSpinner(),r.gotoSelectAuthModePage(t)},g=function(e){r.errorresponse()};showSpinner(),r.collection=new n;getDeviceId(),(new Date).getTime();r.collection.fetch({data:e.param({ccno:l,ccpinno:s,salt:a,cardtype:i.get("cardType"),flag:"R"}),dataType:"json",type:"POST",cache:!1,success:function(t){"0000"==ackStatus?u(t):(g(t),e("form")[0].reset())},error:g})},gotoSelectAuthModePage:function(e){"object"==typeof e&&e.stopImmediatePropagation(),r.history.navigate("#/regaccselectauthmode")},errorresponse:function(){hideSpinner(),openErrorPopup()},disposeView:function(e){return r.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return l});
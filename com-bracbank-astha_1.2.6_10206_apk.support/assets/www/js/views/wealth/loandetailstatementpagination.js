define(["jquery","underscore","Backbone","collections/wealth/loanDetailStatementCollections","collections/wealth/loanDetailStatementPaginationCollections","text!views/wealth/loandetailstatementpagination.tpl","text!views/wealth/loandetailstatementpaginationpage.tpl","collections/common/emailAdviceCollections","text!views/common/emailAdviceSuccessPage.tpl","views/common/exception"],function(e,t,a,n,o,c,i,r,s,l){var m=new EncryptedLocalStorage("secret"),p=a.View.extend({el:"#pagingcontent",events:{"click #buttonclick":"clickpagination","click #emailadvice":"EmailAdvice","click #pdfdownload":"PDFDownload","click #xlsdownload":"XLSdownload","click #csvdownload":"CSVdownload","click #ftrefnum":"fttransaccnum"},render:function(){this.showFirstRecord()},update:function(e){this.showOtherRecords(e)},showFirstRecord:function(){var t,a,o,c,i,r=m.get("loanid"),s=m.get("myloans"),l=s[r].id,p=m.get("AcctSummaryArray"),d=m.get("cdbflag");t=p[0],a=p[1],o=p[2],c=m.get("frmamtprod"),i=m.get("toamtprod"),showSpinner();var u=this,g=function(e){u.showdetailstmttemplate(t)};m.set("accountNumber",t),m.set("frmamount",c),m.set("toamount",i);var h=function(e){u.errorresponse()};u.collection=new n([],{});var f=getDeviceId(),v=t+""+f,w=CryptoJS.MD5(v);v=w+"";var S=l+a+o;S=null==S?"":S,checkSumEncrypt(S);var k=localStorage.getItem("FINALCHECKSUM");c=""!=c?c:"",i=""!=i?i:"",u.collection.fetch({data:e.param({access_token:m.get("access_token"),appchecksum:k,accountId:l,fromDate:a,toDate:o,debitCreditFlag:d,lastnTxn:m.get("lastntrans"),fromAmount:c,toAmount:i}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(m.get("calltimeout")),success:function(e){"0000"==ackStatus?g(e):h(e)},error:h})},showOtherRecords:function(t){m.set("currpage_number",t),showSpinner();var a=this,n=function(e){a.showdetailstmttemplatepage()},c=function(e){a.errorresponse()};a.collection=new o([],{pageNo:t});var i=m.get("loanid"),r=m.get("myloans"),s=r[i].id,l=10,p=s+m.get("stmtHeaderId")+t+l;p=null==p?"":p,checkSumEncrypt(p);var d=localStorage.getItem("FINALCHECKSUM");a.collection.fetch({data:e.param({appchecksum:d,access_token:m.get("access_token"),accountId:s,stmtheaderId:m.get("stmtHeaderId"),pagenumber:t,noofpage:"10"}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?n(e):c(e)},error:c})},showdetailstmttemplate:function(){var a=m.get("pageno"),n=parseInt(a)-1;return e("#pagelink"+n).addClass("active_page").siblings(".active_page").removeClass("active_page"),hideSpinner(),this.$el.html(t.template(c)),this},showdetailstmttemplatepage:function(){var a=m.get("pageno"),n=parseInt(a)-1;return e("#pagelink"+n).addClass("active_page").siblings(".active_page").removeClass("active_page"),hideSpinner(),this.$el.html(t.template(i)),this},EmailAdvice:function(){showSpinner();var t=this,a=m.get("ftreff"),n=function(e){t.emailadvicecompile(a)},o=function(e){t.errorresponse()};t.collection=new r([],{});var c,i=(new Date).getTime(),s=m.get("accountNumber"),l=m.get("ttype");"ACCOUNT"==l?c="ACCOUNT":"CARD"==l?c="CARD":"TRANSFER"==l&&(c="TRANSFER");var p=m.get("emailid"),d=(m.get("loginid"),m.get("custno")),u=(m.get("lang_id"),getDeviceId()),g=(m.get("accountNumber"),s+""+u),h=CryptoJS.MD5(g);g=h+"",t.collection.fetch({data:e.param({appchecksum:g,ftrefno:a,transfertype:c,accountNumber:s,custmailid:p,custuserid:d,requestid:i}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(m.get("calltimeout")),success:function(e){"0000"==ackStatus?n(e):o(e)},error:o})},emailadvicecompile:function(){return m.set("backReqFromEmail","3"),this.$el.html(t.template(s)).i18n(),this.$el.trigger("create"),hideSpinner(),this},errorresponse:function(){hideSpinner(),openErrorPopup()}});return p});
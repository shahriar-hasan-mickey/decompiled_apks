define(["jquery","underscore","Backbone","collections/wealth/depositDetailStatementCollections","collections/wealth/depositDetailStatementPaginationCollections","text!views/wealth/depositcarddetailstatementpagination.tpl","collections/common/emailAdviceCollections","text!views/common/emailAdviceSuccessPage.tpl","views/common/exception"],function(e,t,c,a,o,n,i,r,s){var l=new EncryptedLocalStorage("secret"),d=c.View.extend({el:"#pagingcontent",events:{"click #buttonclick":"clickpagination","click #emailadvice":"EmailAdvice","click #pdfdownload":"PDFDownload","click #xlsdownload":"XLSdownload","click #csvdownload":"CSVdownload","click #ftrefnum":"fttransaccnum"},render:function(){this.showFirstRecord()},update:function(e){this.showOtherRecords(e)},showFirstRecord:function(){var t,c,o,n,i,r=l.get("depositid"),s=l.get("mydeposit"),d=s[r].id,m=(s[r].accountNumber,l.get("cdbflag")),u=l.get("AcctSummaryArray");t=u[0],c=u[1],o=u[2],n=l.get("frmamtdep"),i=l.get("toamtdep"),showSpinner();var p=this,g=function(e){p.showdetailstmttemplate(t)};l.set("accountNumber",t),l.set("frmamount",n),l.set("toamount",i);var h=function(e){p.errorresponse()};p.collection=new a([],{});var f=getDeviceId(),v=t+""+f,S=CryptoJS.MD5(v);v=S+"";var w=d+c+o;w=null==w?"":w,checkSumEncrypt(w);var k=localStorage.getItem("FINALCHECKSUM");n=""!=n?n:"",i=""!=i?i:"",p.collection.fetch({data:e.param({access_token:l.get("access_token"),appchecksum:k,accountId:d,fromDate:c,toDate:o,flag:"PC",type:"NORMAL",debitCreditFlag:m,lastnTxn:l.get("lastntrans"),fromAmount:n,toAmount:i}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(l.get("calltimeout")),success:function(e){"0000"==ackStatus?g(e):h(e)},error:h})},showOtherRecords:function(t){l.set("currpage_number",t),showSpinner();var c=this,a=function(e){c.showdetailstmttemplate()},n=function(e){c.errorresponse()};c.collection=new o([],{pageNo:t});var i=l.get("depositid"),r=l.get("mydeposit"),s=r[i].id,d=(r[i].accountNumber,s+l.get("stmtHeaderId")+t+"10");d=null==d?"":d,checkSumEncrypt(d);var m=localStorage.getItem("FINALCHECKSUM");c.collection.fetch({data:e.param({appchecksum:m,access_token:l.get("access_token"),accountId:s,flag:"PC",stmtheaderId:l.get("stmtHeaderId"),pagenumber:t,noofpage:"10"}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?a(e):n(e)},error:n})},showdetailstmttemplate:function(){var c=l.get("pageno"),a=parseInt(c)-1;return e("#pagelink"+a).addClass("active_page").siblings(".active_page").removeClass("active_page"),hideSpinner(),this.$el.html(t.template(n)),this},EmailAdvice:function(){showSpinner();var t=this,c=l.get("ftreff"),a=function(e){t.emailadvicecompile(c)},o=function(e){t.errorresponse()};t.collection=new i([],{});var n,r=(new Date).getTime(),s=l.get("accountNumber"),d=l.get("ttype");"ACCOUNT"==d?n="ACCOUNT":"CARD"==d?n="CARD":"TRANSFER"==d&&(n="TRANSFER");var m=l.get("emailid"),u=(l.get("loginid"),l.get("custno")),p=(l.get("lang_id"),getDeviceId()),g=(l.get("accountNumber"),s+""+p),h=CryptoJS.MD5(g);g=h+"",t.collection.fetch({data:e.param({appchecksum:g,ftrefno:c,transfertype:n,accountNumber:s,custmailid:m,custuserid:u,requestid:r}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(l.get("calltimeout")),success:function(e){"0000"==ackStatus?a(e):o(e)},error:o})},emailadvicecompile:function(){return l.set("backReqFromEmail","3"),this.$el.html(t.template(r)).i18n(),this.$el.trigger("create"),hideSpinner(),this},errorresponse:function(){hideSpinner(),openErrorPopup()}});return d});
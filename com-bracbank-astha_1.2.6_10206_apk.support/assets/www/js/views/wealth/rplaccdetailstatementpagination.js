define(["jquery","underscore","Backbone","collections/wealth/accDetailStatementCollections","collections/wealth/accDetailStatementPaginationCollections","text!views/wealth/rplaccdetailstatementpagination.tpl","collections/common/emailAdviceCollections","text!views/common/emailAdviceSuccessPage.tpl","views/common/exception"],function(e,t,n,o,a,c,i,l,r){var d=new EncryptedLocalStorage("secret"),s=n.View.extend({el:"#pagingcontent",events:{"click #buttonclick":"clickpagination","click #emailadvice":"EmailAdvice","click #pdfdownload":"PDFDownload","click #xlsdownload":"XLSdownload","click #csvdownload":"CSVdownload","click #ftrefnum":"fttransaccnum"},update:function(e){this.showOtherRecords(e)},showOtherRecords:function(t){d.set("currpage_number",t),showSpinner();var n=this,o=function(e){n.showdetailstmttemplate()},c=function(e){n.errorresponse()};n.collection=new a([],{pageNo:t}),n.collection.fetch({data:e.param({pageno:t,pagesid:"downloads"}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?o(e):c(e)},error:c})},showdetailstmttemplate:function(){return hideSpinner(),this.$el.html(t.template(c)),this},PDFDownload:function(e){var t="",n=d.get("app.context.path");t=n+"account/ministatement/download.pdf";var o=d.get("appSessionId"),a=d.get("device_id"),c=d.get("lang_id"),i=d.get("rplano"),l=getDeviceId(),r=i+""+l,s=CryptoJS.MD5(r);r=s+"";var p="device_id="+a+"&appchecksum="+r+"&lang_id="+c+"&accountNumber="+i+"&download=PDF&cardoract=RPL",u=encodeURI(p);fileDownLoadAndViewer(t,u,1,o)},pdfdownloadcompile:function(){hideSpinner()},XLSdownload:function(e){var t="",n=d.get("app.context.path");t=n+"account/ministatement/download.xls";var o=d.get("appSessionId"),a=d.get("device_id"),c=d.get("lang_id"),i=d.get("rplano"),l=getDeviceId(),r=i+""+l,s=CryptoJS.MD5(r);r=s+"";var p="device_id="+a+"&appchecksum="+r+"&lang_id="+c+"&accountNumber="+i+"&download=XLS&cardoract=RPL",u=encodeURI(p);fileDownLoadAndViewer(t,u,2,o)},clickpagination:function(){var t=e("#currentpageno").val();n.history.navigate("#/rplshowotherpages/"+t)},EmailAdvice:function(){showSpinner();var t=this,n=function(e){t.emailadvicecompile()},o=function(e){t.errorresponse()};t.collection=new i([],{});var a,c=(new Date).getTime(),l=d.get("ttype");"ACCOUNT"==l?a="ACCOUNT":"CARD"==l?a="CARD":"TRANSFER"==l&&(a="TRANSFER");var r=d.get("emailid"),s=(d.get("loginid"),d.get("custno")),p=(d.get("lang_id"),getDeviceId()),u=d.get("rplano"),m=u+""+p,g=CryptoJS.MD5(m);m=g+"",t.collection.fetch({data:e.param({appchecksum:m,transfertype:a,accountNumber:u,custmailid:r,custuserid:s,requestid:c}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(d.get("calltimeout")),success:function(e){"0000"==ackStatus?n(e):o(e)},error:o})},emailadvicecompile:function(){return d.set("backReqFromEmail","10"),hideSpinner(),this.$el.html(t.template(l)).i18n(),this.$el.trigger("create"),this},errorresponse:function(){hideSpinner(),n.history.navigate("#/exception")}});return s});
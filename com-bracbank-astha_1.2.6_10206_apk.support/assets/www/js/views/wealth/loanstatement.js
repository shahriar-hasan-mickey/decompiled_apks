define(["jquery","underscore","Backbone","routers/approuter","routers/wealthrouter","text!views/wealth/loanstatement.tpl","views/errors/exception"],function(e,t,n,a,o,i,r){var l=new EncryptedLocalStorage("secret"),s=n.View.extend({el:"#container",e1:"#menuwrapper",e2:"#mobcontent",e3:"#ccloaddata",events:{"click #loanstmt":"loanstmt","click #loanstmtbackbutton":"loanstmtbackbutton"},initialize:function(){new o},update:function(){this.$el.html(t.template(i)),e("html").removeClass("app state").addClass("app"),hideSpinner()},loanstmt:function(){n.history.navigate("#/wealth")},loanstmtbackbutton:function(){n.history.navigate("#/loanaccountdetails");var t="",a=l.get("app.context.path");t=a+"account/ministatement/download.pdf";var o=l.get("access_token"),i=(l.get("device_id"),l.get("lang_id"),e("#accountno").val(),l.get("loanid")),r=l.get("myloans"),s=r[i].id,c="",d="",u="",p="",m="",h="",f=(getDeviceId(),""),w="accountID="+s+"&fromDate="+p+"&toDate="+m+"&fromAmount="+c+"&toAmount="+d+"&lastnTxn="+u+"&emailRequired="+h+"&appchecksum="+f+"&access_token="+o+"&download=PDF&type=LOAN",v=encodeURI(w);fileDownLoadAndViewer(t,v,1,o)},pdfdownloadcompile:function(){hideSpinner()},XLSdownload:function(t){var n="",a=l.get("app.context.path");n=a+"account/ministatement/download.xls";var o=l.get("access_token"),i=(l.get("device_id"),l.get("lang_id"),e("#accountno").val(),l.get("loanid")),r=l.get("myloans"),s=r[i].id,c="",d="",u="",p="",m="",h="",f=(getDeviceId(),""),w="accountID="+s+"&fromDate="+p+"&toDate="+m+"&fromAmount="+c+"&toAmount="+d+"&lastnTxn="+u+"&emailRequired="+h+"&appchecksum="+f+"&access_token="+o+"&download=XLS&type=LOAN",v=encodeURI(w);fileDownLoadAndViewer(n,v,2,o)},xlsdownloadcompile:function(){hideSpinner()},getloandetailstatement:function(t){this.model=new wealthValidation({url:"json/"}),this.$(".alert").hide(),n.Validation.bind(this);var a=this.$("form").serializeObject();if(this.model.set(a,{validate:!0})){this.model.clear(),n.Validation.unbind(this),t.preventDefault(),showSpinner();var o=e("form#loandetailstatement"),i=o.find("#fromDate").val(),r=o.find("#toDate").val(),l=o.attr("action");n.history.navigate(l+"/"+i+"/"+r,{trigger:!1}),hideSpinner(),this.undelegateEvents()}else this.$(".alert-error").fadeIn(),t.preventDefault(),showSpinner()},datefunc:function(t){e(".nativedatepicker").focus(function(t,n){t.preventDefault();var a,o=e(this),i=n||{};i.min||0,i.max||0;if(""!==o.val()){var r=o.val(),l=/(\d+)\/(\d+)\/(\d+)/.exec(r),s=new Date(+l[3],+l[2]-1,+l[1]);a=Date.parse(s)}else t.preventDefault(),a=new Date;"number"==typeof a&&(a=new Date(a)),window.plugins.datePicker.show({date:a,mode:"date",allowOldDates:!0,maxDate:Date.parse(new Date)},function(e){if(e){var t=new Date(e),n=t.getDate(),a=t.getMonth()+1,i=t.getFullYear(),r=""+(9>=n?"0"+n:n)+"/"+(9>=a?"0"+a:a)+"/"+i;o.val(r)}o.blur()})})},errorresponse:function(){hideSpinner(),openErrorPopup()},disposeView:function(e){return n.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return s});
define(["jquery","underscore","Backbone","collections/transfer/recentVIDsCollections","text!views/transfer/binimoyBeneficiarySelect.tpl"],function(e,t,i,n,r){var s=new EncryptedLocalStorage("secret"),a="",c=i.View.extend({el:"#container",events:{"click .recentVIDsList":"toggleDirectPayBtn","click #gotoNewTransaction":"gotoDirectPayInitiatePage","keyup #recentVIDs_searchBox":"filterRecentVIDsList"},initialize:function(){},update:function(){var e=this;e.getRecentPaidVIDs()},getRecentPaidVIDs:function(){showSpinner();var t=this,i=function(e){hideSpinner(),t.loadRecentVIDsTemplate()},r=function(e){hideSpinner(),t.errorresponse()};showSpinner(),t.collection=new n,t.collection.fetch({data:e.param({access_token:s.get("access_token")}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?i(e):r(e)},error:r})},loadRecentVIDsTemplate:function(){this.$el.html(t.template(r)),e("html").removeClass().addClass("app");var i=e("#gotoNewTransactionDiv").find("span").attr("id");enableScroll(i)},toggleDirectPayBtn:function(t){t.stopImmediatePropagation();var n=e(t.currentTarget).attr("id"),r=e("#"+n+" a:first-child").attr("id"),c=e(t.currentTarget).attr("vid");isNull(a)||a==r||e("#"+a).is(":visible")&&e("#"+a).hide(),e("#"+r).is(":visible")?e("#"+r).hide():e("#"+r).show(),a=r,e("#"+r).on("click",function(e){s.set("selectedRecentVID",c),s.set("isFromRecentVID","true"),i.history.navigate("#/binimoydirectpayinitiate")})},gotoDirectPayInitiatePage:function(e){e.stopImmediatePropagation(),s.set("isFromRecentVID","false"),i.history.navigate("#/binimoydirectpayinitiate")},filterRecentVIDsList:function(t){t.stopImmediatePropagation();jQuery.expr[":"].contains=function(e,t,i){return jQuery(e).text().toUpperCase().indexOf(i[3].toUpperCase())>=0};var i=t.target.value;i.length>0?(e(".search_clear").is(":visible")||(e(".search_clear").show(),e(".search_clear").on("click",function(){e("#recentVIDs_searchBox").val(""),e(".recentVIDsList").show(),e("#recentVIDs_searchBox").focus(),e(".search_clear").hide(),e(".nodata").hide()})),e(".recentVIDsList").hide(),e('.recentVIDsList:contains("'+i+'")').length>0?(e(".nodata").hide(),e('.recentVIDsList:contains("'+i+'")').show()):e(".nodata").show()):(e(".search_clear").hide(),e(".nodata").hide(),e(".recentVIDsList").show())},errorresponse:function(){hideSpinner(),openErrorPopup()},disposeView:function(e){return i.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return c});
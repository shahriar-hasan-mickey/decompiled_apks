define(["jquery","underscore","Backbone","collections/transfer/getAuthModeCollections","collections/transfer/alliasNameValidationCollections","collections/wealth/otpPostLoginGenerationCollections","collections/wealth/otpPostLoginVerificationCollections","text!views/transfer/binimoyTagAccounts.tpl"],function(t,i,e,a,l,n,o,c){var r=new EncryptedLocalStorage("secret"),s=null,d=e.View.extend({el:"#container",events:{"click #binimoyTagAccCancelBtn":"gotoPreviousPage","click .accnumtype":"getDebitAccInfo","click .accnumtypeclass":"getCreditAccountInfo","click .accnumtypeclassrtp":"getRTPDebitAccountInfo","click #binimoyTagAccSubmitBtn":"gotoReviewPage","click #binimoyTAndCPopup":"openBinimoyRegTandCPopup","click #verifyOTP":"gotoBinimoyRegistrationVerifyPage","click #popup_cancel_btn":"revokeOTPSpinner","click #close_btn":"revokeOTPSpinner","blur .aliasName":"validateAlliasName"},initialize:function(){},update:function(){var t=this;t.getBinimoyAuthMode()},getBinimoyAuthMode:function(){var i=this;r.set("IsAuthMode","false"),t("#binimoyRegAuthModeDiv").html("");var e=function(t){hideSpinner();var e=r.get("securitySettingList");!isNull(e)&&e.length>0?r.set("IsAuthMode","true"):(r.set("AlertType",null),r.set("IsAuthMode","false")),i.loadBinimoyTagAccTemplate()},l=function(t){r.set("IsAuthMode","false"),i.loadBinimoyTagAccTemplate()};showSpinner(),i.collection=new a,i.collection.fetch({data:t.param({access_token:r.get("access_token"),transactionAmount:null,tenantServiceCode:"IDTP_REG"}),dataType:"json",type:"POST",cache:!1,success:function(t){"0000"==ackStatus?e(t):l(t)},error:l})},loadBinimoyTagAccTemplate:function(){this.$el.html(i.template(c)),t("html").removeClass().addClass("app"),s=null,r.set("binimoyDebitAccID",null),r.set("binimoyDebitAccIndex",null),r.set("binimoyDebitAccType",null),r.set("binimoyDebitAccCurr",null),r.set("binimoyDebitAccNum",null),r.set("binimoyCreditAccID",null),r.set("binimoyCreditAccInd",null),r.set("binimoyCreditAccType",null),r.set("binimoyCreditAccCur",null),r.set("binimoyCreditAccNum",null),r.set("binimoyDebitRTPAccID",null),r.set("binimoyDebitRTPAccInd",null),r.set("binimoyDebitRTPAccType",null),r.set("binimoyDebitRTPAccCur",null),r.set("binimoyDebitRTPAccNum",null),r.set("isValidAllias","false");var e=this;e.populateAuthMode()},populateAuthMode:function(i){"object"==typeof i&&i.stopImmediatePropagation();var e="",a="",l=r.get("securitySettingList"),n="<label for='username'>"+t.i18n.t("app.transfer.managebeneficiary.selectauthorisationmode")+"</label>";n+="<div class='custRadio_pass'>",!isNull(l)&&l.length>0?(t("#binimoyRegAuthModeDiv").html(""),t.each(l,function(i,l){"SMS"==l?(e="sms",a=t.i18n.t("app.transfer.managebeneficiary.sms")):"EMAIL"==l?(e="mail",a=t.i18n.t("app.transfer.managebeneficiary.mail")):"TOKEN"==l?(e="fScan",a=t.i18n.t("app.transfer.managebeneficiary.token")):"ESIGN"==l&&(e="esign",a=t.i18n.t("app.transfer.managebeneficiary.esign")),n+='<div class="box"><div class="radio"><label>',n+=0==i?'<input type="radio" name="binimoyReg_AuthMode" id="optionsRadios'+i+'" value="'+l+'" checked>':'<input type="radio" name="binimoyReg_AuthMode" id="optionsRadios'+i+'" value="'+l+'">',n+='<div class="row bg"><div class="col-xs-12 p0"><span class="menu_icon ico-xs '+e+'"></span><span class="small">'+a+"</span></div></div></label></div></div>"}),t("#binimoyRegAuthModeDiv").html(n)):t("#binimoyRegAuthModeDiv").html("")},gotoPreviousPage:function(t){t.stopImmediatePropagation(),e.history.navigate("#/transfer")},validateAlliasName:function(i){i.stopImmediatePropagation(),t("#binimoyCreditAliasErr").html(""),t("#binimoyRTPDebitAliasErr").html(""),t("#binimoyDebitAliasErr").html(""),t("#binimoyRegRestrictionErr").html("");var e=this,a=t(i.currentTarget).attr("id"),n=t("#"+a).val();if(!isNull(n)){if("debitAlias"==a){var o=t("#creditAlias").val(),c=t("#rtpDebitAlias").val();if(o=o,c=c,!isNull(o)&&!isNull(r.get("binimoyCreditAccID")&&!isNull(r.get("binimoyDebitAccID")))&&r.get("binimoyCreditAccID")!=r.get("binimoyDebitAccID")&&n==o)return void t("#binimoyDebitAliasErr").html("Two different accounts cannot have same allias name");if(!isNull(c)&&!isNull(r.get("binimoyDebitRTPAccID")&&!isNull(r.get("binimoyDebitAccID")))&&r.get("binimoyDebitRTPAccID")!=r.get("binimoyDebitAccID")&&n==c)return void t("#binimoyDebitAliasErr").html("Two different accounts cannot have same allias name")}else if("creditAlias"==a){var s=t("#debitAlias").val(),c=t("#rtpDebitAlias").val();if(s=s,c=c,!isNull(s)&&!isNull(r.get("binimoyCreditAccID")&&!isNull(r.get("binimoyDebitAccID")))&&r.get("binimoyCreditAccID")!=r.get("binimoyDebitAccID")&&n==s)return void t("#binimoyCreditAliasErr").html("Two different accounts cannot have same allias name");if(!isNull(c)&&!isNull(r.get("binimoyDebitRTPAccID")&&!isNull(r.get("binimoyCreditAccID")))&&r.get("binimoyDebitRTPAccID")!=r.get("binimoyCreditAccID")&&n==c)return void t("#binimoyCreditAliasErr").html("Two different accounts cannot have same allias name")}else if("rtpDebitAlias"==a){var s=t("#debitAlias").val(),o=t("#creditAlias").val();if(s=s,o=o,!isNull(s)&&!isNull(r.get("binimoyDebitAccID"))&&!isNull(r.get("binimoyDebitRTPAccID"))&&r.get("binimoyDebitAccID")!=r.get("binimoyDebitRTPAccID")&&n==s)return void t("#binimoyRTPDebitAliasErr").html("Two different accounts cannot have same allias name");if(!isNull(o)&&!isNull(r.get("binimoyCreditAccID"))&&!isNull(r.get("binimoyDebitRTPAccID"))&&r.get("binimoyCreditAccID")!=r.get("binimoyDebitRTPAccID")&&n==o)return void t("#binimoyRTPDebitAliasErr").html("Two different accounts cannot have same allias name")}var d=function(i){hideSpinner(),r.set("isValidAllias","true"),"debitAlias"==a&&(isNull(r.get("binimoyCreditAccID"))?(t("#creditAlias").val(""),t("#creditAlias").attr("disabled",!1)):r.get("binimoyCreditAccID")==r.get("binimoyDebitAccID")&&(t("#creditAlias").val(n),t("#creditAlias").attr("disabled",!0)),isNull(r.get("binimoyDebitRTPAccID"))?(t("#rtpDebitAlias").val(""),t("#rtpDebitAlias").attr("disabled",!1)):r.get("binimoyDebitRTPAccID")==r.get("binimoyDebitAccID")&&(t("#rtpDebitAlias").val(n),t("#rtpDebitAlias").attr("disabled",!0))),"creditAlias"==a&&(isNull(r.get("binimoyDebitAccID"))?(t("#debitAlias").val(""),t("#debitAlias").attr("disabled",!1)):r.get("binimoyDebitAccID")==r.get("binimoyCreditAccID")&&(t("#debitAlias").val(n),t("#debitAlias").attr("disabled",!0)),isNull(r.get("binimoyDebitRTPAccID"))?(t("#rtpDebitAlias").val(""),t("#rtpDebitAlias").attr("disabled",!1)):r.get("binimoyDebitRTPAccID")==r.get("binimoyCreditAccID")&&(t("#rtpDebitAlias").val(n),t("#rtpDebitAlias").attr("disabled",!0))),"rtpDebitAlias"==a&&(isNull(r.get("binimoyDebitAccID"))?(t("#debitAlias").val(""),t("#debitAlias").attr("disabled",!1)):r.get("binimoyDebitAccID")==r.get("binimoyDebitRTPAccID")&&(t("#debitAlias").val(n),t("#debitAlias").attr("disabled",!0)),isNull(r.get("binimoyCreditAccID"))?(t("#creditAlias").val(""),t("#creditAlias").attr("disabled",!1)):r.get("binimoyCreditAccID")==r.get("binimoyDebitRTPAccID")&&(t("#creditAlias").val(n),t("#creditAlias").attr("disabled",!0)))},m=function(t){hideSpinner(),r.set("isValidAllias","false"),e.errorresponse()};showSpinner(),e.collection=new l,e.collection.fetch({data:t.param({access_token:r.get("access_token"),virtualId:"BBL"+n}),dataType:"json",type:"POST",cache:!1,success:function(t){"0000"==ackStatus?d(t):m(t)},error:m})}},getDebitAccInfo:function(i){"object"==typeof i&&(i.preventDefault(),i.stopImmediatePropagation());var e=this,a=t(i.target).closest("li.accnumtype").attr("Accide");r.set("binimoyDebitAccID",a);var l=t(i.target).closest("li.accnumtype").attr("id");r.set("binimoyDebitAccIndex",l);var n=t(i.target).closest("li.accnumtype").attr("acctype");r.set("binimoyDebitAccType",n);var o=t(i.target).closest("li.accnumtype").attr("data");r.set("binimoyDebitAccCurr",o);var c=t(i.target).closest("li.accnumtype").attr("accNum");r.set("binimoyDebitAccNum",c),t('li.accnumtype[accide="'+a+'"]').find("input").attr("checked","checked");var s=t(i.target).closest("li.accnumtype").find(".row").clone().html(),d='<div class="qr_acc_outer">\n <ul class="list-unstyled m0">\n <li class="list-group-item">\n'+s+"</li>\n </ul>\n </div>";t("#seltpayvalDebitAcc").html(d),t("#card_accountDebit .close").trigger("click"),isNull(r.get("binimoyCreditAccID"))&&isNull(r.get("binimoyDebitRTPAccID"))||e.populateDebitAlliasName(i)},getCreditAccountInfo:function(i){"object"==typeof i&&(i.preventDefault(),i.stopImmediatePropagation());var e=this,a=t(i.target).closest("li.accnumtypeclass").attr("Accide");r.set("binimoyCreditAccID",a);var l=t(i.target).closest("li.accnumtypeclass").attr("id");r.set("binimoyCreditAccInd",l);var n=t(i.target).closest("li.accnumtypeclass").attr("acctype");r.set("binimoyCreditAccType",n);var o=t(i.target).closest("li.accnumtypeclass").attr("data");r.set("binimoyCreditAccCur",o);var c=t(i.target).closest("li.accnumtypeclass").attr("accNum");r.set("binimoyCreditAccNum",c),t('li.accnumtypeclass[accide="'+a+'"]').find("input").attr("checked","checked");var s=t(i.target).closest("li.accnumtypeclass").find(".row").clone().html(),d='<div class="qr_acc_outer">\n <ul class="list-unstyled m0">\n <li class="list-group-item">\n'+s+"</li>\n </ul>\n </div>";t("#seltpayvalCreditAcc").html(d),t("#card_accountCredit .close").trigger("click"),isNull(r.get("binimoyDebitAccID"))&&isNull(r.get("binimoyDebitRTPAccID"))||e.populateCreditAlliasName(i)},getRTPDebitAccountInfo:function(i){"object"==typeof i&&(i.preventDefault(),i.stopImmediatePropagation());var e=this,a=t(i.target).closest("li.accnumtypeclassrtp").attr("Accide");r.set("binimoyDebitRTPAccID",a);var l=t(i.target).closest("li.accnumtypeclassrtp").attr("id");r.set("binimoyDebitRTPAccInd",l);var n=t(i.target).closest("li.accnumtypeclassrtp").attr("acctype");r.set("binimoyDebitRTPAccType",n);var o=t(i.target).closest("li.accnumtypeclassrtp").attr("data");r.set("binimoyDebitRTPAccCur",o);var c=t(i.target).closest("li.accnumtypeclassrtp").attr("accNum");r.set("binimoyDebitRTPAccNum",c),t('li.accnumtypeclassrtp[accide="'+a+'"]').find("input").attr("checked","checked");var s=t(i.target).closest("li.accnumtypeclassrtp").find(".row").clone().html(),d='<div class="qr_acc_outer">\n <ul class="list-unstyled m0">\n <li class="list-group-item">\n'+s+"</li>\n </ul>\n </div>";t("#seltpayvalRTPDebitAcc").html(d),t("#card_rtpDefaultDebit .close").trigger("click"),isNull(r.get("binimoyDebitAccID"))&&isNull(r.get("binimoyCreditAccID"))||e.populateRTPDebitAliasName(i)},populateDebitAlliasName:function(i){i.stopImmediatePropagation();var e=t("#creditAlias").val(),a=t("#rtpDebitAlias").val(),l=r.get("binimoyDebitAccID"),n=r.get("binimoyCreditAccID"),o=r.get("binimoyDebitRTPAccID");"true"==r.get("isValidAllias")?isNull(l)||(isNull(n)||isNull(e))&&(isNull(o)||isNull(a))?(t("#debitAlias").val(""),t("#debitAlias").attr("disabled",!1)):r.get("binimoyDebitAccID")==r.get("binimoyCreditAccID")?(t("#debitAlias").val(e),t("#debitAlias").attr("disabled",!0)):r.get("binimoyDebitAccID")==r.get("binimoyDebitRTPAccID")?(t("#debitAlias").val(a),t("#debitAlias").attr("disabled",!0)):(t("#debitAlias").val(""),t("#debitAlias").attr("disabled",!1)):(t("#debitAlias").val(""),t("#debitAlias").attr("disabled",!1))},populateCreditAlliasName:function(i){i.stopImmediatePropagation();var e=t("#debitAlias").val(),a=t("#rtpDebitAlias").val(),l=r.get("binimoyDebitAccID"),n=r.get("binimoyCreditAccID"),o=r.get("binimoyDebitRTPAccID");"true"==r.get("isValidAllias")?isNull(n)||(isNull(l)||isNull(e))&&(isNull(o)||isNull(a))?(t("#creditAlias").val(""),t("#creditAlias").attr("disabled",!1)):r.get("binimoyCreditAccID")==r.get("binimoyDebitAccID")?(t("#creditAlias").val(e),t("#creditAlias").attr("disabled",!0)):r.get("binimoyCreditAccID")==r.get("binimoyDebitRTPAccID")?(t("#creditAlias").val(a),t("#creditAlias").attr("disabled",!0)):(t("#creditAlias").val(""),t("#creditAlias").attr("disabled",!1)):(t("#creditAlias").val(""),t("#creditAlias").attr("disabled",!1))},populateRTPDebitAliasName:function(i){i.stopImmediatePropagation();var e=t("#debitAlias").val(),a=t("#creditAlias").val(),l=r.get("binimoyDebitAccID"),n=r.get("binimoyCreditAccID"),o=r.get("binimoyDebitRTPAccID");"true"==r.get("isValidAllias")?isNull(o)||(isNull(l)||isNull(e))&&(isNull(n)||isNull(a))?(t("#rtpDebitAlias").val(""),t("#rtpDebitAlias").attr("disabled",!1)):r.get("binimoyDebitAccID")==r.get("binimoyDebitRTPAccID")?(t("#rtpDebitAlias").val(e),t("#rtpDebitAlias").attr("disabled",!0)):r.get("binimoyCreditAccID")==r.get("binimoyDebitRTPAccID")?(t("#rtpDebitAlias").val(a),t("#rtpDebitAlias").attr("disabled",!0)):(t("#rtpDebitAlias").val(""),t("#rtpDebitAlias").attr("disabled",!1)):(t("#rtpDebitAlias").val(""),t("#rtpDebitAlias").attr("disabled",!1))},gotoReviewPage:function(i){var e=!1,a=t("#debitAlias").val(),l=t("#creditAlias").val(),n=t("#rtpDebitAlias").val(),o=t("#binimoyRegTandC").prop("checked");if("object"==typeof i&&(i.preventDefault(),i.stopImmediatePropagation()),t("#binimoyDebitAccError").html(""),t("#binimoyCreditAccError").html(""),t("#binimoyDebitAliasErr").html(""),t("#binimoyCreditAliasErr").html(""),t("#binimoyRTPDebitAliasErr").html(""),t("#binimoyTandCErr").html(""),t("#binimoyRegRestrictionErr").html(""),isNull(r.get("binimoyDebitAccID"))&&(e=!0,t("#binimoyDebitAccError").html("Please select a Debit Account")),isNull(r.get("binimoyCreditAccID"))&&(e=!0,t("#binimoyCreditAccError").html("Please select a Credit Account")),isNull(a)&&(e=!0,t("#binimoyDebitAliasErr").html("Please enter a debit alias")),isNull(l)&&(e=!0,t("#binimoyCreditAliasErr").html("Please enter a credit alias")),isNull(a)||a.length>24&&(e=!0,t("#binimoyDebitAliasErr").html("The Alias name should contain maximum of 24 characters")),isNull(l)||l.length>24&&(e=!0,t("#binimoyCreditAliasErr").html("The Alias name should contain maximum of 24 characters")),isNull(n)||n.length>24&&(e=!0,t("#binimoyRTPDebitAliasErr").html("The Alias name should contain maximum of 24 characters")),isNull(r.get("binimoyDebitAccID"))||isNull(r.get("binimoyCreditAccID"))||r.get("binimoyDebitAccID")==r.get("binimoyCreditAccID")&&a!=l&&(e=!0,t("#binimoyCreditAliasErr").html("Alias name cannot be different for same account")),isNull(r.get("binimoyDebitAccID"))||isNull(r.get("binimoyDebitRTPAccID"))||r.get("binimoyDebitAccID")==r.get("binimoyDebitRTPAccID")&&a!=n&&(e=!0,t("#binimoyRTPDebitAliasErr").html("Alias name cannot be different for same account")),o||(e=!0,t("#binimoyTandCErr").html("Please check the Terms and Conditions")),(isNull(r.get("nationalID"))||isNull(r.get("dateOfBirth"))||isNull(r.get("contactNumber"))||isNull(r.get("emailId")))&&(e=!0,t("#binimoyRegRestrictionErr").html("The NID, Date of Birth, Mobile Number and Email ID are mandatory to proceed with registration")),!e){a="BBL"+a,l="BBL"+l,n="BBL"+n,r.set("debitAlias",a),r.set("creditAlias",l),r.set("rtpDebitAlias",n);var c=this;c.gotoAuthModeVerification(i)}},gotoAuthModeVerification:function(i){i.stopImmediatePropagation();var e=t("input[name='binimoyReg_AuthMode']:checked").val();r.set("AlertType",e);var a=this;a.loadOTP()},loadOTP:function(){var i=this,a=r.get("AlertType");"false"==r.get("IsAuthMode")?e.history.navigate("#/binimoynewregistration"):"SMS"==a||"EMAIL"==a||"ESIGN"==a?i.validateotpgeneration("N"):(r.set("otpCode",""),t("#verify").modal("show"),t("#otp1, #otp2, #otp3, #otp4, #otp5, #otp6").removeAttr("data"),t("#myModalLabel").html(t.i18n.t("app.registration.otptokenheadertext")),t("#otpHelpText").html(t.i18n.t("app.registration.opthelptokentext")),t("#challengeText").html(""),t("#otpContainerDiv").html(""),t("#otpNullError").html(""),t("#otpNullErrorDiv").hide(),t(".inputs").on("input",function(i){var e=i.currentTarget.id,a=t("#"+e).val();t("#"+e).attr("data",a),t("#"+e).val(a.replace(/[^\*]/,"."))}),t("#otp1, #otp2, #otp3, #otp4, #otp5, #otp6").val(""))},validateotpgeneration:function(i){var e=this,a=function(a){hideSpinner(),"Y"==i&&(t("#OTPcontainer1").slideDown("slow"),s.set(1),s.animate(0,function(){t("#OTPcontainer1").slideUp("slow")})),t("#verify").modal("show"),setTimeout(function(){t("#otp1").focus()},500),t("#otpNullError").html(""),t("#otpNullErrorDiv").hide(),t(".inputs").on("input",function(i){i.stopImmediatePropagation();var e=i.currentTarget.id,a=t("#"+e).val();t("#"+e).attr("data",a),t("#"+e).val(a.replace(/[^\*]/,"."))}),t("#otpHelpText").html(""),t("#challengeText").html(""),"SMS"==r.get("AlertType")?(t("#myModalLabel").html(t.i18n.t("app.registration.otpothersheadertext")),t("#otpHelpText").html("Please enter the OTP from your registered mobile number "+maskMobile(r.get("contactNumber")))):"EMAIL"==r.get("AlertType")?(t("#myModalLabel").html(t.i18n.t("app.registration.otpothersheadertext")),t("#otpHelpText").html("Please enter the OTP from your registered email ID"+maskMobile(r.get("emailId")))):"TOKEN"==r.get("AlertType")?(t("#myModalLabel").html(t.i18n.t("app.registration.otptokenheadertext")),t("#otpHelpText").html(t.i18n.t("app.registration.opthelptokentext"))):"ESIGN"==r.get("AlertType")&&(t("#myModalLabel").html(t.i18n.t("app.registration.otpothersheadertext")),t("#otpHelpText").html("Please enter the ESIGN Validation"),t("#challengeText").html(t.i18n.t("app.transferss.genratedTocn")+""+r.get("otpCode"))),t("#otp1, #otp2, #otp3, #otp4, #otp5, #otp6").val(""),"SMS"==r.get("AlertType")||"EMAIL"==r.get("AlertType")?e.appendOTPContainer():t("#otpContainerDiv").html(""),("SMS"==r.get("AlertType")||"EMAIL"==r.get("AlertType"))&&(s=null,t("#otpNullError").html(""),e.invokeOTPSpinner())},l=function(t){e.errorresponse()};showSpinner(),e.collection=new n;getDeviceId(),(new Date).getTime();e.collection.fetch({data:t.param({access_token:r.get("access_token"),transactionType:"IDTP_REG",resendflag:i,authMode:r.get("AlertType")}),dataType:"json",type:"POST",cache:!1,success:function(t){"0000"==ackStatus?a(t):l(t)},error:l})},appendOTPContainer:function(){t("#otpContainerDiv").html("");var i="";i+="<div class='form-group'><div id='OTPcontainer1'></div><p class='text-center small'><a href='javascript:void(0);'class='resend_button' id='resend_btn6'>Resend OTP</a></p></div>",t("#otpContainerDiv").append(i)},invokeOTPSpinner:function(){var i=this;return t("#resend_btn6").hide(),i.appendOTPContainer(),t("#OTPcontainer1").show(),t("#otp1, #otp2, #otp3, #otp4, #otp5, #otp6").val(""),null!=s?(s.set(1),void s.animate(0,function(){t("#OTPcontainer1").slideUp("slow")})):(s=new ProgressBar.Circle(OTPcontainer1,{color:"#333",strokeWidth:8,trailWidth:8,easing:"linear",duration:6e4*parseInt(r.get("otpExpiryPeriod")),text:{autoStyleContainer:!1},from:{color:"#ec5f59",width:8},to:{color:"#ec5f59",width:8},step:function(i,e){e.path.setAttribute("stroke",i.color),e.path.setAttribute("stroke-width",i.width);var a=Math.round(e.value()*(60*r.get("otpExpiryPeriod")));"0"==a?(e.setText(""),t("#resend_btn6").show()):(t("#resend_btn6").hide(),e.setText(a+"s"))}}),s.text.style.fontFamily='"Raleway", Helvetica, sans-serif',s.text.style.fontSize="12px",s.text.style.fontWeight="bold",s.set(1),s.animate(0,function(){t("#OTPcontainer1").slideUp("slow")}),void t("#resend_btn6").click(function(){i.validateotpgeneration("Y")}))},revokeOTPSpinner:function(){null!=s&&s.stop()},openBinimoyRegTandCPopup:function(t){t.stopImmediatePropagation(),r.set("tandctype","binimoyReg"),openTermsAndConditionsPopup()},gotoBinimoyRegistrationVerifyPage:function(i){i.stopImmediatePropagation(),t("#otpNullError").html(""),t("#otpNullErrorDiv").hide();var a=this,l=t("#otp1").attr("data"),n=t("#otp2").attr("data"),c=t("#otp3").attr("data"),s=t("#otp4").attr("data"),d=t("#otp5").attr("data"),m=t("#otp6").attr("data"),b=l+""+n+c+s+d+m;if(isNull(l)||isNull(n)||isNull(c)||isNull(s)||isNull(d)||isNull(m))return t("#otpNullErrorDiv").show(),void t("#otpNullError").html(t.i18n.t("validation.newregistration.otpnotnull"));var p=function(i){a.revokeOTPSpinner(),t("#verify").modal("hide"),hideSpinner(),e.history.navigate("#/binimoynewregistration")},u=function(i){hideSpinner(),a.revokeOTPSpinner(),isNull(r.get("errordesc"))||(t("#otpNullErrorDiv").show(),t("#otpNullError").html(r.get("errordesc")))};showSpinner(),a.collection=new o;getDeviceId(),(new Date).getTime();a.collection.fetch({data:t.param({access_token:r.get("access_token"),transactionType:"IDTP_REG",activationno:b,uniqueId:r.get("otpCode"),twoFAType:r.get("AlertType")}),dataType:"json",type:"POST",cache:!1,success:function(t){"0000"==ackStatus?p(t):u(t)},error:u})},errorresponse:function(){hideSpinner(),openErrorPopup()},disposeView:function(t){return e.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=t,this.currentView.delegateEvents(),this.currentView}});return d});
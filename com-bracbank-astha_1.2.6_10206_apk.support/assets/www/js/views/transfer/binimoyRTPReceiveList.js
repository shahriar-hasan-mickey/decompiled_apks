define(["jquery","underscore","Backbone","collections/transfer/getRTPReceiveListCollections","collections/transfer/declineRTPRequestCollections","text!views/transfer/binimoyRTPReceiveList.tpl"],function(e,t,i,c,n,o){var r=new EncryptedLocalStorage("secret"),s=i.View.extend({el:"#container",events:{"click #rtpSentList":"gotoRTPSentList","keyup #rtpReciveList_SearchBox":"filterRTPReceiveListSearchBox","click .declineClass":"getDeclineRTPReqInfo","click #rejectRTP_NOBtn":"closeRejectPopup","click #rejectRTP_YESBtn":"rejectTheRTPReceiveReq","click .acceptClass":"getAcceptRTPReqInfo"},initialize:function(){},update:function(){var e=this;e.getRTPReceivedList()},getRTPReceivedList:function(t){"object"==typeof t&&t.stopImmediatePropagation(),showSpinner();var i=this,n=function(e){hideSpinner(),i.loadRTPReceiveListTemplate()},o=function(e){hideSpinner(),i.errorresponse()};showSpinner(),i.collection=new c,i.collection.fetch({data:e.param({access_token:r.get("access_token"),page_no:"0",from_date:"",to_date:""}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?n(e):o(e)},error:o})},loadRTPReceiveListTemplate:function(){this.$el.html(t.template(o)),e("html").removeClass().addClass("app"),r.set("RTPAcceptToVID",null),r.set("RTPAcceptAmount",null),r.set("RTPAcceptRemakrs",null),r.set("RTPAcceptRefID",null),r.set("RTPAcceptReqID",null)},gotoRTPSentList:function(e){e.stopImmediatePropagation(),i.history.navigate("#/binimoyrtpsentlist")},filterRTPReceiveListSearchBox:function(t){t.stopImmediatePropagation();jQuery.expr[":"].contains=function(e,t,i){return jQuery(e).text().toUpperCase().indexOf(i[3].toUpperCase())>=0};var i=t.target.value;i.length>0?(e(".search_clear").is(":visible")||(e(".search_clear").show(),e(".search_clear").on("click",function(){e("#rtpReciveList_SearchBox").val(""),e(".rtpReceiveList").show(),e("#rtpReciveList_SearchBox").focus(),e(".search_clear").hide(),e(".nodata").hide()})),e(".rtpReceiveList").hide(),e('.rtpReceiveList:contains("'+i+'")').length>0?(e(".nodata").hide(),e('.rtpReceiveList:contains("'+i+'")').show()):e(".nodata").show()):(e(".search_clear").hide(),e(".nodata").hide(),e(".rtpReceiveList").show())},gotoRTPReceiveReqInitPage:function(e){e.stopImmediatePropagation(),i.history.navigate("#/binimoyrtpreceivereqacceptinit")},getDeclineRTPReqInfo:function(t){t.stopImmediatePropagation();var i=(e(t.currentTarget).attr("id"),e(t.currentTarget).attr("ind"));r.set("declineInd",i),e("#reject").modal("show")},closeRejectPopup:function(t){t.stopImmediatePropagation(),e("div").removeClass("modal-backdrop fade in"),e("#reject").modal("hide")},rejectTheRTPReceiveReq:function(t){t.stopImmediatePropagation(),showSpinner();var i=this,c=r.get("RTPReceiveList"),o=r.get("declineInd"),s=c[o].senderVID,a=(r.get("registerdDevice"),c[o].reqID),p=c[o].amount,l=function(c){hideSpinner(),e("div").removeClass("modal-backdrop fade in"),e("#reject").modal("hide"),i.getRTPReceivedList(t)},d=function(e){hideSpinner(),i.errorresponse()};showSpinner(),i.collection=new n,i.collection.fetch({data:e.param({access_token:r.get("access_token"),receiverVID:s,rtpid:a,reqAmount:p}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?l(e):d(e)},error:d})},getAcceptRTPReqInfo:function(t){t.stopImmediatePropagation();var i=this,c=(e(t.currentTarget).attr("id"),e(t.currentTarget).attr("ind")),n=r.get("RTPReceiveList"),o=n[c].senderVID,s=n[c].amount,a=n[c].purpose,p=n[c].referenceNo,l=n[c].reqID,d=n[c].senderName;r.set("RTPAcceptToVID",o),r.set("RTPAcceptAmount",s),r.set("RTPAcceptRemakrs",a),r.set("RTPAcceptRefID",p),r.set("RTPAcceptReqID",l),r.set("RTPAcceptSenderName",d),i.gotoRTPReceiveReqInitPage(t)},errorresponse:function(){hideSpinner(),openErrorPopup()},disposeView:function(e){return i.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return s});
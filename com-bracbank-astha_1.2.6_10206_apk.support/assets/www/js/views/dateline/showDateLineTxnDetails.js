define(["jquery","underscore","Backbone","text!views/dateline/showDateLineTxnDetails.tpl","collections/common/emailAdviceCollections","collections/wealth/accTransDetailedCollections","text!views/common/emailAdviceTransferSuccessPage.tpl"],function(e,t,i,n,c,a,o){var r=new EncryptedLocalStorage("secret"),s=i.View.extend({el:"#mobcontent",events:{"click #datelineemail":"EmailAdvice"},update:function(t){r.set("showaccid",t),showSpinner();var i=this,n=function(e){i.datelineFTDetails(t)},c=function(e){i.errorresponse()};i.collection=new a([],{id:t}),timestamp=(new Date).getTime();var o=getDeviceId(),s=t+""+o,l=CryptoJS.MD5(s);s=l+"",r.set("ftrefno",t),showSpinner(),i.collection.fetch({data:e.param({appchecksum:s,ftrefnum:t,requestid:timestamp}),dataType:"json",type:"POST",cache:!1,success:function(e){"0000"==ackStatus?n(e):c(e)},error:c})},datelineFTDetails:function(e){hideSpinner(),this.$el.html(t.template(n,{collection:this.collection.models,id:e})).i18n()},EmailAdvice:function(){showSpinner();var t=this,i=e("#ftno").val(),n=function(e){t.emailadvicecompile(i)},a=function(e){t.errorresponse()};t.collection=new c([],{});var o,s=(new Date).getTime(),l=(e("#acctnovalue").val(),"TRANSFER");"ACCOUNT"==l?o="ACCOUNT":"CARD"==l?o="CARD":"TRANSFER"==l&&(o="TRANSFER");var u=r.get("emailid"),d=(r.get("loginid"),r.get("custno"));r.get("lang_id");t.collection.fetch({data:e.param({ftrefno:r.get("showaccid"),transfertype:o,accountNumber:"",custmailid:u,custuserid:d,requestid:s}),dataType:"json",type:"POST",cache:!1,timeout:parseInt(r.get("calltimeout")),success:function(e){"0000"==ackStatus?n(e):a(e)},error:a})},emailadvicecompile:function(e){r.set("backReqFromEmail","8"),this.$el.empty(),hideSpinner();var n=r.get("iaxth");if("transfer"==n){var c=r.get("showaccid");return hideSpinner(),this.$el.html(t.template(o,{ftno:c,emailmodule:"Transfer"})),this.$el.trigger("create"),this}return hideSpinner(),i.history.navigate("#/emailAdviceSuccessPage"),this},errorresponse:function(){hideSpinner(),i.history.navigate("#/exception")},disposeView:function(e){return i.View.prototype.close=function(){this.unbind(),this.undelegateEvents()},void 0!==this.currentView&&this.currentView.close(),this.currentView=e,this.currentView.delegateEvents(),this.currentView}});return s});
!function(e){if(webshims.support.texttrackapi&&document.addEventListener){var t=webshims.cfg.track,a=function(t){e(t.target).filter("track").each(n)},i=webshims.bugs.track,n=function(){return i||!t.override&&3==e.prop(this,"readyState")?(t.override=!0,webshims.reTest("track"),document.removeEventListener("error",a,!0),this&&e.nodeName(this,"track")?webshims.error("track support was overwritten. Please check your vtt including your vtt mime-type"):webshims.info("track support was overwritten. due to bad browser support"),!1):void 0},r=function(){document.addEventListener("error",a,!0),i?n():e("track").each(n),i||t.override||webshims.defineProperty(TextTrack.prototype,"shimActiveCues",{get:function(){return this._shimActiveCues||this.activeCues}})};t.override||e(r)}}(webshims.$),webshims.register("track-ui",function(e,t,a,i,n){"use strict";function r(e,t){var a=!0,i=0,n=e.length;if(n!=t.length)a=!1;else for(;n>i;i++)if(e[i]!=t[i]){a=!1;break}return a}function s(a,i,n,r,s){var c,o,u=e.Event("cuechange");n.trackElements||(n.trackElements=r[0].getElementsByTagName("track")),c=n.trackElements[s],c&&(o=(t.data(c,"trackData")||{track:e.prop(c,"track")}).track,o!=a.track&&(c=null)),e.event.trigger(u,null,a.track,!0),c&&e.event.trigger(u,null,c,!0),e.event.trigger(i,null,a,!0)}var c=t.cfg.track,o=t.support,u={subtitles:1,captions:1,descriptions:1},d=t.mediaelement,p=function(){return!c.override&&o.texttrackapi},l=a.cancelAnimationFrame&&a.requestAnimationFrame||function(e){setTimeout(e,17)},m=a.cancelAnimationFrame||a.clearTimeout,v={update:function(a,i){a.activeCues.length?r(a.displayedActiveCues,a.activeCues)||(a.displayedActiveCues=a.activeCues,a.trackDisplay||(a.trackDisplay=e('<div class="cue-display '+t.shadowClass+'"><span class="description-cues" aria-live="assertive" /></div>').insertAfter(i),this.addEvents(a,i),t.docObserve()),a.hasDirtyTrackDisplay&&i.triggerHandler("forceupdatetrackdisplay"),this.showCues(a)):this.hide(a)},showCues:function(t){var a=e('<span class="cue-wrapper" />');e.each(t.displayedActiveCues,function(i,n){var r=n.id?'id="cue-id-'+n.id+'"':"",s=e('<span class="cue-line"><span '+r+' class="cue" /></span>').find("span").html(n.getCueAsHTML()).end();"descriptions"==n.track.kind?setTimeout(function(){e("span.description-cues",t.trackDisplay).html(s)},0):a.prepend(s)}),e("span.cue-wrapper",t.trackDisplay).remove(),t.trackDisplay.append(a)},addEvents:function(e,t){if(c.positionDisplay){var a,i=function(a){if(e.displayedActiveCues.length||a===!0){e.trackDisplay.css({display:"none"});var i=t.getShadowElement(),n=i.innerHeight(),r=i.innerWidth(),s=i.position();e.trackDisplay.css({left:s.left,width:r,height:n-45,top:s.top,display:"block"}),e.trackDisplay.css("fontSize",Math.max(Math.round(n/30),7)),e.hasDirtyTrackDisplay=!1}else e.hasDirtyTrackDisplay=!0},n=function(){clearTimeout(a),a=setTimeout(i,0)},r=function(){i(!0)};t.on("playerdimensionchange mediaelementapichange updatetrackdisplay updatemediaelementdimensions swfstageresize",n),t.on("forceupdatetrackdisplay",r).onWSOff("updateshadowdom",n),r()}},hide:function(t){t.trackDisplay&&t.displayedActiveCues.length&&(t.displayedActiveCues=[],e("span.cue-wrapper",t.trackDisplay).remove(),e("span.description-cues",t.trackDisplay).empty())}};if(d.trackDisplay=v,!d.createCueList){var k={getCueById:function(e){for(var t=null,a=0,i=this.length;i>a;a++)if(this[a].id===e){t=this[a];break}return t}};d.createCueList=function(){return e.extend([],k)}}d.getActiveCue=function(t,a,i,n,r){t._lastFoundCue||(t._lastFoundCue={index:0,time:0}),t._shimActiveCues||!o.texttrackapi||c.override||(t._shimActiveCues=d.createCueList());for(var p,l,m,v=0;v<t.shimActiveCues.length;v++)l=t.shimActiveCues[v],l.startTime>i||l.endTime<i?(t.shimActiveCues.splice(v,1),v--,l.pauseOnExit&&e(a).pause(),s(l,"exit",n,a,r)):(m=l.endTime-i,n.nextUpdateDelay>m&&(n.nextUpdateDelay=m,n.nextEvent=l.endTime),"showing"==t.mode&&u[t.kind]&&-1==e.inArray(l,n.activeCues)&&n.activeCues.push(l));for(p=t.cues.length,v=t._lastFoundCue.time<i?t._lastFoundCue.index:0;p>v;v++)if(l=t.cues[v],l.startTime<=i&&l.endTime>=i&&-1==e.inArray(l,t.shimActiveCues)&&(t.shimActiveCues.push(l),"showing"==t.mode&&u[t.kind]&&n.activeCues.push(l),s(l,"enter",n,a,r),t._lastFoundCue.time=i,t._lastFoundCue.index=v,m=l.endTime-i,n.nextUpdateDelay>m&&(n.nextUpdateDelay=m,n.nextEvent=l.endTime)),l.startTime>i){m=l.startTime-i,n.nextUpdateDelay>m&&(n.nextUpdateDelay=m,n.nextEvent=l.startTime);break}};var h=function(){return t.implement(this,"trackui")},f=function(){var a,i,r,s,c,o,u,k,h=.27,f=e(this),y=0,g=function(){y++,9>y?f.prop("currentTime")>a.nextEvent?(y=n,C()):k=l(g):y=n},C=function(e){var n,u;if(i&&a||(i=f.prop("textTracks"),a=t.data(f[0],"mediaelementBase")||t.data(f[0],"mediaelementBase",{}),a.displayedActiveCues||(a.displayedActiveCues=[])),i&&(u=f.prop("currentTime"),!(!u&&0!==u||a.nextEvent&&e&&"timeupdate"==e.type&&u>=o&&a.nextEvent-u>h&&9>u-o))){o=u,c=a.nextUpdateDelay,a.nextUpdateDelay=Number.MAX_VALUE,a.activeCues=[];for(var p=0,l=i.length;l>p;p++)n=i[p],"disabled"!=n.mode&&n.cues&&n.cues.length&&d.getActiveCue(n,f,u,a,p);v.update(a,f),clearTimeout(r),a.nextUpdateDelay<=h&&(e||c!=a.nextUpdateDelay)&&a.nextUpdateDelay>0?(c=a.nextUpdateDelay,clearTimeout(s),k&&m(k),y=0,s=setTimeout(g,1e3*a.nextUpdateDelay+9)):a.nextUpdateDelay>=Number.MAX_VALUE&&(a.nextEvent=u+2)}},T=function(){a&&a.trackElements&&delete a.trackElements},w=function(e){a&&e&&("addtrack"==e.type||"removetrack"==e.type)&&(clearTimeout(u),u=setTimeout(T,39)),clearTimeout(r),r=setTimeout(C,40)},x=function(){i||(a&&"blockTrackListUpdate"in a&&(a.blockTrackListUpdate=!0),i=f.prop("textTracks"),a&&a.blockTrackListUpdate&&(a.blockTrackListUpdate=!1)),e([i]).off(".trackview").on("change.trackview addtrack.trackview removetrack.trackview",w),f.off(".trackview").on("emptied.trackview",T).on("play.trackview playing.trackview updatetrackdisplay.trackview seeked.trackview",w).on("timeupdate.trackview",C)};f.on("remove",function(e){!e.originalEvent&&a&&a.trackDisplay&&setTimeout(function(){a.trackDisplay.remove()},4)}),p()?(f.hasClass("nonnative-api-active")&&x(),f.on("mediaelementapichange trackapichange",function(){!p()||f.hasClass("nonnative-api-active")?x():(clearTimeout(r),clearTimeout(s),k&&m(k),i=f.prop("textTracks"),a=t.data(f[0],"mediaelementBase")||t.data(f[0],"mediaelementBase",{}),e.each(i,function(e,t){t._shimActiveCues&&delete t._shimActiveCues}),e([i]).off(".trackview"),v.hide(a),f.off(".trackview"))})):x()};p()&&(!function(){var a,i=function(t){a=!0,setTimeout(function(){e(t).triggerHandler("updatetrackdisplay"),a=!1},9)},n=function(n,r,s){var c,o="_sup"+s,u={prop:{}};u.prop[s]=function(){return!a&&p()&&i(e(this).closest("audio, video")),c.prop[o].apply(this,arguments)},c=t.defineNodeNameProperty(n,r,u)};n("track","track","get"),["audio","video"].forEach(function(e){n(e,"textTracks","get"),n("nodeName","addTextTrack","value")})}(),e.propHooks.activeCues={get:function(e){return e._shimActiveCues||e.activeCues}}),t.addReady(function(t,a){e("video, audio",t).add(a.filter("video, audio")).filter(h).each(f)})});
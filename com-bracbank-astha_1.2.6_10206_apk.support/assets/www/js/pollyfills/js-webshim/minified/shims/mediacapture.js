webshim.register("mediacapture",function(e,t,a,i,r,n){"use strict";var s=-1,o=e.noop,c='input[type="file"].ws-filereader, input[type="file"].ws-capture',p=e.Deferred();!function(){var a,i=!(!navigator.getUserMedia||navigator.wsGetUserMedia),r=swfmini.hasFlashPlayerVersion("11.3"),n=function(){try{sessionStorage.setItem("wsCameras",JSON.stringify(s))}catch(e){}},c=function(){s=0,n(),p.reject(s)},d=function(){n(),p.resolve(s)};try{a=JSON.parse(sessionStorage.getItem("wsCameras")),null==a&&(s=-1)}catch(l){}0===s||-1==s&&!i&&!r?c():r?o=function(){var a=t.cfg.mediaelement,i=a.playerPath||t.cfg.basePath+"swf/"+(a.playerName||"JarisFLVPlayer.swf"),r="wscameralistdetection",n={controltype:"1",jsapi:"1",source:"",id:r,evtId:r},p={id:r,name:r},l={allowscriptaccess:"always",allowNetworking:"all"},u=e('<div><div id="'+r+'"></div></div>').css({position:"absolute",left:-999,width:5,height:5,overflow:"hidden"}).appendTo("body");t.mediaelement.jarisEvent=t.mediaelement.jarisEvent||{},t.mediaelement.jarisEvent[r]=function(e){s=e.cameras,u.remove(),s?d():c()},o=e.noop,swfmini.embedSWF(i,r,"100%","100%","11.3",!1,n,l,p)}:(s=-1,d())}();var d=/image\/\*|image\/jp/i,l=function(){t.ready("WINDOWLOAD",function(){t.loader.loadList(["mediacapture-picker"])}),l=e.noop},u=function(){if(e(this).is("[capture].ws-filereader, .ws-capture")&&t.implement(this,"capture")){var a,i,r,n,s=e(this),o=s.prop("accept")||"image/*";if(!d.test(o))return;r=e('<button type="button" class="ws-capture-button" />'),n=t.objectCreate(t.wsPopover,{},e.extend({prepareFor:r})),n.element.addClass("capture-popover input-picker"),s.is(".ws-custom-file > *")?(i=s.closest(".ws-custom-file"),a=e('<div class="ws-capture-file" />').insertAfter(i),a.append(r).append(i)):s.before(r),n.element.insertAfter(r),r.on("click",function(){t.mediacapture.showContent(s,r,n),n.show()}),l()}},f=function(){var e=this;o(),p.done(function(){u.call(e)})};t.mediacapture={showContent:function(e,a,i){t.loader.loadList(["mediacapture-picker"]),t.ready("mediacapture-picker",function(){t.mediacapture.showContent(e,a,i)})}},t.defineNodeNamesBooleanProperty("input","capture"),s&&(p.done(function(){f=u,t.loader.addModule("mediacapture-picker",{noAutoCallback:!0,css:"styles/forms-picker.css",options:n})}),t.addReady(function(t,a){e(c,t).add(a.filter(c)).filter('[accept*="image"], :not([accept]), [accept=""]').each(f)}),t.ready("WINDOWLOAD",o)),"complete"==i.readyState&&t.isReady("WINDOWLOAD",!0)});